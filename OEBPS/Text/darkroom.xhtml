<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<link href="../Styles/Style0001.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Chapter 3. Darkroom</h1>
<div id="search_content">
<div class="chapter">
<p>The darkroom view is where you develop your image.</p>
<p> </p>
<div class="screenshot">
<div><img alt="darkroom_view" src="../Images/darkroom_view.jpg" class="center"/><br/>
</div>
</div>
<p> </p>
<div class="sect1">
<div class="titlepage">
<div>
<div>
<h2 class="title" id="sigil_toc_id_181">3.1. Overview</h2>
</div>
</div>
</div>
<p>Darkroom mode is for photographic development of the image that you selected from the lighttable. Numerous tools, named modules, are available for processing that image.</p>
<p>On the left hand side you have navigation, snapshot, history stack, color picker, tagging, image information and mask manager panels, described in <a class="xref" title="3.3. Darkroom panels" href="#sigil_toc_id_182">Section 3.3, “Darkroom panels”</a>. In the right hand panel you can see the histogram and a list of modules available for working with the image. At the bottom of the right hand panel you can enable/disable the view of individual modules.</p>
<p>You can use <span class="emphasis"><em>middle-click</em></span> to zoom 1:1. A double <span class="emphasis"><em>middle-click</em></span> takes you to 2:1. Alternatively you can zoom in and out between 1:1 and fit-to-screen by mouse scrolling. Mouse scrolling while holding the control key pressed gives an extended zoom range between 2:1 and 1:10.</p>
<p>You normally export multiple images from the lighttable view but you can also export the current image directly from the darkroom by using the shortcut <span class="emphasis"><em>ctrl-e</em></span>. Export parameters are then those currently selected in the lighttable.</p>
<div>
<div>
<div>
<h2 id="sigil_toc_id_183">3.2. Darkroom concepts</h2>
</div>
</div>
</div>
<p>This section tries to explain some of the basic concepts on how darktable develops images in the darkroom.</p>
<p>The basic element of an image operation in darktable is called a module. darktable comes with a rich set of over 60 modules for all kind of image manipulations. In <a title="3.4. Modules" href="#sigil_toc_id_185">Section 3.4, “Modules”</a> you will find a description for each of the available modules.</p>
<div>
<div>
<div>
<div>
<h3 id="sigil_toc_id_184">3.2.1. Pixelpipe, module order, and history stack</h3>
</div>
</div>
</div>
<p>darktable processes images – from input to output – in a so called <span>“<span>pixelpipe</span>”</span>. Within the pixelpipe image processing consists of consecutive operations which are implemented as <span>“<span>modules</span>”</span>.</p>
<p>Modules are applied in a fixed order. This differentiates darktable, as a non-destructive image editor, from classical image manipulation programs like GIMP. As module order is fixed, you are free to activate, deactivate or change the parameters of a module at arbitrary points in time; the order of activation in your workflow does not have any impact on the outcome.</p>
<p>Users frequently ask why the module order is fixed and if there are plans to change that restriction. There are several reasons why darktable works in the way described:</p>
<div>
<ul>
<li>
<p>The sequence of modules has been selected with great care in order go give highest output quality. Changes to the sequence would generally worsen the result rather than improving it.</p>
</li>
<li>
<p>Certain image processing steps just don't make sense if they are shifted in the pixelpipe. To mention just a few: highlight reconstruction needs to be done on raw data before demosaicing and the demosaic step needs to be performed before any input color profile can be applied.</p>
</li>
<li>
<p>Most of darktable's modules are designed to work within a specific color model (see&nbsp;<a title="3.2.10. Color management" href="#sigil_toc_id_78">Section 3.2.10, “Color management”</a> for more details). Full flexibility would require modules to support different parallel algorithms depending on the color space they are working in – this would drastically increase complexity.</p>
</li>
</ul>
</div>
<p>That said, the fixed sequence of modules is not likely to change in the near future.</p>
<p>Whenever you activate or deactivate a module or go back to a module and change the parameters, this adds an item on top of the <span>“<span>history stack</span>”</span>.</p>
<p>For example, when working on a raw file, the history stack on the left panel might say that you first enabled <a title="3.4.4.5. Denoise – bilateral" href="#sigil_toc_id_40"><span><em>bilateral filtering</em></span></a>, then disabled <a title="3.4.1.4. Base curve" href="#sigil_toc_id_186"><span><em>base curve</em></span></a>, then adjusted <a title="3.4.1.10. White balance" href="#sigil_toc_id_32"><span><em>white balance</em></span></a>. But at any time, the processing took the raw image, adjusted <a title="3.4.1.10. White balance" href="#sigil_toc_id_32"><span><em>white balance</em></span></a> on it, then&nbsp;<a title="3.4.1.8. Demosaic" href="#sigil_toc_id_187"><span><em>demosaic</em></span></a>, then <a title="3.4.1.4. Base curve" href="#sigil_toc_id_186"><span><em>base curve</em></span></a> (if enabled), then <a title="3.4.4.5. Denoise – bilateral" href="#sigil_toc_id_40"><span><em>bilateral filtering</em></span></a> (if enabled), as shown bottom to top on the right panel.</p>
<p>The history stack records your workflow in the order in which you made changes to the pipeline. It allows you to go back to an earlier stage of development if needed. The history stack represents your personal workflow and is not to be confused with the sequence in which modules are applied in the pixelpipe (see above). For more details on the history stack see <a title="3.3.3. History stack" href="#sigil_toc_id_29">Section 3.3.3, “History stack”</a>.</p>
<div>
<div>
<div>
<h3 id="sigil_toc_id_188">3.2.2. Interacting with modules</h3>
</div>
</div>
</div>
<p>A module has an expander bar&nbsp;<img alt="darkroom_module_expander" src="../Images/darkroom_module_expander.jpg" width="30%"/>. Clicking on the name of the module expands the module's GUI with all parameters.</p>
<p>In its default setting darktable will only expand one GUI at a time. If you click the expander bar of another module, the previous GUI gets collapsed. If you want to see more than one GUI expanded, you may expand further modules with <span><em>shift-click</em></span>  – all previously expanded GUIs remain opened. The expander bar behavior on <span><em>click</em></span> and <span><em>shift-click</em></span>, respectively, is controlled by a preference setting in GUI options (see&nbsp;<a title="8.1. GUI options" href="../Text/preferences.xhtml#sigil_toc_id_86">Section 8.1, “GUI options”</a>).</p>
<p>Expanding a module does <span><em>not</em></span> activate it. You need to click the&nbsp;<img alt="darkroom_module_icon_enable" src="../Images/darkroom_module_icon_enable.jpg" width="2%"/>&nbsp;icon to turn a module on or off.</p>
<p>Icon&nbsp;<img alt="darkroom_module_icon_presets" src="../Images/darkroom_module_icon_presets.jpg" width="2%"/>&nbsp;accesses the module's available presets or creates a new preset from your current settings (see <a title="3.2.3. Module presets" href="#sigil_toc_id_193">Section 3.2.3, “Module presets”</a>).</p>
<p>The&nbsp;<img alt="darkroom_module_icon_reset" src="../Images/darkroom_module_icon_reset.jpg" width="2%"/>&nbsp;icon is used to reset the module parameters to their default values.</p>
<p>Many of darktable's modules can have multiple instances, each with different settings. Click on the&nbsp;<img alt="darkroom_module_icon_instances" src="../Images/darkroom_module_icon_instances.jpg" width="2%"/>&nbsp;icon to generate new instances and control existing ones (see <a title="3.2.4. Multiple instances" href="#sigil_toc_id_180">Section 3.2.4, “Multiple instances”</a>).</p>
<p>The most frequently used control elements of modules are sliders, comboboxes and curves.</p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_189">3.2.2.1. Sliders</h4>
</div>
</div>
</div>
<p>Sliders offer five different ways of interaction, depending on the level of control you need.</p>
<div>
<ol type="1">
<li>
<p>Left-click</p>
<p>Click anywhere in the slider area to set the value. You can also click and drag to change it. You don't have to aim for the small triangle or even the line, the whole height including the label works as the active area.</p>
</li>
<li>
<p>Mouse wheel</p>
<p>Hover over any place on the slider with your mouse, then use your mouse wheel to adjust the value step by step.</p>
</li>
<li>
<p>Keyboard arrow keys</p>
<p>When the slider has keyboard focus you can hover over any place on the slider with your mouse, then use your keyboard's arrow keys (←/↓ and →/↑) to adjust the value stepwise. In order to give focus to the widget without changing the current value you can right-click, then right-click again.</p>
</li>
<li>
<p>Right-click</p>
<p>When your mouse is over a slider right-click gives you a multi-functional pop-up below the slider for fine control with your mouse or numerical entry using the keyboard.</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>darktable's innovative input method: for both coarse and fine value adjustments in a single control element combined with keyboard input.</td>
<td>
<div align="center"><img alt="darkroom_bauhaus" src="../Images/darkroom_bauhaus.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>A bent line extending from the triangular marker moves as you move your mouse. The closer your mouse pointer is to the triangular marker the coarser the control; the further away from the triangular marker the finer is your control. Left-click with your mouse to accept the new value and go back to normal control.</p>
<p>Alternatively you can type in a new value using your keyboard and commit by hitting the enter key. You may even supply the new value in the form of an arithmetic expressions which darktable will calculate for you – the old value is referenced as <span>“<span>x</span>”</span>.</p>
</li>
<li>
<p>Double-click</p>
<p>You can double-click on a parameter label to reset its value to default.</p>
</li>
</ol>
</div>
<p>Additionally, the mouse wheel and keyboard arrow keys support two input modifiers:</p>
<div>
<ul>
<li>
<p>You can hold down the <span><em>shift</em></span> key increasing the stepsize by a factor of 10. You can change this multiplier:</p>
<pre>darkroom/ui/scale_rough_step_multiplier=10.0
</pre>
<p> </p>
</li>
<li>
<p>You can hold <span><em>ctrl</em></span> key decreasing the stepsize by a factor of 10. You can change this multiplier:</p>
<pre>darkroom/ui/scale_precise_step_multiplier=0.1
</pre>
<p> </p>
</li>
</ul>
</div>
<p> </p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_190">3.2.2.2. Comboboxes</h4>
</div>
</div>
</div>
<p>Clicking on a combobox will open a list of available options. Click on the item you want to select. Sometimes the selection list opens close to the bottom or top of the screen and only part of the items are visible; scroll with your mouse wheel to bring up the full list. Alternatively, you can also use the mouse wheel and keyboard arrow keys to select an option.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_191">3.2.2.3. Curves</h4>
</div>
</div>
</div>
<p>Some modules are controlled by adjusting curves. More detail is given later in this chapter when the respective modules are explained.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_192">3.2.2.4. Undo/redo</h4>
</div>
</div>
</div>
<p>During editing darktable records all changes made in the history (see <a title="3.3.3. History stack" href="#sigil_toc_id_29">Section 3.3.3, “History stack”</a>). This includes modifications of any parameter in a module itself but also if a module instance is added or removed. Thanks to this recording it is possible to undo changes or redo them to recover a previous editing state. Note that this undo/redo facility is unlimited in the number of steps while editing an image but it is reset each time the darkroom is switched to a new image.</p>
<p>The default key shortcuts are:</p>
<div>
<ul>
<li>
<p><span><em>Ctrl-z</em></span> : undo last history modification</p>
</li>
<li>
<p><span><em>Ctrl-y</em></span> : redo last undo (does nothing if undo has not been used yet)</p>
</li>
</ul>
</div>
<p> </p>
<p>Please note that changes to drawn masks (see <a title="3.2.7. Drawn mask" href="#sigil_toc_id_194">Section 3.2.7, “Drawn mask”</a>) are not recorded and thus cannot be undone.</p>
<h3 id="sigil_toc_id_193">3.2.3. Module presets<br/></h3>
<p>Presets are stored configurations for a module's parameters. Some modules already have internal pre-defined presets but you can also define your own. Both internal and user-defined presets are displayed by clicking the&nbsp;<img alt="darkroom_module_icon_presets" src="../Images/darkroom_module_icon_presets.jpg" width="2%"/>&nbsp;icon with the currently activated preset shown in bold text.</p>
<p>The preset system also supports automatic preset selection based on image data such as focal length, ISO, camera model and other fields.</p>
<div class="sect3">
<div class="titlepage">
<div>
<div>
<h4 class="title" id="sigil_toc_id_195">3.2.3.1. Creating a new preset</h4>
</div>
</div>
</div>
<p>First configure the module's parameters then click the&nbsp;<img alt="darkroom_module_icon_presets" src="../Images/darkroom_module_icon_presets.jpg" width="2%"/>&nbsp;icon and select <span class="quote">“<span class="quote">store new preset</span>”</span>. The following dialog will be shown for configuring the preset:</p>
<p><img alt="new_preset" src="../Images/new_preset.jpg" class="center"/><br/></p>
<p> </p>
<p>The first two fields are used to name and describe the preset.</p>
<p>In the example above we have also checked the auto apply option. This brings up additional selection fields where you can define a filter used to decide if the preset should be automatically applied when opening other similar images in darkroom for the first time. The example dialog above sets up following rules: if lens name matches and aperture is greater or equal to f/8 and focal length is between 24 and 35mm the preset will be automatically applied. Also the second checkbox is clicked so this preset will only be shown in the preset list if the image matches the rule.</p>
<p>darktable finds this data in your image's Exif information. If you want a preset to be applied to all images from a specific camera leave all fields at default values except for the model field.</p>
<p>Tip: The <span class="emphasis"><em>image information</em></span> panel for your image displays your model name, use this to ensure you have the correct spelling (see <a class="xref" title="2.3.4. Image information" href="../Text/lighttable.xhtml#sigil_toc_id_77">Section 2.3.4, “Image information”</a>).</p>
</div>
<div class="sect3">
<div class="titlepage">
<div>
<div>
<h4 class="title" id="sigil_toc_id_196">3.2.3.2. Managing Presets</h4>
</div>
</div>
</div>
<p>Both user created and pre-defined presets can be viewed and managed from within the presets menu (<a class="xref" title="8.5. Presets" href="../Text/preferences.xhtml#sigil_toc_id_197">Section 8.5, “Presets”</a>) in the preferences dialog (see <a class="xref" title="Chapter 8. Preferences and settings" href="../Text/preferences.xhtml">Chapter 8, <em>Preferences and settings</em></a>).</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="navfooter"> </div>
<p> </p>
<h3 id="sigil_toc_id_180">3.2.4. Multiple instances<br/></h3>
<p>Many of darktable's modules can be applied multiple times. Each instance of that module behaves like any other module, taking its input from the module below in the pixelpipe delivering its output to the module above.</p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_198">3.2.4.1. Typical use cases</h4>
</div>
</div>
</div>
<p>There are many occasions where it makes sense to have an operation act more than once in the pixelpipe. Here are a few use cases.</p>
<div>
<ul>
<li>
<p>Most of our modules are highly versatile and depending on parameters can deliver quite varying effects. For example the <span><em>fill light</em></span> module (<a title="3.4.2.1. Fill light" href="#sigil_toc_id_200">Section 3.4.2.1, “Fill light”</a>) allows local modification of lightness based on pixel values. You might want to do two lightness corrections in your image at the same time – one for dark tones and another one for lighter tones.</p>
</li>
<li>
<p>You might want to apply a denoising module like <span><em>denoise (profile)</em></span> (<a title="3.4.4.3. Denoise – profiled" href="#sigil_toc_id_37">Section 3.4.4.3, “Denoise – profiled”</a>) with two different parameter sets. One to do luma denoising and another set of parameters to do chroma denoising. You could do so by generating two instances and use the first one only on luma by selecting blend mode <span>“<span>lightness</span>”</span> and use the second one just for chroma by selecting blend mode <span>“<span>color</span>”</span> (see <a title="3.2.6. Blending operators" href="#sigil_toc_id_201">Section 3.2.6, “Blending operators”</a>).</p>
</li>
<li>
<p>In an even more elaborate case you could have a module act on different parts of your image. As an example you might want to apply a certain gradation curve with module <span><em>tone curve</em></span> (<a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56">Section 3.4.2.3, “Tone curve”</a>) to your complete image and have a second curve being applied specifically to skin tones. All of the controls offered by <span><em>drawn masks</em></span> (<a title="3.2.7. Drawn mask" href="#sigil_toc_id_194">Section 3.2.7, “Drawn mask”</a>) and <span><em>parametric masks&nbsp;</em></span>(<a title="3.2.8. Parametric mask" href="#sigil_toc_id_202">Section 3.2.8, “Parametric mask”</a>) may be used to select those parts of an image where each of the module instances are applied.</p>
</li>
</ul>
</div>
<p>Please be aware that of course each instance also adds to the workload of your pixelpipe. Generating too many instances – especially of the more demanding modules – will certainly cause some noticeable slow-down.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_199">3.2.4.2. Managing instances</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>When clicking on the&nbsp;<img alt="darkroom_module_icon_instances" src="../Images/darkroom_module_icon_instances.jpg" width="2%"/>&nbsp;icon a drop-down menu will appear.<br/></td>
<td>
<div><img alt="instances" src="../Images/instances.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Selecting <span>“<span>new instance</span>”</span> generates a new module instance above any existing ones. All parameters are set to default values. The new instance gets its own complete set of GUI controls and a number appended to the base module name for distinction.</p>
<p>Selecting <span>“<span>duplicate instance</span>”</span> behaves in a similar way. The only difference: the new instance will inherit all parameter settings from its parent.</p>
<p>darktable applies all modules in a defined order according to their type. Therefore all instances of a particular module will occur together in the pixelpipe. You can however decide on the relative order in which the different instances of a module are applied by selecting <span>“<span>move up</span>”</span> or <span>“<span>move down</span>”</span> to shift the position of the instance among its peers.</p>
<p>To delete an instance just press <span>“<span>delete</span>”</span> from the drop-down menu.</p>
<div>
<div>
<div>
<h3 id="sigil_toc_id_203">3.2.5. Blending</h3>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_204">3.2.5.1. Overview</h4>
</div>
</div>
</div>
<p>By default a module takes its input from the preceding module, performs its calculations and handles its output over to the next module in the pixelpipe. On demand you can activate an additional step where a module's output is reprocessed with its input before giving the result to the next module. This additional processing step is called blending. Input and output can be processed with different algorithms, called blending operators or blend modes.</p>
<p>Each blend mode is further controlled by a parameter called opacity, which can have a value between 0% and 100% and defines how input and output image contribute to the final result. Typically an opacity value of 0% gives as a result an image that is identical to the input image – the module remains without effect. An opacity value of 100% delivers the maximum effect of the module with the blend mode chosen.</p>
<p>The opacity value can be the same for all image pixels. In this case blending acts uniformily on the image. Alternatively you can make opacity values to vary between different image locations or pixel values. This is called a mask and gives fine control over what parts of an image are affected by a module and to what extent. At your choice you may activate a drawn mask or a parametric mask or a combination of both.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_205">3.2.5.2. Usage</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Modules with blending support exhibit an additional combobox <span>“<span>blend</span>”</span> at the bottom of their GUI.</td>
<td>
<div><img alt="blending" src="../Images/blending.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_206">blend</h5>
</div>
</div>
</div>
<p>Blending is activated with this combobox. Depending on the value selected additional control elements will show up.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_207">off</h6>
</div>
</div>
</div>
<p>module's output is passed to the next module in pixelpipe without additional reprocessing. No further controls are displayed.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_208">uniformily</h6>
</div>
</div>
</div>
<p>reprocessing takes place with the chosen blend mode and opacity value – the same for all pixels. Additional controls to select blend mode and opacity value are displayed. The default blend mode is <span>“<span>normal</span>”</span> with an opacity of 100%.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_209">drawn mask</h6>
</div>
</div>
</div>
<p>reprocessing takes place with the chosen blend mode and opacity. Additional controls are displayed which allow you to draw a mask. If no mask elements are drawn all pixels have the same opacity, defined by the opacity slider. If you draw a mask element, e.g. a circle, the inner area of the circle will get maximum opacity, surrounded by a transition area or border with a gradual decay of opacity and the remaining image with an opacity of 0%. Different graphical shapes can be used. See&nbsp;<a title="3.2.7. Drawn mask" href="#sigil_toc_id_194">Section 3.2.7, “Drawn mask”</a> for further details.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_210">parametric mask</h6>
</div>
</div>
</div>
<p>reprocessing takes place with the chosen blend mode and opacity. Additional controls are displayed which allow you to adjust the opacity on a per-pixel basis determined by pixel values. In previous versions of darktable this was called <span>“<span>conditional blending</span>”</span>. See <a title="3.2.8. Parametric mask" href="#sigil_toc_id_202">Section 3.2.8, “Parametric mask”</a> for further details.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_211">drawn and parametric mask</h6>
</div>
</div>
</div>
<p>this option combines drawn and parametric masks and shows the full set of both controls. See <a title="3.2.9. Combining drawn and parametric masks" href="#sigil_toc_id_222">Section 3.2.9, “Combining drawn and parametric masks”</a> to learn how to best use this combination.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_212">Mask combination and inversion</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_213">invert mask</h6>
</div>
</div>
</div>
<p>When <span>“<span>drawn mask</span>”</span> is selected there is an additional combobox to invert the mask by switching mask inversion <span>“<span>on</span>”</span> or <span>“<span>off</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_214">combine masks</h6>
</div>
</div>
</div>
<p>When either <span>“<span>parametric masks</span>”</span>, or <span>“<span>drawn and parametric mask</span>”</span> are selected an additional combobox is shown that controls how the individual masks are combined to form the final mask. Details on the combination of individual masks can be found in <a title="3.2.9. Combining drawn and parametric masks" href="#sigil_toc_id_222">Section 3.2.9, “Combining drawn and parametric masks”</a>.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_215">Additional controls</h5>
</div>
</div>
</div>
<p>When blending with a mask there are some additional options to deal with the final mask: you may blur the mask, temporarily disable it, or display it as an overlay image.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_216">mask blur</h6>
</div>
</div>
</div>
<p>Blurring the mask creates a softer transition between blended and unblended parts of an image and avoids artifacts. The mask blur slider controls the radius of a gaussian blur applied to the final blend mask. The higher the radius, the stronger the blur – or set to 0 for an unblurred mask.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_217">temporarily switch off mask</h6>
</div>
</div>
</div>
<p>Sometimes it is useful to visualize the module's effect without the mask taking action. You can do so by clicking on the&nbsp;<img alt="darkroom_module_icon_eye" src="../Images/darkroom_module_icon_eye.jpg" width="2%"/>&nbsp;symbol, which will temporarily deactivate the mask – the selected blend mode and opacity remain in effect. Switch this button on and off to see if the mask is acting on the image as intended.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_218">display mask</h6>
</div>
</div>
</div>
<p>Clicking on the&nbsp;<img alt="darkroom_module_icon_mask" src="../Images/darkroom_module_icon_mask.jpg" width="2%"/>&nbsp;symbol will display the current mask as a yellow overlay over a black-and-white version of your image. Solid yellow indicates an opacity of 100%; a fully visible gray background image without yellow overlay indicates an opacity of 0%.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_219">3.2.5.3. Examples</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_220">Texturing an image</h5>
</div>
</div>
</div>
<p>The watermark module supports SVG files with embedded images that can be used as a texture source. Blending operators then allow control of how that texture is expressed.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_221">Gritty details</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>When blending operators were introduced into darktable, a new module named <span><em>highpass</em></span> (see <a title="3.4.5.7. Highpass" href="#sigil_toc_id_67">Section 3.4.5.7, “Highpass”</a>) was added. It provides a highpass filter of the image to be implicitly used with blending. It is used to produce a gritty detailed image and is a method widely used in the workflow of other imaging software.</td>
<td>
<div><img alt="blendop_highpass" src="../Images/blendop_highpass.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><a href="../Images/blendop_highpass_ex1_1.jpg"><img alt="blendop_highpass_ex1_1" src="../Images/blendop_highpass_ex1_1.jpg" width="100%"/></a>
</div>
</td>
<td>
<p>This is the original image, pretty heavily processed: first&nbsp;<a title="3.4.3.7. Monochrome" href="#sigil_toc_id_63"><span><em>monochrome</em></span></a>, then some blue <a title="3.4.5.3. Splittoning" href="#sigil_toc_id_223"><span><em>splittoning</em></span></a> but as you see it lacks pop in details and is a bit out of focus...</p>
</td>
</tr>
<tr>
<td><div><a href="../Images/blendop_highpass_ex1_2.jpg"><img alt="blendop_highpass_ex1_2" src="../Images/blendop_highpass_ex1_2.jpg" width="100%"/></a><br/>
</div>
</td>
<td>
<p>Here we applied the highpass filter with the values shown above. You can now see that the details are greatly boosted and we now have a really gritty detailed image.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h3 id="sigil_toc_id_201">3.2.6. Blending operators<br/></h3>
<p>There are several blend modes implemented and more might be added in future. For now all of the most commonly used ones are included and you will recognize a few of them from other imaging software. A good introduction on many common blend modes is given in the <a href="http://docs.gimp.org/2.8/en/gimp-concepts-layer-modes.html" target="_top"><span><em>GIMP Manual (Chapter 8.2, <span>“<span>Layer Modes</span>”</span>)</em></span></a>. Therefore we only discuss a few blend modes here in more detail.</p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_224">3.2.6.1. blend modes</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_225">normal</h5>
</div>
</div>
</div>
<p>This will probably be the most used blend mode. It just mixes input and output and, depending on the opacity value, it reduces the strength of a module's effect. Generally this is also the blend mode of choice if you want to apply a module's effect locally using masks.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_226">normal bounded</h5>
</div>
</div>
</div>
<p>This blend mode acts similarly to blend mode <span>“<span>normal</span>”</span>, except that input and output data are clamped to a particular min/max value range. Out-of-range values are effectively blocked and do not pass to the following modules. Sometimes this helps to prevent artifacts. However, in most cases (e.g. highly color saturated extreme highlights) it is better to let unbound values travel through the pixelpipe in order to properly deal with them at the right place (e.g. in module <a title="3.4.3.3. Output color profile" href="#sigil_toc_id_178"><span><em>output color profile</em></span></a>). Blend mode <span>“<span>normal</span>”</span> is most often the preferred choice.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_227">lightness</h5>
</div>
</div>
</div>
<p>This blend mode mixes lightness from the input and output images. Color data (chroma and hue) are taken unaltered from the input image.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_228">chroma</h5>
</div>
</div>
</div>
<p>This blend mode mixes chroma (saturation) from the input and output images. Lightness and hue are taken unaltered from the input image.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_229">hue</h5>
</div>
</div>
</div>
<p>This blend mode mixes hue (color tint) from the input and output images. Lightness and chroma are taken unaltered from the input image. Caution: When modules drastically modify hue (e.g. when generating complementary colors) this blend mode can result in strong color noise.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_230">color</h5>
</div>
</div>
</div>
<p>This blend mode mixes color (chroma and hue) from the input and output images. Lightness is taken unaltered from the input image. Caution: When modules drastically modify hue (e.g. when generating complementary colors) this blend mode can result in strong color noise.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_231">Lab lightness</h5>
</div>
</div>
</div>
<p>Only available with modules that work in the Lab color space; this blend mode mixes lightness from the input and output images, while color data are taken unaltered from the input image. In contrast to blend mode <span>“<span>lightness</span>”</span> this blend mode does not involve any color space conversion and does not clamp any data. In some cases this is less prone to artifacts in comparison to <span>“<span>lightness</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_232">Lab color</h5>
</div>
</div>
</div>
<p>Only available with modules that work in the Lab color space; this blend mode mixes Lab color channels a and b from the input and output images, while lightness data are taken unaltered from the input image. In contrast to blend mode <span>“<span>color</span>”</span> this blend mode does not involve any color space conversion and does not clamp any data. In some cases this is less prone to artifacts in comparison to <span>“<span>color</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_233">HSV lightness</h5>
</div>
</div>
</div>
<p>Only available with modules that work in the RGB color space; this blend mode mixes lightness from the input and output images, while color data are taken only from the input image. In contrast to blend mode <span>“<span>lightness</span>”</span> this mode does not involve clamping.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_234">HSV color</h5>
</div>
</div>
</div>
<p>Only available with modules that work in the RGB color space; this blend mode mixes color from the input and output images, while lightness data are taken only from the input image. In contrast to blend mode <span>“<span>color</span>”</span> this mode does not involve clamping.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_235">color adjustment</h5>
</div>
</div>
</div>
<p>Some modules act predominantly on the tonal values of an image but also perform some color saturation adjustments, e.g. module <a title="3.4.2.2. Levels" href="#sigil_toc_id_55"><span><em>levels</em></span></a> and <a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56"><span><em>tone curve</em></span></a>. The color adjustment blend mode takes the lightness only from output data and mixes colors from input and output enabling control of the module's color adjustments.</p>
</div>
</div>
</div>
<h3 id="sigil_toc_id_194">3.2.7. Drawn mask<br/></h3>
<p>Almost all darktable modules have the option to narrow down their effect by a drawn mask and thus allowing local adjustments.</p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_236">3.2.7.1. Overview</h4>
</div>
</div>
</div>
<p>With the drawn mask feature you can construct a mask by drawing directly on the image base. Different drawing operators, called shapes, are available and can be used alone or in combination. A flexible editing feature allows you to change single aspects of a shape, remove shapes or import shapes already defined in other modules.</p>
<p>Internally shapes are stored as vector graphics and rendered with the needed resolution during pixelpipe processing. Shapes are expressed in the coordinate system of the original image and transformed with all distorting modules. This way a shape will always work on the same image area regardless of warping or other modifications that may be applied.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_237">3.2.7.2. Usage</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>To draw a shape you need to click on one of the shape symbols. You will automatically be moved into the edit mode in which you generate a new instance of the selected shape and afterwards change its properties.</td>
<td>
<div><img alt="drawn_masks" src="../Images/drawn_masks.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>You leave edit mode by clicking on the&nbsp;<img alt="shape_edit" src="../Images/shape_edit.jpg" width="2%"/>&nbsp;symbol. You can at any time go back to edit mode and do further adjustments by clicking the edit symbol again. In edit mode you can also remove a shape by right-clicking on it – the shape is removed from the current mask but it's still in the list of defined shapes.</p>
<p>If you <span><em>ctrl-click</em></span> on the edit mode symbol you enter a restricted edit mode. Certain actions like dragging a complete shape or changing its size are blocked. Only finetuning changes like dragging a node are allowed.</p>
<p>Currently five shapes are implemented.</p>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_238">brush</h5>
</div>
</div>
</div>
<p>Clicking the&nbsp;<img alt="shape_brush" src="../Images/shape_brush.jpg" width="2%"/>&nbsp;symbol adds a brush stroke.</p>
<p>Start drawing by <span><em>left-clicking</em></span> into the canvas and moving the mouse while keeping the button pressed. The brush stroke is finalized once you release the mouse button. Brush size, hardness and opacity can be changed by <span><em>scrolling</em></span>, <span><em>shift+scrolling</em></span>, and<span><em>ctrl+scrolling</em></span>, respectively, either before you start drawing or at any time during the operation. Likewise you can use keys <span><em>[ | ]</em></span> to decrease/increase brush size, <span><em>{ | }</em></span> to decrease/increase hardness, and <span><em>&lt; | &gt;</em></span> to decrease/increase opacity.</p>
<p>If you have a graphics tablet with pen pressure sensitivity, darktable can apply the recorded pen pressure to certain attributes of the brush stroke. See <a title="8.1. GUI options" href="../Text/preferences.xhtml#sigil_toc_id_86">Section 8.1, “GUI options”</a> for more details.</p>
<p>On lifting the tablet pen or releasing the left mouse button the drawn figure is converted into a number of connected nodes which define the shape. A configuration option (see <a title="8.1. GUI options" href="../Text/preferences.xhtml#sigil_toc_id_86">Section 8.1, “GUI options”</a>) controls how much smoothing is applied. A higher level of smoothing leads to less nodes – this eases subsequent editing at the expense of a lower initial accuracy.</p>
<p>Nodes and segments of a brush stroke can be modified individually. See the documentation on <span><em>path</em></span> below for more details.</p>
<p>Rendering a complex brush shape can consume a significant number of CPU cycles; consider to revert to the circle, ellipse or path shape if possible.</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>A brush stroke with controls and activated mask display.</td>
<td>
<div><img alt="masks_brush_ex1" src="../Images/masks_brush_ex1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_239">circle</h5>
</div>
</div>
</div>
<p>Clicking the&nbsp;<img alt="shape_circle" src="../Images/shape_circle.jpg" width="2%"/>&nbsp;symbol adds a circle shape.</p>
<p><span><em>Click</em></span> into the canvas to place the circle. <span><em>Left-click</em></span> and drag the circle to a different position if needed. Use the scroll wheel of your mouse while in the circle to change the diameter; <span><em>scroll</em></span> within the circle border to adjust the width of the gradual decay or <span><em>shift+scroll</em></span> anywhere in the shape for the same effect. With <span><em>ctrl+scroll</em></span> you can adjust the opacity of the circle – this is best observed with the mask displayed by pressing the&nbsp;<img alt="darkroom_module_icon_mask" src="../Images/darkroom_module_icon_mask.jpg" width="2%"/>&nbsp;button.</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>A circle shape with controls and activated mask display.</td>
<td>
<div><img alt="masks_circle_ex1" src="../Images/masks_circle_ex1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_240">ellipse</h5>
</div>
</div>
</div>
<p>Clicking the&nbsp;<img alt="shape_ellipse" src="../Images/shape_ellipse.jpg" width="2%"/>&nbsp;symbol adds an ellipse shape.</p>
<p>The general principle is the same as for the circle shape. In addition you get four nodes on the ellipse line. <span><em>Click</em></span> on the nodes to adjust the ellipse's eccentricity. <span><em>Ctrl-click</em></span> on them to rotate the ellipse. <span><em>Shift-click</em></span> in the shape to toggle the gradual decay between equidistant and proportional mode.</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>An ellipse shape with controls and activated mask display.</td>
<td>
<div><img alt="masks_ellipse_ex1" src="../Images/masks_ellipse_ex1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_241">path</h5>
</div>
</div>
</div>
<p>Clicking the&nbsp;<img alt="shape_path" src="../Images/shape_path.jpg" width="2%"/>&nbsp;symbol adds a shape defined by a user defined closed path.</p>
<p><span><em>Left-click</em></span> into the canvas to define path nodes; terminate the path by <span><em>right-clicking</em></span>after having set the last point. Per default nodes are connected by smooth lines. If you want a node to define a sharp corner, you can do so by creating it with <span><em>ctrl-click</em></span>.</p>
<p>In the edit mode you can convert existing nodes from smooth to sharp corners and vice versa by <span><em>ctrl-clicking</em></span> on them. You can insert additional nodes by <span><em>ctrl-clicking</em></span> on one of the line segments. Single nodes can be deleted by <span><em>right-clicking</em></span> on them; make sure that the mouse pointer is over the desired node and the node is highlighted, or else you might accidentally remove the whole path.</p>
<p>The size of the complete shape can be modified by <span><em>scrolling</em></span> – analogous to the circle shape. The same holds true for the width of the border, i.e. the area with a gradual opacity decay, which can be changed by <span><em>scrolling</em></span> when it is highlighted or by<span><em>shift+scroll</em></span> from anywhere within the shape. Single nodes as well as path segments can be moved by mouse <span><em>dragging</em></span>. If a node is selected by <span><em>clicking</em></span> on it, a further control point appears – you can move it around to modify the curvature of the line and reset to default by <span><em>right-clicking</em></span>. <span><em>Dragging</em></span> one of the control points on the border adjusts the border width just in that part of the shape.</p>
<p>Consider to finetune a path in the restricted edit mode (see above), which allows you to adjust single nodes and segments without the risk of accidentally shifting or resizing the whole shape.</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>A path shape with controls and activated mask display.</td>
<td>
<div><img alt="masks_path_ex1" src="../Images/masks_path_ex1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_242">gradient</h5>
</div>
</div>
</div>
<p>Clicking the&nbsp;<img alt="shape_gradient" src="../Images/shape_gradient.jpg" width="2%"/>&nbsp;symbol adds a gradient to the mask. This does not generate a confined shape but produces a linear gradient extending the whole image.</p>
<p>Click into the canvas to define the position of the line where opacity is at 50%. The line has two anchor nodes which you can drag to change the rotation of the gradient.</p>
<p>Scrolling close to the center line changes the steepness of the gradient. Dotted lines indicate the distance beyond which the opacity is 100% and 0%, respectively. Between these dotted lines the opacity changes linearly. The gradient is best seen and modified when the mask is displayed by pressing the&nbsp;<img alt="darkroom_module_icon_mask" src="../Images/darkroom_module_icon_mask.jpg" width="2%"/>&nbsp;button.</p>
<p>Depending on the module and the underlying image using a gradient shape might provoke banding artifacts. You should consider to activate the <span><em>dithering</em></span> module (see <a title="3.4.4.13. Dithering" href="#sigil_toc_id_245">Section 3.4.4.13, “Dithering”</a>)</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>A gradient with controls and activated mask display.</td>
<td>
<div><img alt="masks_gradient_ex1" src="../Images/masks_gradient_ex1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_243">drawn mask</h5>
</div>
</div>
</div>
<p>The number of shapes that are used in the current mask is displayed in the <span>“<span>drawn mask</span>”</span> field. Clicking on that field opens a dropdown box with all shapes that have already been defined in the context of the current image but are not yet used in the current mask. You can click on any of these items in order to add it to the current mask. The list also contains shapes once generated but no longer in use. This way you can even get back a deleted shape.</p>
<p>A polarity button (&nbsp;<img alt="darkroom_module_icon_polarity_plus" src="../Images/darkroom_module_icon_polarity_plus.jpg" width="2%"/>&nbsp;and&nbsp;<img alt="darkroom_module_icon_polarity_minus" src="../Images/darkroom_module_icon_polarity_minus.jpg" width="2%"/>&nbsp;, respectively) allows the user to toggle between the normal and the inverted state of the drawn mask, i.e. the opacity values get inverted – 100% becomes 0% and vice versa. You need this feature when combining drawn and parametric masks (see <a title="3.2.9. Combining drawn and parametric masks" href="#sigil_toc_id_222">Section 3.2.9, “Combining drawn and parametric masks”</a>).</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_244">mask manager</h5>
</div>
</div>
</div>
<p>More functionality to control the interaction of multiple shapes within a mask can be found in the mask manager panel (see <a title="3.3.5. Mask manager" href="#sigil_toc_id_246">Section 3.3.5, “Mask manager”</a>). Here you can give individual names to your shapes which will help you to keep track of your shapes. You can also select individual shapes for editing – a helpful feature if your masks happens to contain several shapes with overlapping control elements.</p>
</div>
</div>
<h3 id="sigil_toc_id_202">3.2.8. Parametric mask<br/></h3>
<div>
<div>
<p>The parametric mask feature, formerly called <span>“<span>conditional blending</span>”</span>, offers fine-grained selective control over how individual pixels are blended. It does so by automatically generating an intermediate blend mask from user defined parameters. These parameters are color coordinates not the geometrical coordinates used in drawn masks.</p>
<p>The parametric mask is a powerful tool with a certain level of complexity.</p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_247">3.2.8.1. Overview</h4>
</div>
</div>
</div>
<p>For each data channel of a module (Lab, RGB) and additionally for several virtual data channels (e.g. hue, saturation) users can construct a per-channel opacity function. Depending on the pixel's value for this data channel this function determines a blending factor between 0 and 1 (or 100%) for that pixel.</p>
<p>Each pixel of an image thus has different blending factors for each of its data channels (real and virtual). All blending factors are finally pixel-wise multiplied together with the value of the global opacity slider (see <a title="3.2.6. Blending operators" href="#sigil_toc_id_201">Section 3.2.6, “Blending operators”</a>) to form a blend mask for the image.</p>
<p>If for a given pixel the blend mask has a value of 0, the input of the module is left unchanged. If for a pixel the blend mask has its maximum value of 1 (or 100%), the module has full effect.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_248">3.2.8.2. Usage</h4>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>When <span><em>parametric mask</em></span> is activated in combobox <span>“<span>blend</span>”</span>an additional set of tabbed controls is shown.</td>
<td>
<div><img alt="blendif_1" src="../Images/blendif_1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_249">Channel tabs</h5>
</div>
</div>
</div>
<p>Each tab selects a data channel – real or virtual. Modules acting in Lab color space have data channels for L, a, b, C (chroma of LCh) and h (hue of LCh). Modules acting in RGB color space have data channels for g (gray), R, G, B, H (hue of HSL), S (saturation of HSL), and L (lightness of HSL). Consult for example <a href="http://en.wikipedia.org/wiki/Color_space" target="_top">Wikipedia's article on color spaces</a> for a deeper look.</p>
<p>Each tab provides two sliders for its data channels: one for the input data that the module receives and one for the output data that the module produces prior to blending.</p>
<p>You can inspect the image data corresponding to an individual color channel by holding down the <span><em>shift</em></span> key while entering the respective slider with the mouse cursor. The center image changes to display the selected color channel either in graycale values or in false colors, depending on the corresponding preference setting in <span>“<span>GUI options</span>”</span> (see <a title="8.1. GUI options" href="../Text/preferences.xhtml#sigil_toc_id_86">Section 8.1, “GUI options”</a>). You may additionally hold down the <span><em>ctrl</em></span> key which lets you see the resulting mask overlaid to the image. When leaving the slider the image goes back to normal after a short delay.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_250">Color channel sliders</h5>
</div>
</div>
</div>
<p>With the color channel slider you construct a trapezoidal opacity function. For this purpose there are four markers per slider. Two triangles above the slider mark the range of values where opacity is 1. Two triangles below the slider mark the range values where opacity is zero. Intermediate points between full and zero opacities are given a proportional opacity.</p>
<p>The filled triangles, or inside markers, indicate the closed (mostly narrower) edge of the trapezoidal function. The open triangles, or outside markers, indicate the open (mostly wider) edge of the trapezoidal function. The sequence of the markers always remains unchanged: they can touch but they can not switch position.</p>
<p>A polarity button (&nbsp;<img alt="darkroom_module_icon_polarity_plus" src="../Images/darkroom_module_icon_polarity_plus.jpg" width="2%"/>&nbsp;and&nbsp;<img alt="darkroom_module_icon_polarity_minus" src="../Images/darkroom_module_icon_polarity_minus.jpg" width="2%"/>&nbsp;, respectively) to the right of the slider switches between <em>range select</em> and <em>range de-select</em> function modes with visual confirmation provided by exchanging the upper and the lower triangle markers. These two types of trapezoidal functions are represented graphically in the following images.</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="50%"/>
<col width="50%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>Range select function</p>
</td>
<td>
<p>Range de-select function</p>
</td>
</tr>
<tr>
<td>
<div><img alt="blendif_2a" src="../Images/blendif_2a.jpg" width="100%"/><br/>
</div>
</td>
<td>
<div><img alt="blendif_3a" src="../Images/blendif_3a.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>
<div><img alt="blendif_2b" src="../Images/blendif_2b.jpg" width="100%"/><br/>
</div>
</td>
<td>
<div><img alt="blendif_3b" src="../Images/blendif_3b.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>
<p>A trapezoidal function that selects a narrow range of values for blending.</p>
</td>
<td>
<p>A trapezoidal function that de-selects a narrow range of values from blending.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>In their default state all markers are at their extreme positions, maximum left and maximum right, respectively. In this state a <span><em>range select</em></span> function selects the whole range of values giving an <span>“<span>all at 100%</span>”</span> mask. Starting from there one can move the sliders inwards to gradually take out more an more parts of the image except of the remaining narrow range.</p>
<p>A <span><em>range de-select</em></span> function per default deselects the whole range of values, giving an <span>“<span>all-zero</span>”</span> mask as a starting point. Moving the sliders inwards gradually extends the mask more and more except of the remaining narrow range.</p>
<p>For more information on the polarity feature read <a title="3.2.9. Combining drawn and parametric masks" href="#sigil_toc_id_222">Section 3.2.9, “Combining drawn and parametric masks”</a>.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_251">Control buttons</h5>
</div>
</div>
</div>
<p>Control buttons help you when designing a parametric mask.</p>
<p>With the color picker button&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;you can select a probe from your image. The corresponding values for the real and virtual data channels are then displayed within each color channel slider. You can switch between point and area sampling mode from within the global color picker panel (see <a title="3.3.4. Global color picker" href="#sigil_toc_id_254">Section 3.3.4, “Global color picker”</a>).</p>
<p>With the invert button&nbsp;<img alt="darkroom_module_icon_invert" src="../Images/darkroom_module_icon_invert.jpg" width="2%"/>&nbsp;you can toggle the polarities of all channels (including a potentially activated drawn mask) and change the method how channels are combined into the final mask. More on that topic can be found in <a title="3.2.9. Combining drawn and parametric masks" href="#sigil_toc_id_222">Section 3.2.9, “Combining drawn and parametric masks”</a>.</p>
<p>With the reset button&nbsp;<img alt="darkroom_module_icon_reset" src="../Images/darkroom_module_icon_reset.jpg" width="2%"/>&nbsp;you can put all settings back to their default state.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_252">3.2.8.3. Examples</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_253">Colorkey effect</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>To create a colorkey effect with this poppy blossom in red and the remainder of the image in monochrome, we could apply module <a title="3.4.3.7. Monochrome" href="#sigil_toc_id_63"><span><em>monochrome</em></span></a> to all parts of the image except for of the saturated red petals.</p>
<p>We choose the hue channel to control our mask as hue provides good separation between the petals and background.</p>
</td>
<td>
<div><img alt="blendif_4" src="../Images/blendif_4.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>
<p>These settings in hue channel construct a parametric blend mask that excludes the red petals. The small white bar in the gradient was obtained by using the color picker on one of the petals and the markers then closely centered on the indicated hue to increase the selectivity of our mask.</p>
</td>
<td>
<div><img alt="blendif_5" src="../Images/blendif_5.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>
<p>The resulting blend mask.</p>
</td>
<td>
<div><img alt="blendif_6" src="../Images/blendif_6.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>
<p>The final image after module <span><em>monochrome</em></span> is applied.</p>
</td>
<td>
<div><img alt="blendif_7" src="../Images/blendif_7.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
</div>
</div>
<div> </div>
<h3 id="sigil_toc_id_222">3.2.9. Combining drawn and parametric masks<br/></h3>
<div>
<div>
<p>This section describes how darktable combines individual masks to form the final mask of a module. Individual masks are the drawn mask and all the single channels of the parametric mask. The topic is rather advanced – if you don't want to go through all the theoretical details just jump down where we describe two typical use cases.</p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_255">3.2.9.1. Overview</h4>
</div>
</div>
</div>
<p>There are two main elements which control how individual masks are combined: the polarity setting of each individual mask, defined by the plus or minus buttons, and the setting in the <span>“<span>combine masks</span>”</span> combobox (see <a title="3.2.5. Blending" href="#sigil_toc_id_203">Section 3.2.5, “Blending”</a>).</p>
<p>Masks can be regarded as grayscale images which take up values between 0 and 1.0 (or from 0% to 100%) for each pixel.</p>
<p>A straightforward way to combine masks is by multiplying the individual pixel values. The final mask will have a pixel value of 0 whenever one of the individual masks is 0 at that pixel location. The final mask can only reach a maximum pixel value of 1.0 if each and every of the individual masks has a value of 1.0 at that location. We call this way of combination <span>“<span>exclusive</span>”</span>. Any individual mask can exclude a pixel by setting its value to zero, regardless of what the other individual masks do. Once a pixel is excluded (its value is 0) by any mask there is no way to include it again by any other individual mask.</p>
<p>An alternative way to combine masks is the following: we first invert each individual mask  – calculating 1.0 minus its value – then we multiply these inverted masks and as a last step invert the final mask again. Now if one of the non-inverted individual masks has a value of 1.0 at a pixel location the final will also be 1.0. The final mask can only reach a pixel value of 0 if all the individual masks have a value of 0. We call this way of combination <span>“<span>inclusive</span>”</span>. Any individual mask can include a pixel by setting its value to 1.0, regardless of what the other individual masks do. Once a pixel is included (its value is 1.0) by any mask there is no way to exclude it again by any other individual mask.</p>
<p>These two combination methods alone would still be rather limiting. We gain maximum flexibility by allowing an additional inversion step for each individual mask. This is governed by the polarity buttons&nbsp;<img alt="darkroom_module_icon_polarity_plus" src="../Images/darkroom_module_icon_polarity_plus.jpg" width="2%"/>&nbsp;and&nbsp;<img alt="darkroom_module_icon_polarity_minus" src="../Images/darkroom_module_icon_polarity_minus.jpg" width="2%"/>&nbsp;that you find close to the individual channels. Toggling the polarity button of a mask inverts its values, i.e. it recalculates the pixel values to 1.0 minus the original value.</p>
<p>Finally within the <span>“<span>combine masks</span>”</span> combobox you may once again invert the final result to fit your needs by selecting the <span><em>exclusive &amp; inverted</em></span> or <span><em>inclusive &amp; inverted</em></span>options.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_256">3.2.9.2. Usage</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>You will typically want to combine drawn and parametric masks to first select a certain region of your image – either by the drawn or the parametric mask – and use the other mask type to finetune your selection. Finetuning can either mean that you want to include further parts of the image, which are not included in the first place, or you want to exclude parts of the image that were previously included.</td>
<td>
<div><img alt="combined_masks" src="../Images/combined_masks.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>This gives two typical use cases:</p>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_257">Inclusive mode</h5>
</div>
</div>
</div>
<p>For this mode you set the <span>“<span>combine masks</span>”</span> combobox to <span><em>inclusive</em></span> and make sure that all polarity buttons of all the individual channels and of the drawn mask are set to negative (&nbsp;<img alt="darkroom_module_icon_polarity_minus" src="../Images/darkroom_module_icon_polarity_minus.jpg" width="2%"/>&nbsp;). Your starting point is a mask where all pixels have a value of zero, i.e. no pixel is selected. You now adjust the parametric mask sliders to bring more and more pixels into the selection or you draw shapes on the canvas to select specific areas of your image.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_258">Exclusive mode</h5>
</div>
</div>
</div>
<p>In the opposite case you set the <span>“<span>combine masks</span>”</span> combobox to <span><em>exclusive</em></span> and make sure that all polarity buttons are set to positive (&nbsp;<img alt="darkroom_module_icon_polarity_plus" src="../Images/darkroom_module_icon_polarity_plus.jpg" width="2%"/>&nbsp;). Your starting point is a mask with all values at 1.0, i.e. all pixels selected. You now gradually change the parametric mask sliders to exclude parts of your image as needed or you directly draw shapes on the canvas to specifically exclude these areas.</p>
<p>For your convenience you find in the parametric masks GUI a&nbsp;<img alt="darkroom_module_icon_invert" src="../Images/darkroom_module_icon_invert.jpg" width="2%"/>&nbsp;toggle button that inverts all channel polarities and toggles between inclusive and exclusive mode in the “combine masks” combobox.</p>
<p>For novice users it is recommended to stick to these two use cases. This implies that you should decide beforehand how you want to construct your mask. Advanced users will find their way to take advantage of the many possible combinations of polarities and mask combination modes.</p>
</div>
</div>
</div>
</div>
<h3 id="sigil_toc_id_78">3.2.10. Color management<br/></h3>
<p>darktable employs a fully color managed workflow:</p>
<div>
<ul>
<li>
<p>Input color specifications are taken from embedded or user supplied ICC profiles or – in the case of raw files – from a library of camera specific color matrices.</p>
</li>
<li>
<p>darktable automatically reads the display profile of your monitor (if properly configured) for an accurate color rendition on screen. Multi-screen setups are fully supported as long as a system service like <span><em>colord</em></span> is in place and properly set up to inform darktable about the correct monitor profile.</p>
</li>
<li>
<p>Output files can be encoded in one of darktable's built-in profiles, like <a href="http://en.wikipedia.org/wiki/SRGB" target="_top">sRGB</a> or<a href="http://en.wikipedia.org/wiki/Adobergb" target="_top">AdobeRGB (compatible)</a>, or into any other output color space that the user supplies to darktable as an ICC profile.</p>
</li>
</ul>
</div>
<p> </p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_259">3.2.10.1. Display profile</h4>
</div>
</div>
</div>
<p>In order for darktable to accurately render colors on screen it needs to find the correct display profile of your monitor. In general this requires your monitor to be properly calibrated and profiled, and it needs the profile to be correctly installed on your system. darktable querys your X display server's <span><em>xatom</em></span> as well as the system service <span><em>colord</em></span> (if available) for the right profile. If needed you can enforce a specific method in the GUI preferences dialog (see <a title="8.1. GUI options" href="../Text/preferences.xhtml#sigil_toc_id_86">Section 8.1, “GUI options”</a>).</p>
<p>To investigate your display profile configuration you can call the <code>darktable-cmstest</code> binary which prints out useful information like profile name per monitor and tells you if the system is correctly configured (see <a title="1.1.6. darktable-cmstest binary" href="../Text/Overview.xhtml#sigil_toc_id_10">Section 1.1.6, “<code>darktable-cmstest</code> binary”</a>).</p>
<p>In rare cases you may need to manually select the display profile. This is possible from the softproof and gamut check option dialogs in the darkroom view (see&nbsp;<a title="3.3.9.5. Soft proof" href="#sigil_toc_id_261">Section 3.3.9.5, “Soft proof”</a> and <a title="3.3.9.6. Gamut check" href="#sigil_toc_id_262">Section 3.3.9.6, “Gamut check”</a>), and the display profile dialog in the lighttable view (see <a title="2.1. Overview" href="../Text/lighttable.xhtml#sigil_toc_id_75">Section 2.1, “Overview”</a>).</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_260">3.2.10.2. Rendering method</h4>
</div>
</div>
</div>
<p>A configuration parameter <span>“<span>always use LittleCMS 2 to apply output color profile</span>”</span> in darktable's <span><em>core options</em></span> (see <a title="8.2. Core options" href="../Text/preferences.xhtml#sigil_toc_id_5">Section 8.2, “Core options”</a>) defines how colors are rendered.</p>
<p>darktable can render colors either with its internal algorithms or by using the external library <a href="http://www.littlecms.com/" target="_top"><span><em>LittleCMS2</em></span></a>. darktable's internal method is by an order of magnitude faster than the external one. The external option gives you a choice of the rendering intent and might offer a slightly higher accuracy in some cases.</p>
<p>Note that if the given ICC is LUT-based or contains both, a LUT and a matrix, darktable will use LittleCMS 2 to render the colors regardless of that configuration parameter's value.</p>
</div>
<div> </div>
<h4 id="sigil_toc_id_179">3.2.10.3. Rendering intent<br/></h4>
<div>
<p>If rendering with LittleCMS2 is activated (see <a title="3.2.10.2. Rendering method" href="#sigil_toc_id_260">Section 3.2.10.2, “Rendering method”</a>) you can define how out-of-gamut colors are handled when converting between color spaces. A selection box in the export panel (see <a title="2.3.12. Export selected" href="../Text/lighttable.xhtml#sigil_toc_id_3">Section 2.3.12, “Export selected”</a>), the output color profile module (see <a title="3.4.3.3. Output color profile" href="#sigil_toc_id_178">Section 3.4.3.3, “Output color profile”</a>), and the soft proof option (see <a title="3.3.9.5. Soft proof" href="#sigil_toc_id_261">Section 3.3.9.5, “Soft proof”</a>) gives you a choice of the following rendering intents:</p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>perceptual</em></span></td>
<td>Suited to pictures as it maintains the relative position of colors. This is usually the best choice.</td>
</tr>
<tr>
<td><span><em>relative colorimetric</em></span></td>
<td>Out-of-gamut colors are converted to colors having the same lightness, but different saturation. Other colors remain unmodified.</td>
</tr>
<tr>
<td><span><em>saturation</em></span></td>
<td>Saturation is kept but lightness is slightly changed.</td>
</tr>
<tr>
<td><span><em>absolute colorimetric</em></span></td>
<td>Keep the white point.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_263">3.2.10.4. darktable's color spaces</h4>
</div>
</div>
</div>
<p>darktable's input images are either RGB files (like JPEGs or TIFFs) or camera raws – both represent colors by a combination of red, green and blue. Most part of our modules act in the <a href="http://en.wikipedia.org/wiki/Lab_color_space" target="_top">CIELAB color space</a> (often just called <span>“<span>Lab</span>”</span>) which describes color as a combination of lightness data (L) and a point in the a-b color plane. The final output of the image processing pipeline is once again in RGB, either shaped for the monitor display or the output file.</p>
<p>This process implies that the pixelpipe has two color conversion steps: <a title="3.4.3.11. Input color profile" href="#sigil_toc_id_266"><span><em>input color profile</em></span></a> and <a title="3.4.3.3. Output color profile" href="#sigil_toc_id_178"><span><em>output color profile</em></span></a>. In addition there is the <a title="3.4.1.8. Demosaic" href="#sigil_toc_id_187"><span><em>demosaic</em></span></a> step for raw images, where the colors of each pixel are reconstructed by interpolation.</p>
<p>Each module has a fixed position in the pixelpipe which tells you which color space the module lives in:</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="35%"/>
<col width="5%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>up to <span><em>demosaic</em></span></td>
<td> </td>
<td>Image is in raw data format with only latent colors. Each pixel carries lightness and color information for only one base color. Please mind that some of the modules in this part can also act on non-raw input images in RGB format with full information on all three color channels.</td>
</tr>
<tr>
<td>between <span><em>demosaic</em></span> and <span><em>input color profile</em></span></td>
<td> </td>
<td>Image is in RGB format within the color space of the specific camera or input file.</td>
</tr>
<tr>
<td>between <span><em>input color profile</em></span> and <span><em>output color profile</em></span></td>
<td> </td>
<td>Image is in Lab format. This is a very huge universal color space which covers all colors visible to the human eye (and even more). As darktable processes images in 4x32-bit floating point buffers, we can handle the Lab color space without risking banding or tonal breaks.</td>
</tr>
<tr>
<td>after <span><em>output color profile</em></span></td>
<td> </td>
<td>Image is in RGB format as defined by the selected display or output ICC profile.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_264">3.2.10.5. Unbounded colors</h4>
</div>
</div>
</div>
<p>Theoretically the individual components of color data are confined to certain minimum and maximum levels. As an example the intensity of an individual red, green or blue color channel in RGB can be anything in the range between 0% and 100% (or between 0.0 and 1.0). Likewise the L channel in Lab can be anything between 0 (pure black) and 100 (pure white).</p>
<p>In practice sometimes the image processing steps in darktable's modules can lead to values which lie outside of these confined ranges. In fact even the well established color matrices, which convert from camera RGB to Lab, may sometimes produce pixels with negative L values.</p>
<p>Pixels with these kind of values are said to have <span>“<span>unbounded colors</span>”</span>. One could <span><em>clamp</em></span>(i.e. confine) those values to the allowed range at every processing step. However, it has been found that it is much preferred and less prone to artifacts to not clamp in-between unbounded colors, but treat them just like any other color data.</p>
<p>In darktable there is no technical requirement for clamping; due to the fact that we are using floating point arithmetics for all processing steps, unbounded values can be passed along like any other value until the final color conversion module makes sure that they are transferred into the most reasonable color within the selected output color space. Therefore darktable avoids clamping as far as the underlying algorithms allow.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_265">3.2.10.6. Possible color artifacts</h4>
</div>
</div>
</div>
<p>That said there are some infrequent situations which still can lead to problematic results unless the user takes some action. Some modules in Lab color space, like&nbsp;<a title="3.4.2.2. Levels" href="#sigil_toc_id_55"><span><em>levels</em></span></a> and <a title="3.4.3.7. Monochrome" href="#sigil_toc_id_63"><span><em>monochrome</em></span></a>, need to rely on the fact that the L channels carries all lightness information and the a and b channels purely represent chroma and hue. Unbounded colors with negative L values are especially problematic to these modules and can lead to black pixel artifacts.</p>
<p>It has been found that highly saturated blue light sources in the image frame are hot candidates for pixels with negative L values. If you are engaged in stage photography you should pay close attention to image areas like that.</p>
<p>In order to mitigate that issue the <span><em>input color profile</em></span> module (see <a title="3.4.3.11. Input color profile" href="#sigil_toc_id_266">Section 3.4.3.11, “Input color profile”</a>) has a <span><em>gamut clipping</em></span> option. It is off by default but can be activated in case you observe artifacts. Depending on the settings, colors get confined to one of the offered RGB gamuts. In effect black pixel artifacts are prevented at the costs of losing some color dynamics. See <a title="3.4.3.11. Input color profile" href="#sigil_toc_id_266">Section 3.4.3.11, “Input color profile”</a> for an example.</p>
</div>
<h2 id="sigil_toc_id_182">3.3. Darkroom panels<br/></h2>
<div id="search_content">
<div class="sect1">
<p>This section contains documentation for panels that are specific to the darkroom view.</p>
<div class="sect2">
<div class="titlepage">
<div>
<div>
<h3 class="title" id="sigil_toc_id_267">3.3.1. Navigation</h3>
<table class="informaltable" border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>On the top left hand side the navigation panel displays a full preview of your image with a rectangle showing the currently visible zoom area in the central panel. Drag the rectangle around to pan the zoomed-in view. The current zoom scale is displayed to the right of the preview image. Click on that figure for a quick access to some common zoom levels.</td>
<td>
<div align="center"><img alt="panel_navigation" src="../Images/panel_navigation.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div>
<div>
<div>
<h3 id="sigil_toc_id_268">3.3.2. Snapshots</h3>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>You can take snapshots of images as you process them. A snapshot is stored as a bitmap of the current center view and is kept as long as you stay in the darkroom. A snapshot can then be selected and overlaid in the current center view to help you with a side by side comparison (left: snapshot, right: active) when you are tuning parameters of a module. This can also be combined with history (see <a title="3.3.3. History stack" href="#sigil_toc_id_29">Section 3.3.3, “History stack”</a>) to compare the snapshot against different stages of development.</td>
<td>
<div><img alt="panel_snapshots" src="../Images/panel_snapshots.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>You can control the split view by moving the splitline back and forth. If you hover with the mouse over the splitline, a small rotation icon will appear on the center of the line. Click it to change between vertical and horizontal split view.</p>
</div>
</div>
</div>

<div class="navfooter"> </div>
<h3 id="sigil_toc_id_29">3.3.3. History stack<br/></h3>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>The history stack lists every change of state (activate/de-activated) for all modules. Here you can <span><em>select</em></span> a point in the stack to return to a point in the development history. If you then activate a new module or change a module parameter, all modules above the selected point will be discarded.</p>
</td>
<td>
<div><img alt="panel_history" src="../Images/panel_history.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p><span><em>Caution: activating any module action using key accelerators will discard all modules above the currently selected one. It is easy to lose all development work on an image this way!</em></span></p>
<p>In darktable 2.0 it is safe to quit the program, leave the darkroom mode, or switch to another image while having selected some earlier state in the history stack panel. The history stack remains unchanged. When returning to the image you will find the history stack panel in the state where you left it.</p>
<p>Hitting <span>“<span>compress history stack</span>”</span> generates the shortest history stack that produces the current image, i.e. suppressing all obsolete stack items. This also will discard all modules above the currently selected one.</p>
<p>The button to the right&nbsp;<img alt="darkroom_styles" src="../Images/darkroom_styles.jpg" width="2%"/>&nbsp;lets you create a new style for applying your history stack to other images. Use the first line of the popup dialog window to name your style and the second to add a searchable description. You are prompted for which of the current history stack modules to include in the style.</p>
<p>Once created styles are then managed and applied to other images through lighttable's <span><em>styles</em></span> panel (see&nbsp;<a title="2.3.8. Styles" href="../Text/lighttable.xhtml#sigil_toc_id_146">Section 2.3.8, “Styles”</a>).</p>
<h3 id="sigil_toc_id_254">3.3.4. Global color picker<br/></h3>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>Using the global color picker you can take color samples from your image, display their values in multiple ways and compare colors from different locations. The color picker is activated by pressing the&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;icon. There are multiple parameters for controlling how the color picker works, whose settings remain in effect until you leave the darkroom mode.</p>
</td>
<td>
<div><img alt="panel_colorpicker" src="../Images/panel_colorpicker.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Besides the global color picker described here there are also local color pickers in some of the modules (eg. <a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56"><span><em>tone curve</em></span></a>). Global and local color pickers are different. The global color picker works in monitor color space and takes samples after the complete pixelpipe has been processed. The local color pickers run in the color space of the individual module, which is usually Lab; they reflect the input and output data of that specific module within pixelpipe.</p>
<p>The global color picker can be run in point or area mode. When in point mode only a small spot under your cursor is taken as a sample. In area mode you can draw a rectangle and darktable samples the area within that rectangle. The combobox to switch between point and area mode can also be used to toggle the mode of local color pickers.</p>
<p>If samples are taken in area mode, darktable will calculate mean, min and max color channel values. A combobox allows you to select which of those are displayed. For obvious statistical reasons mean, min and max are identical for the single sample of point mode.</p>
<p>A color swatch representing the sampled point or area is displayed. Numerical values are shown as well. As said before global color picker works in monitor RGB color space. You can also let darktable translate these numerical values into Lab color space. Beware that Lab values are approximated here; depending on monitor color profile there can be some deviations from the real values.</p>
<p>When the checkbox <span>“<span>restrict histogram to selection</span>”</span> is ticked, only the values of your selected area or point are taken into account by the main histogram at the top of the right hand panel (see <a title="3.3.6. Histogram" href="#sigil_toc_id_35">Section 3.3.6, “Histogram”</a>). This is a way to show which tonal values are present in a specific area.</p>
<p>The sampled colors in either area or point mode can be <span>“<span>stored</span>”</span> as live samples by pressing the <span>“<span>add</span>”</span> button. darktable will then show a color swatch and numerical values for each stored sample. You can once again select which numerical value (mean, min, max) is to be displayed and if this is to be done in RGB or Lab color space.</p>
<p>Newly created live samples are not locked. If you change your image the changes will be reflected in your live samples. Use this if you want see how changing parameters effects different parts of an image. Clicking on a live sample's color swatch locks it and a lock symbol is displayed. Further image changes will then no longer affect the sample. You can for example take two live samples from the same location and lock just one of them to provide a before and after sample comparison.</p>
<p>Live sample locations are indicated in your image if you check option <span>“<span>display sample areas on image</span>”</span>.</p>
<h3 id="sigil_toc_id_246">3.3.5. Mask manager<br/></h3>
<div>
<div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_269">3.3.5.1. Overview</h4>
</div>
</div>
</div>
<p>The masks manager panel is the central place where you manage all masks and shapes within the context of the current image. Here you create, delete and change shapes or give them unique names. You can add shapes to and remove shapes from a mask, and you define how multiple shapes interact within a mask.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_270">3.3.5.2. Usage</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>In the top line of the masks manager panel you find buttons to create new shapes. They are the same as in the <span><em>drawn mask</em></span> GUI (see <a title="3.2.7. Drawn mask" href="#sigil_toc_id_194">Section 3.2.7, “Drawn mask”</a> for more details).</td>
<td>
<div><img alt="panel_maskmanager_1" src="../Images/panel_maskmanager_1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>The lines below list all masks used and all individual shapes defined. The masks are noted with a headline in the form <span>“<span>grp levels</span>”</span> indicating the module in which they are used. The list of masks is followed by a list of all individual shapes which have been generated in the context of the given image. If a shape is in use by any of the masks it is marked by the&nbsp;<img alt="masks_used" src="../Images/masks_used.jpg" width="2%"/>&nbsp;symbol to the right of the shape name.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_271">3.3.5.3. Shapes</h4>
</div>
</div>
</div>
<p>By default shapes receive an automatically generated name, consisting of the shape type (<span>“<span>brush</span>”</span>, <span>“<span>circle</span>”</span>, <span>“<span>ellipse</span>”</span>, <span>“<span>path</span>”</span>, <span>“<span>gradient</span>”</span>) and a number that is incremented automatically. You can replace these automatically generated names by more meaningful ones. Double-clicking on the existing shape name prompts you for a new one. Giving a meaningful name is a good habit, especially if you are going to use the same selection in different masks. A name like <span>“<span>house front</span>”</span> makes it easier to get the right shape, rather than something like <span>“<span>path #32</span>”</span>.</p>
<p>Clicking on the shape name shows the selected shape in the center canvas with all its controls. This is a convenient way to edit the properties of a specific shape. Especially if there are so many shapes within a mask that their controls overlap and make it difficult to hit the right target.</p>
<p>Right-clicking on a shape name gives you a drop-down menu with the options to remove the current shape or to remove all shapes currently not in use.</p>
<p>All shapes ever defined for the current image are kept in the list unless you remove them explicitly. If you have worked a lot with shapes on one image, this list can get quite long. All settings – with all defined shapes – are part of the XMP tags of an image and are included in exported files. If the list of shapes is very long the needed space to store all shapes might exceed the given limits of certain file formats, like JPEG. In that case storing the XMP tags might fail during export. This is normally not a problem – however, you can no longer rely on the exported file to contain your full history stack (see&nbsp;<a title="2.3.12. Export selected" href="../Text/lighttable.xhtml#sigil_toc_id_3">Section 2.3.12, “Export selected”</a>).</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_272">3.3.5.4. Masks</h4>
</div>
</div>
</div>
<p>Clicking on the name of a mask expands a list showing the individual shapes which constitute that mask.</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Right-clicking on the shape name opens a drop-down menu. Here you define the way that the individual shapes interact to form the mask. You can also remove shapes from that mask.</td>
<td>
<div><img alt="panel_maskmanager_2" src="../Images/panel_maskmanager_2.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Masks are constructed by adding the shapes in the order that they are listed from top to bottom. Each shape adds to the mask by using at your choice one out of four logical set operators.</p>
<p>As order matters when combining shapes you may move each shape up or down if needed.</p>
<p>Each shape before being added can be inverted and is then depicted by the&nbsp;<img alt="masks_invert" src="../Images/masks_invert.jpg" width="2%"/>&nbsp;symbol.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_273">3.3.5.5. Set operators</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>We use as an example a combination of a gradient followed by a path to demonstrate the effect of the set operator which we apply to the path shape. As a convention we say that a pixel is <span>“<span>selected</span>”</span> in a mask or shape if it has a value higher than zero.</td>
<td>
<div><img alt="panel_maskmanager_ex1" src="../Images/panel_maskmanager_ex1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td> </td>
<td>
<div><img alt="panel_maskmanager_ex2" src="../Images/panel_maskmanager_ex2.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_274">union</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This is the default set operator. It is depicted by the&nbsp;<img alt="masks_union" src="../Images/masks_union.jpg" width="2%"/>&nbsp;symbol left to the shape name. The shape adds to the existing mask in such a way that the resulting mask contains the pixels that are either selected in the existing mask or in the added shape. In overlapping areas the maximum value is taken.<br/></td>
<td>
<div><img alt="panel_maskmanager_ex3" src="../Images/panel_maskmanager_ex3.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_275">intersection</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This set operator is depicted by the&nbsp;<img alt="masks_intersection" src="../Images/masks_intersection.jpg" width="2%"/>&nbsp;symbol left to the shape name. The shape adds to the existing mask in such a way that the resulting mask contains only pixels that are selected in both, the existing mask and the added shape. In overlapping areas the minimum value is used. In the given example we use this operator to “imprint” the path with a gradient.<br/></td>
<td>
<div><img alt="panel_maskmanager_ex4" src="../Images/panel_maskmanager_ex4.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_276">difference</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This set operator is depicted by the&nbsp;<img alt="masks_difference" src="../Images/masks_difference.jpg" width="2%"/>&nbsp;symbol. In the non-overlapping area the existing mask is unchanged. In the resulting mask pixels get selected only if they are selected in the existing mask but <em>not</em> in the added shape. This set operator can be chosen if you want to “cut out” a region from within an existing selection.<br/></td>
<td>
<div><img alt="panel_maskmanager_ex5" src="../Images/panel_maskmanager_ex5.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_277">exclusion</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This set operator is depicted by the&nbsp;<img alt="masks_exclusion" src="../Images/masks_exclusion.jpg" width="2%"/>&nbsp;symbol. The resulting mask has all pixels selected that are either selected in the existing mask and not in the added shape or vice versa. This is equivalent to an “exclusive or”.<br/></td>
<td>
<div><img alt="panel_maskmanager_ex6" src="../Images/panel_maskmanager_ex6.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<h3 id="sigil_toc_id_35">3.3.6. Histogram<br/></h3>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>This shows a histogram of the developed image's light levels. In its default state curves for all three RGB color channels are displayed. You can toggle the colored squares to enable or disable specific color channels. A curve button is also provided to toggle between linear view, logarithmic view and waveform view.</p>
<p>The histogram is directly linked to the <span><em>exposure</em></span> module described in <a title="3.4.1.5. Exposure" href="#sigil_toc_id_34">Section 3.4.1.5, “Exposure”</a>, and you can operate some of the exposure module's controls from the histogram. You can left-click towards the right hand side of the histogram and then drag right to increase or drag left to decrease the exposure. In a similar manner you can control the black level by clicking and dragging in the left hand side. Double-clicking in the histogram resets the exposure module's parameters to their defaults.</p>
</td>
<td>
<div><img alt="panel_histogram" src="../Images/panel_histogram.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
<br/>
<div>
<div>
<div>
<h3 id="sigil_toc_id_278">3.3.7. Module groups</h3>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>The module groups button bar gives you quick access to darktable's processing modules.</p>
</td>
<td>
<div><img alt="panel_modulegroups" src="../Images/panel_modulegroups.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Here follows a description of the module groups available:</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="20%"/>
<col width="20%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="darkroom_group_active" src="../Images/darkroom_group_active.jpg" width="100%"/><br/>
</div>
</td>
<td>Active</td>
<td>Modules you have activated and are using on the current image.</td>
</tr>
<tr>
<td>
<div><img alt="darkroom_group_favorites" src="../Images/darkroom_group_favorites.jpg" width="100%"/><br/>
</div>
</td>
<td>Favorites</td>
<td>Modules you have marked as favorites using <span><em>more modules</em></span> (see <a title="3.3.8. More modules" href="#sigil_toc_id_30">Section 3.3.8, “More modules”</a>).</td>
</tr>
<tr>
<td>
<div><img alt="darkroom_group_basic" src="../Images/darkroom_group_basic.jpg" width="100%"/><br/>
</div>
</td>
<td>Basic</td>
<td>Modules that are frequently used, such as exposure, temperature etc. (see <a title="3.4.1. Basic group" href="#sigil_toc_id_279">Section 3.4.1, “Basic group”</a>).</td>
</tr>
<tr>
<td>
<div><img alt="darkroom_group_tone" src="../Images/darkroom_group_tone.jpg" width="100%"/><br/>
</div>
</td>
<td>Tone</td>
<td>Modules for working with the image's tonal values, e.g. levels, tonemap etc. (see <a title="3.4.2. Tone group" href="#sigil_toc_id_280">Section 3.4.2, “Tone group”</a>).</td>
</tr>
<tr>
<td>
<div><img alt="darkroom_group_color" src="../Images/darkroom_group_color.jpg" width="100%"/><br/>
</div>
</td>
<td>Color</td>
<td>Modules for processing colors, such as color correction, vibrance etc. (see <a title="3.4.3. Color group" href="#sigil_toc_id_281">Section 3.4.3, “Color group”</a>).</td>
</tr>
<tr>
<td>
<div><img alt="darkroom_group_correction" src="../Images/darkroom_group_correction.jpg" width="100%"/><br/>
</div>
</td>
<td>Correction</td>
<td>Modules making corrections to the image, e.g. denoise, CA correction etc. (see <a title="3.4.4. Correction group" href="#sigil_toc_id_282">Section 3.4.4, “Correction group”</a>).</td>
</tr>
<tr>
<td>
<div><img alt="darkroom_group_effect" src="../Images/darkroom_group_effect.jpg" width="100%"/><br/>
</div>
</td>
<td>Effect</td>
<td>Modules with a more artistic output, such as vignetting, softening etc. (see <a title="3.4.5. Effect group" href="#sigil_toc_id_283">Section 3.4.5, “Effect group”</a>).</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>Clicking on one of the group symbols will show the modules in that group. If you once again click on the symbol, grouping will be de-activated and all non-hidden modules will be shown in one long list. This list shows the sequence in which modules are applied from bottom to top. As a general principle darktable applies modules in a pre-defined sequence.</p>
<h3 id="sigil_toc_id_30">3.3.8. More modules<br/></h3>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>More modules at the bottom of the right panel is used to show the less frequently used modules. By default only standard modules are shown to the user but you can use this function to make the extra modules visible, or alternatively to hide away modules you don't typically use.</td>
<td>
<div><img alt="panel_moremodules" src="../Images/panel_moremodules.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Each module is shown with a small icon next to its name. Left-click with your mouse to toggle the status between visible, hidden and favorite. Favorite modules are indicated by a star in front of the icon and in addition to appearing in their normal module group will also be visible in the module group&nbsp;<a title="3.3.7. Module groups" href="#sigil_toc_id_278"><span><em>favorites</em></span></a>. This is a good way to get fast access to modules that you use very frequently. Visible modules are indicated in the list by a light grey background whilst hidden modules have a dark grey background and do not display any of their controls.</p>
<p>Hiding or un-hiding modules is not meant to be part of your daily workflow, you should only occasionally need to review the modules you typically use. However, you may store various settings at your choice as presets for later reuse.</p>
<div>
<div>
<div>
<h3 id="sigil_toc_id_284">3.3.9. Bottom panel</h3>
</div>
</div>
</div>
<p>The bottom panel provides quick access to apply presets and styles to your image and allows to activate over/underexposure warning as well as softproofing and gamut check. You can also activate a filmstrip for quick navigation within the current collection.</p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_285">3.3.9.1. Quick access to favorite presets</h4>
</div>
</div>
</div>
<p>Clicking the&nbsp;<img alt="darkroom_module_icon_presets" src="../Images/darkroom_module_icon_presets.jpg" width="2%"/>&nbsp;icon opens a combobox that gives you quick access to your favorite module's presets. Click on the preset name to apply it to the image.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_286">3.3.9.2. Quick access to styles</h4>
</div>
</div>
</div>
<p>Clicking the&nbsp;<img alt="darkroom_styles" src="../Images/darkroom_styles.jpg" width="2%"/>&nbsp;icon opens a combobox with your styles. Hovering with the mouse over a style name opens a tooltip showing the involved modules. Click on a style name to apply that style to the image.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_287">3.3.9.3. Raw overexposed warning</h4>
</div>
</div>
</div>
<p>Clicking the&nbsp;<img alt="darkroom_module_icon_rawoverexposed" src="../Images/darkroom_module_icon_rawoverexposed.jpg" width="2%"/>&nbsp;icon warns you about areas of your raw input image with clipped color channels. Clipped color channels imply an overexposed image with loss of information in the affected areas. You may use the <em>highlight reconstruction</em> module or the <em>color reconstruction</em> module in order to reconstruct those areas (see&nbsp;<a title="3.4.1.9. Highlight reconstruction" href="#sigil_toc_id_52">Section 3.4.1.9, “Highlight reconstruction”</a> and <a title="3.4.1.7. Color reconstruction" href="#sigil_toc_id_51">Section 3.4.1.7, “Color reconstruction”</a>).</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Right-clicking on the icon opens a dialog with configuration parameters.</td>
<td>
<div><img alt="panel_rawoverexposed" src="../Images/panel_rawoverexposed.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<h6 id="sigil_toc_id_288">mode</h6>
<p>The default <span>“<span>mark with CFA color</span>”</span> mode displays a pattern of the respective primary colors (red, green, and blue) to indicate which color channels are found to be clipped. In the <span>“<span>mark with solid color</span>”</span> mode clipped areas are marked with a user defined solid color (see below) independent of the affected color channels. In the <span>“<span>false color</span>”</span>mode clipped color channels are set to zero in the affected areas.</p>
<h6 id="sigil_toc_id_289">color scheme</h6>
<p>Selects the solid color for the <span>“<span>mark with solid color</span>”</span> mode.</p>
<h6 id="sigil_toc_id_290">clipping threshold</h6>
<p>This slider sets the threshold of what values are considered to be overexposed. You can leave it at its default value 1.0 (white level) in most cases.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_291">3.3.9.4. Over/underexposed warning</h4>
</div>
</div>
</div>

<p>By clicking the&nbsp;<img alt="darkroom_module_icon_overexposed" src="../Images/darkroom_module_icon_overexposed.jpg" width="2%"/>&nbsp;icon an over/underexposed warning is toggled on or off. Pixels outside the dynamic range, close to pure white or close to pure black, are prominently displayed in a signal color. You can also activate the over/underexposure warning with the keyboard shortcut “o”.</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Right-clicking on the icon opens a dialog with configuration parameters.</td>
<td>
<div><img alt="panel_overexposed" src="../Images/panel_overexposed.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<h6 id="sigil_toc_id_292">color scheme</h6>
<p>In the default color scheme underexposed pixels are shown in blue and overexposed pixels in red. These colors are easy to identify in most cases. In some cases you may want to change the color scheme to <span>“<span>black &amp; white</span>”</span> or <span>“<span>purple &amp; green</span>”</span>, eg. if you experience overexposed highlights in red blossoms.</p>
<h6 id="sigil_toc_id_293">lower threshold</h6>
<p>Sets the threshold for underexposure warning, expressed as a percentage of the maximal brightness.</p>
<h6 id="sigil_toc_id_294">upper threshold</h6>
<p>Sets the threshold for overexposure warning, expressed as a percentage of the maximal brightness.</p>
</div>
<h4 id="sigil_toc_id_261">3.3.9.5. Soft proof<br/></h4>
<p>Clicking the&nbsp;<img alt="darkroom_module_icon_softproof" src="../Images/darkroom_module_icon_softproof.jpg" width="2%"/>&nbsp;icon activates the soft proof display mode of your image. Soft proof allows you to preview your image rendered using a printer profile so as to see how colors will end up on the final print. You can also activate soft proof with the keyboard shortcut “ctrl-s”. An information message “soft proof” on the bottom left of your image tells you that you are in soft proof display mode.</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Right-clicking on the icon opens a dialog with configuration parameters.</td>
<td>
<div><img alt="panel_softproof" src="../Images/panel_softproof.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<h6 id="sigil_toc_id_295">display intent</h6>
<p>Sets the rendering intent for your display – only available if rendering with LittleCMS2 is activated. See&nbsp;<a title="3.2.10.3. Rendering intent" href="#sigil_toc_id_179">Section 3.2.10.3, “Rendering intent”</a> for available options.</p>
<h6 id="sigil_toc_id_296">softproof profile</h6>
<p>Sets the color profile for soft proofing. darktable searches for available profiles in<code>$DARKTABLE/share/darktable/color/out</code> and<code>$HOME/.config/darktable/color/out</code>. <code>$DARKTABLE</code> is used here to represent your chosen darktable installation directory and <code>$HOME</code> your home directory. Typically these profiles are supplied by your printer or generated during printer profiling.</p>
<h6 id="sigil_toc_id_297">display profile</h6>
<p>Sets the color profile for the display. The option <span>“<span>system display profile</span>”</span> is the preferred setting when working with a calibrated display; the profile is taken either from your system's color manager or from your X display server. In <span><em>GUI options</em></span> (see <a title="8.1. GUI options" href="../Text/preferences.xhtml#sigil_toc_id_86">Section 8.1, “GUI options”</a>) you can specify which method to use. For more information see <a title="3.2.10.1. Display profile" href="#sigil_toc_id_259">Section 3.2.10.1, “Display profile”</a>.</p>
<h4 id="sigil_toc_id_262">3.3.9.6. Gamut check<br/></h4>
<p>Clicking the&nbsp;<img alt="darkroom_module_icon_gamutcheck" src="../Images/darkroom_module_icon_gamutcheck.jpg" width="2%"/>&nbsp;icon activates the gamut check display mode of your image. Gamut check highlights in cyan all pixels out of gamut with respect to the selected softproof profile. You can also activate gamut check with the keyboard shortcut <span class="quote">“<span class="quote">ctrl-g</span>”</span>. An information message <span class="quote">“<span class="quote">gamut check</span>”</span> on the bottom left of your image tells you that you are in gamut check display mode. Gamut check and soft proof are mutually exclusive modes.</p>
<p>Right-clicking on the icon opens a dialog with configuration parameters – they are the same as for the soft proof option (see <a class="xref" title="3.3.9.5. Soft proof" href="#sigil_toc_id_261">Section 3.3.9.5, “Soft proof”</a>).</p>
<h4 id="sigil_toc_id_76">3.3.9.7. Filmstrip<br/></h4>
<p>The optional filmstrip can be used to quickly switch between images while remaining in the darkroom view. The images viewed are the same as the ones in the lighttable view.</p>
<p>The filmstrip can be switched on and off using the shortcut <span><em>ctrl-f</em></span>. You can change the height of the filmstrip panel by dragging its top.</p>
<p>You can scroll with your mouse to quickly navigate through the images. You can change the photo being processed by double clicking on another picture. You can also use space bar to process the next photo and use backspace key to process the previous photo.</p>
<p>The picture currently processed is selected and highlighted; with a single click you can select any other picture from the filmstrip without changing the picture currently processed. With the <span><em>ctrl-a</em></span> shortcut you select all the pictures of the filmstrip. With the shortcut <span><em>ctrl-shift-a</em></span> you unselect all images, and with <span><em>ctrl-i</em></span> you reverse the current selection.</p>
<p>The following shortcuts are available to act on the selected picture(s):</p>
<div>
<table border="0" width="100%"><colgroup><col width="25%"/>
<col width="75%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>F1 – F5</em></span></td>
<td>toggle color label (red, yellow, green, blue, purple)</td>
</tr>
<tr>
<td><span><em>0 – 5</em></span></td>
<td>set/change image rating</td>
</tr>
<tr>
<td><span><em>r</em></span></td>
<td>reject image</td>
</tr>
<tr>
<td><span><em>ctrl-d</em></span></td>
<td>duplicate image</td>
</tr>
<tr>
<td><span><em>ctrl-c</em></span></td>
<td>copy the full history stack</td>
</tr>
<tr>
<td><span><em>ctrl-v</em></span></td>
<td>paste all of the copied history stack</td>
</tr>
<tr>
<td><span><em>alt-ctrl-c</em></span></td>
<td>selectively copy the history stack</td>
</tr>
<tr>
<td><span><em>alt-ctrl-v</em></span></td>
<td>selectively paste from the copied history stack</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p> </p>
<div><img alt="filmstrip" src="../Images/filmstrip.jpg" class="center"/><br/></div>
<h2 id="sigil_toc_id_185">3.4. Modules<br/></h2>
<div>Modules are organized into five functional groups: basic, tone, color, correction and effect. You either view all modules in one long list or instead click on a group to just display modules belonging to that group.<br/></div>
<h3 id="sigil_toc_id_279">3.4.1. Basic group<br/></h3>
<div>The basic group of modules contains the modules for basic development. These are ones you probably will use most often, such as exposure, white balance etc.<br/></div>
<h4 id="sigil_toc_id_46">3.4.1.1. Crop and rotate<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_298">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is used to crop, rotate and correct perspective distortions of your image. You can overlay your image with various helpful guidelines that assist you using the tools.</td>
<td>
<div><img alt="crop_and_rotate" src="../Images/crop_and_rotate.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Some of the tools of this module, namely adjustment of angle and corrections of perspective distortion, will require the original image data to be interpolated. For best sharpness results set <span>“<span>lanczos3</span>”</span> as pixel interpolator in <span><em>core options</em></span> (see <a title="8.2. Core options" href="../Text/preferences.xhtml#sigil_toc_id_5">Section 8.2, “Core options”</a>).</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_299">Usage</h5>
</div>
</div>
</div>
<p>Whenever the user interface of this module is in focus, you will see the full uncropped image overlaid with handles and guiding lines.</p>
<p>First off, select what aspect ratio you want and size the crop boundaries by dragging border and corner handles. Use the button right of the aspect box, to swap between portrait and landscape mode. You can move around the crop rectangle by holding down left mouse button and move around. When you are done and want to execute the crop, just give focus to another module or double-click into the image base. You can at any time change your crop area by just revisiting this module.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_300">flip</h6>
</div>
</div>
</div>
<p>This tool is used to flip the image on the horizontal,vertical or both axis.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_301">angle</h6>
</div>
</div>
</div>
<p>This tool corrects the rotation angle helping you level an image. You can either set a numerical value or use your mouse directly on the image. To use your mouse, right-click, hold it down and draw a line along a suited horizontal or vertical feature; as soon as you release the mouse button the image is rotated so the line you drew matches the horizontal/vertical axis.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_302">keystone</h6>
</div>
</div>
</div>
<p>This tool is used to correct perspective distortions in your image. Useful for example when you shoot a high building from ground with a short focal length, aiming upwards with your camera. The combobox lets you select the type of correction you want to use :</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="19%"/>
<col width="81%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>vertical</em></span></td>
<td>if you want to limit the correction to vertical lines</td>
</tr>
<tr>
<td><span><em>horizontal</em></span></td>
<td>limit the correction to horizontal lines</td>
</tr>
<tr>
<td><span><em>free</em></span></td>
<td>if you want to correct horizontal and vertical lines</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="20%"/>
<col width="20%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>Depending on the selected correction type you will see two or four straight adjustment lines overlaid to your image. Two red circles on every line let you modify the line positions with your mouse. Each line additionally carries a <span>“<span>symmetry</span>”</span> button. If activated (and highlighted in red) all movements of the affected line will be mirrored by the opposite line.</p>
<p>In order to correct perspective distortions, you need to find suitable horizontal and/or vertical features in your image and align the adjustment lines with them. When done, press the <span>“<span>OK</span>”</span> button, which is located close to the center of your image. The image will be corrected immediately. You can at any time come back and refine your corrections by selecting <span>“<span>correction applied</span>”</span> in combobox keystone.</p>
</td>
<td>
<div><img alt="crop_and_rotate_k_set" src="../Images/crop_and_rotate_k_set.jpg" width="100%"/><br/>
</div>
</td>
<td>
<div><img alt="crop_and_rotate_k_applied" src="../Images/crop_and_rotate_k_applied.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_303">automatic cropping</h6>
</div>
</div>
</div>
<p>Use this options to avoid black edges on the image borders. Useful when you rotate the image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_304">aspect</h6>
</div>
</div>
</div>
<p>Here you can change what aspect ratio you want to have on the result, thus constraining the proportion of width and height of the crop rectangle to the aspect ratio of your choice. Many common numerical ratios are pre-defined. A few special aspect ratios deserve explanation:</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="19%"/>
<col width="81%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>free</em></span></td>
<td>free forming the rectangle without any ratio restrictions</td>
</tr>
<tr>
<td><span><em>image</em></span></td>
<td>this option constrains the ratio to be equal to image ratio</td>
</tr>
<tr>
<td><span><em>golden cut</em></span></td>
<td>this option constrains the ratio to be equal the golden number</td>
</tr>
<tr>
<td><span><em>square</em></span></td>
<td>this option constrains the ratio to be 1</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>You can also select any other ratio after opening the combobox and typing it in the form of <span>“<span>x:y</span>”</span>. If you want a certain aspect ratio to be added to the pre-defined ones you can do so by including a line of the form</p>
<p> </p>
<pre>plugins/darkroom/clipping/extra_aspect_ratios/foo=x:y
</pre>
<p> </p>
<p>into darktable's configuration file <code>$HOME/.config/darktable/darktablerc</code>. Here <span>“<span>foo</span>”</span> defines the name of the new aspect ratio and <span>“<span>x</span>”</span> and <span>“<span>y</span>”</span> the corresponding numerical values.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_305">guides</h6>
</div>
</div>
</div>
<p>Many self-explaining guides are available to help you compose your image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_306">guides flip</h6>
</div>
</div>
</div>
<p>In case the chosen guidelines are not symmetrical relative to the image frame, you can flip them on the horizontal,vertical or both axis.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_307">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="crop_and_rotate_ex1" src="../Images/crop_and_rotate_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>A cropped image in center view when module crop and rotate is in focus. The cropped area is visible as well as some guiding lines.</td>
</tr>
</tbody>
</table>
</div>
</div>
<h4 id="sigil_toc_id_135">3.4.1.2. Orientation<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_308">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module allows the user to modify the orientation of an image. By default it is active for all images and receives its standard settings from the camera's orientation flag stored in the Exif data.</td>
<td>
<div><img alt="orientation" src="../Images/orientation.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_309">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_310">rotate</h6>
</div>
</div>
</div>
<p>Clicking on one of the buttons causes a counter-clockwise or clockwise rotation in steps of 90 degrees.</p>
</div>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_50">3.4.1.3. Shadows and Highlights<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_311">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The shadows and highlights module allows adjustment to the tonal range of darker parts of an image (shadows) and lighter parts (highlights); it can bring back details in shadows and highlights by enhancing local contrast.</td>
<td>
<div><img alt="shadhi" src="../Images/shadhi.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_312">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_313">shadows</h6>
</div>
</div>
</div>
<p>This slider controls the effect on shadows; positive values will lighten up shadows while negative values will darken them.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_314">highlights</h6>
</div>
</div>
</div>
<p>This slider controls the effect on highlights; negative values will darken highlights while positive values will lighten them up.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_315">white point adjustment</h6>
</div>
</div>
</div>
<p>By default the algorithm of this modules leaves black point and white point untouched. In some cases an image might contain tonal variations beyond the white point, i.e. above a luminance value of 100. A negative shift in the white point adjustment slider allows to bring these values down into the proper range so that further details in the highlights get visible.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_316">soften with</h6>
</div>
</div>
</div>
<p>This combobox chooses the underlying blurring filter, gaussian or bilateral. Try bilateral filter if you experience halos with gaussian blur.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_317">radius</h6>
</div>
</div>
</div>
<p>This slider controls the radius of the involved blurring filter. Higher values give softer transitions between shadows and highlights but might introduce halos. Lower values will reduce the size of halos but may lead to an artificial look. As said, bilateral filter is much less prone to halo artifacts.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_318">compress</h6>
</div>
</div>
</div>
<p>This slider controls how strong the effect extends to midtones; high values reduce the effect to the extreme shadows and highlights; low values cause strong adjustments also to midtones. You normally only need to touch this parameter if you want to limit the effects to the extreme shadows and highlights; increase the value in this case. At 100% this module has no visible effect any longer as only absolute black and absolute white are affected.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_319">shadows color adjustment</h6>
</div>
</div>
</div>
<p>This slider controls the color saturation adjustment made to shadows; high values cause saturation enhancements on lightened shadows; low values cause desaturation on lightened shadows. It is normally safe to leave this at its default of 100%. This gives a natural saturation boost on shadows – similar to the one you would also expect in nature if shadows would receive more light.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_320">highlights color adjustment</h6>
</div>
</div>
</div>
<p>This slider controls the color saturation adjustment made to highlights; high values cause saturation enhancements on darkened highlights; low values cause desaturation on darkened highlights. Often highlights do not contain enough color information to give convincing colors when darkened. You might need to play a bit with this parameter in order to find the best fitting value depending on your specific image; but be aware that sometimes results still might not be fully satisfying.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_321">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="shadhi_ex1" src="../Images/shadhi_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>Original image exposed for the outer sunlit wall to avoid clipped highlights. As a consequence the interior of the barn has pitch black shadows.</td>
</tr>
<tr>
<td>
<div><img alt="shadhi_ex2" src="../Images/shadhi_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>Shadows get lightened; highlights are untouched; overall effect toned down a bit by <a title="3.2.6. Blending operators" href="#sigil_toc_id_201"><span><em>blend mode</em></span></a> <span>“<span>normal</span>”</span> and an opacity of 65%.</td>
</tr>
<tr>
<td>
<div><img alt="shadhi_ex3" src="../Images/shadhi_ex3.jpg" width="100%"/><br/>
</div>
</td>
<td>Resulting image.</td>
</tr>
</tbody>
</table>
</div>
</div>
<h4 id="sigil_toc_id_186">3.4.1.4. Base curve<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_322">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Camera sensors provide data in linear RGB format, the original image appears flat and dull. That's the reason why camera manufacturers apply their characteristic base curves to the raw data when they generate in-camera JPEG images with better colors and contrast.</td>
<td>
<div><img alt="basecurve" src="../Images/basecurve.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_323">Usage</h5>
</div>
</div>
</div>
<p>darktable comes with base curve presets that mimic the curves of various manufacturers. These are automatically applied to raw images according to the manufacturer ID found in Exif data. For several camera models darktable comes with base curves adapted for that specific model. A configuration option in the core preferences dialog (see <a title="8.2. Core options" href="../Text/preferences.xhtml#sigil_toc_id_5">Section 8.2, “Core options”</a>) defines whether darktable by default should apply the per-camera base curve or the manufacturer one.</p>
<p>You can adjust an existing base curve or create a new one. The base curve is defined by two or more nodes. You can move any node to modify the curve. You can also create additional nodes by <span><em>clicking</em></span> on a curve segment between two nodes. With <span><em>ctrl-click</em></span> you generate a new node at the x-location of the mouse pointer and the corresponding y-location of the current curve – this adds a node without risking to accidentally modify the curve. In order to remove a node move it outside of the widget area.</p>
<p>Tip: If you intend to take full manual control of the tonal values with the <span><em>tone curve</em></span>module or the <span><em>zone system</em></span> module (see <a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56">Section 3.4.2.3, “Tone curve”</a> and <a title="3.4.2.4. Zone system" href="#sigil_toc_id_57">Section 3.4.2.4, “Zone system”</a>) it may be easier to leave the image in linear RGB. Disable the <span><em>base curve</em></span> module in this case.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_324">scale</h6>
</div>
</div>
</div>
<p>This combobox toggles between <span>“<span>linear</span>”</span> and <span>“<span>logarithmic</span>”</span> view. In the double logarithmic view more space is given to the lower values allowing a more fine-grained adjustment of the shadows.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_325">fusion</h6>
</div>
</div>
</div>
<p>This control triggers the <a href="https://en.wikipedia.org/wiki/Exposure_Fusion" target="_top"><span><em>exposure fusion</em></span></a> feature. You can choose to merge the image with one or two copies of itself after applying the current base curve and boosting its exposure by a selectable number of ev units. The resulting image is thus a combination of two or three different exposures of the original image. Use this to compress dynamic range for extremely underexposed images or for true HDR input. For best results, use the exposure module (see <a title="3.4.1.5. Exposure" href="#sigil_toc_id_34">Section 3.4.1.5, “Exposure”</a>) to apply a suitable adjustment for correctly exposed highlights.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_326">exposure shift</h6>
</div>
</div>
</div>
<p>This slider is only visible if the <span><em>exposure fusion</em></span> feature is activated. It allows you to set the exposure difference between the merged images in ev units (default 1).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_327">exposure bias</h6>
</div>
</div>
</div>
<p>This slider is only visible if the <span><em>exposure fusion</em></span> feature is activated. It allows you to chose how the multiple exposures are computed. With a bias of 1 (the default), the image is fused with overexposed copies of itself. With a bias of -1, it is fused with underexposed copies. A bias of 0 tries to preserve the overall lightness of the image by combining both over and under-exposed copies of the image.</p>
</div>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_34">3.4.1.5. Exposure<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_328">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is used to tweak the exposure. It is directly linked to the histogram panel. If you correct exposure graphically, using the <span><em>histogram </em></span>(see <a title="3.3.6. Histogram" href="#sigil_toc_id_35">Section 3.3.6, “Histogram”</a>), you automatically activate the exposure module. The histogram simply acts as a view for the exposure module.</td>
<td>
<div><img alt="exposure" src="../Images/exposure.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>You can activate multiple instances of this module each with different parameters acting on different parts of the image which you select by a drawn mask (see&nbsp;<a title="3.2.4. Multiple instances" href="#sigil_toc_id_180">Section 3.2.4, “Multiple instances”</a> and&nbsp;<a title="3.2.7. Drawn mask" href="#sigil_toc_id_194">Section 3.2.7, “Drawn mask”</a>). The histogram is always linked to the last instance in pixelpipe.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_329">Usage</h5>
</div>
</div>
</div>
<p>This module is responsible for one of the most basic steps in each raw image development. An exposure adjustment value allows you – within certain limits – to correct for under- or overexposure. A shift by 1EV is equivalent to a change of exposure time by a factor of 2.</p>
<p>Positive exposure corrections will make the image brighter. As a side effect noise level gets higher. Depending on the basic noise level of your camera and the ISO value of your image, positive exposure compensations with up to 1EV or 2EV still give reasonable results.</p>
<p>Negative exposure corrections will make the image darker. Given the nature of digital images this can not correct for fully blown out highlights but allows to reconstruct data in case that only some of the RGB channels are clipped (see also <a title="3.4.1.9. Highlight reconstruction" href="#sigil_toc_id_52">Section 3.4.1.9, “Highlight reconstruction”</a>).</p>
<p>A black level adjustment is a basic tool to increase contrast and pop of an image. The value defines at what threshold dark gray values are cut off to pure black. Use with care as the clipped values can not be recovered in other modules further down the pixelpipe. Please also have a look at the <span><em>tone curve</em></span> module (see <a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56">Section 3.4.2.3, “Tone curve”</a>) and the <span><em>levels</em></span> module (see <a title="3.4.2.2. Levels" href="#sigil_toc_id_55">Section 3.4.2.2, “Levels”</a>) which can produce similar results with less side effects as they come later in pixelpipe.</p>
<p>The exposure module has two modes of operation.</p>
<p>In <span>“<span>manual</span>”</span> mode you directly define the value for exposure correction that you want to apply to your image.</p>
<p>In <span>“<span>automatic</span>”</span> mode darktable analyses the histogram of your image. You select a reference point within the histogram as a <span><em>percentile</em></span> and define a <span><em>target level</em></span> – darktable automatically calculates the exposure compensation that is needed to shift the selected position to that target value. The computed exposure compensation value is displayed in the module's GUI for your information.</p>
<p>The <span>“<span>automatic</span>”</span> mode has a black level adjustment that works as in manual mode.</p>
<p>Automatic adjustment is only available for raw images. A typical use case is deflickering of <a href="http://en.wikipedia.org/wiki/Time-lapse_photography" target="_top"><span><em>time-lapse photographs</em></span></a>. You apply an automatic exposure correction with the same set of parameters to all images of the series – differences in lighting get compensated so that the final video sequence does not show any flickering.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_330">mode</h6>
</div>
</div>
</div>
<p>Defines the mode of operation. Defaults to <span>“<span>manual</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_331">black</h6>
</div>
</div>
</div>
<p>Adjust the black level in both <span>“<span>manual</span>”</span> and <span>“<span>automatic</span>”</span> mode.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_332">exposure</h6>
</div>
</div>
</div>
<p>Adjust the exposure correction [EV] (only available in <span>“<span>manual</span>”</span> mode).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_333">clipping threshold</h6>
</div>
</div>
</div>
<p>darktable can calculate correct black level and exposure values for your image based on the content of a rectangular area. The adjustment slider lets you define what percentage of bright values are to be clipped out in the calculation. Pressing the&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;icon starts the calculation and lets you draw a rectangular area of your choice using your mouse. This feature is only available in “manual” mode.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_334">percentile</h6>
</div>
</div>
</div>
<p>Defines a location in the histogram for automatic exposure correction. A percentile of 50% denotes a position in the histogram where 50% of pixel values are below and 50% of pixel values are above. For more details see <a href="http://en.wikipedia.org/wiki/Percentile" target="_top"><span><em>percentile</em></span></a>. Only available in <span>“<span>automatic</span>”</span> mode.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_335">target level</h6>
</div>
</div>
</div>
<p>Defines the target level for automatic exposure correction in terms of [EV] relative to the white point of the camera. The white point is camera specific and defines the highest lightness value that the camera sensor can detect. Only available in<span>“<span>automatic</span>”</span> mode.</p>
</div>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_54">3.4.1.6. Contrast Brightness Saturation<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_336">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module offers a very basic tool for adjusting an image's contrast, brightness and saturation.</td>
<td>
<div><img alt="colisa" src="../Images/colisa.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_337">Usage</h5>
</div>
</div>
</div>
<p>The module has sliders for each of the three affected attributes. In their neutral position (zero) the image remains unchanged. Shifting sliders left to negative values reduces contrast, brightness and saturation, respectively. Shifting right to positive values leads to an increase.</p>
<p>Much more versatility for contrast and brightness adjustment is offered by the <span><em>tone curve</em></span>, <span><em>levels</em></span>, and <span><em>zone system</em></span> modules (see <a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56">Section 3.4.2.3, “Tone curve”</a>, <a title="3.4.2.2. Levels" href="#sigil_toc_id_55">Section 3.4.2.2, “Levels”</a>, and <a title="3.4.2.4. Zone system" href="#sigil_toc_id_57">Section 3.4.2.4, “Zone system”</a>). Likewise you may adjust color saturation in a more detailed way with the <span><em>tone curve</em></span>, <span><em>color contrast</em></span>, and <span><em>color zones</em></span> modules (see <a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56">Section 3.4.2.3, “Tone curve”</a>,&nbsp;<a title="3.4.3.4. Color contrast" href="#sigil_toc_id_341">Section 3.4.3.4, “Color contrast”</a>, and&nbsp;<a title="3.4.3.8. Color zones" href="#sigil_toc_id_64">Section 3.4.3.8, “Color zones”</a>).</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_338">contrast</h6>
</div>
</div>
</div>
<p>This slider adjusts the image's contrast.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_339">brightness</h6>
</div>
</div>
</div>
<p>This slider adjusts the image's brightness.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_340">saturation</h6>
</div>
</div>
</div>
<p>This slider adjusts the color saturation.</p>
</div>
</div>
<h4 id="sigil_toc_id_51">3.4.1.7. Color reconstruction<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_342">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The color reconstruction module is able to bring back color into blown out highlights.</td>
<td>
<div><img alt="color_reconstruction" src="../Images/color_reconstruction.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_343">Usage</h5>
</div>
</div>
</div>
<p>Due to the nature of digital sensors, overexposed highlights are lacking valid color information. Most frequently they appear neutral white or exhibit some color cast – depending on which other image processing steps are involved. This module can <span>“<span>heal</span>”</span> overexposed highlights by replacing their colors with better fitting ones. The module acts on highlight pixels whose luminance values exceed a user defined threshold. Replacement colors are taken from the neighborhood. Both, the spatial distance and the luminance distance <span><em>(range)</em></span> are taken into account for color selection.</p>
<p>As a limitation of the underlying algorithm reconstructed colors may sometimes be displayed incorrectly if you zoom into the image in the darkroom view. If this happens you might observe a magenta shift in highlight areas close to high contrast edges, or you might see colorless highlight areas if you combine this module with the <span>“<span>reconstruct color</span>”</span> method of the <span>“<span>highlight reconstruction</span>”</span> module (see&nbsp;<a title="3.4.1.9. Highlight reconstruction" href="#sigil_toc_id_52">Section 3.4.1.9, “Highlight reconstruction”</a>). These artifacts only influence image display – the final output remains unaffected. It is recommended that you finetune the parameters of this module while viewing the full, not zoomed-in image.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_344">threshold</h6>
</div>
</div>
</div>
<p>The color reconstruction module replaces the color of all target pixels characterized by luminance values above this threshold. Inversely, only pixels with luminance values below this threshold are taken as valid source pixels for replacement colors. Too high settings of this parameter will cause the module to have no effect on any pixels. Too low values will minimize the <span>“<span>pool</span>”</span> of replacement colors – if no suited ones are available the original colors are maintained. Therefore, this parameter exhibits a <span>“<span>sweet spot</span>”</span> characteristic with an optimum setting depending on the individual image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_345">spatial extent</h6>
</div>
</div>
</div>
<p>Defines the spatial distance (x,y-coordinates) that source pixels may have from a target pixel in order for them to contribute to color replacement. Higher values cause ever more distant pixels to contribute; this increases the chance to find a replacement color but makes that color more undefined and less clear.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_346">range extent</h6>
</div>
</div>
</div>
<p>Defines the range distance (difference in luminance values) that source pixels may have from target pixels in order for them to contribute to color replacement. Higher values cause more pixels to contribute even if their luminance differs more strongly from the target pixels; this again increases the chance to find a replacement color but at the same time increases the risk of unfitting colors creeping in.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_347">preference</h6>
</div>
</div>
</div>
<p>This combobox defines if certain replacement colors shall take precedence over others. In its default setting <span>“<span>off </span>”</span> all pixels contribute equally. Setting it to <span>“<span>saturated colors</span>”</span> makes pixels contribute according to their chromaticity – the higher saturated a color the more it contributes. By selecting <span>“<span>hue</span>”</span> you get a choice of giving precedence to a specific hue.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_348">hue</h6>
</div>
</div>
</div>
<p>This slider is visible if you set the preference combobox to <span>“<span>hue</span>”</span>. It allows you to select a preferred hue of replacement colors. This only has an effect if the preferred hue is actually present within the selected spatial and range distance of the target pixels (see above). A typical use case is repairing highlights on human skin in situations where diverging colors are in close proximity (e.g. textiles or hair with a luminance close to skin). Setting a hue preference on skin tones avoids these other colors from creeping in.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_349">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="color_reconstruction_ex1" src="../Images/color_reconstruction_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>Original image with overexposed highlights on head, arm and shoulder of the statue.</td>
</tr>
<tr>
<td>
<div><img alt="color_reconstruction_ex2" src="../Images/color_reconstruction_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>Color reconstruction with default settings of all module parameters.</td>
</tr>
</tbody>
</table>
</div>
</div>
<h4 id="sigil_toc_id_187">3.4.1.8. Demosaic<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_350">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module allows you to control how the demosaic is processed.</td>
<td>
<div><img alt="demosaic" src="../Images/demosaic.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_351">Usage</h5>
</div>
</div>
</div>
<p>Demosaic is an essential step of any raw image development process.</p>
<p>A detailed description would be beyond the scope of this manual. In a nutshell, the sensor cells of a digital camera are only able to record different levels of lightness, not different color. In order to get a color image, each cell is covered by a color filter, either in red, green or blue. Due to the color sensitivity of the human vision, there are two times more green cells than red or blue. Filters are arranged in a certain mosaic, called Bayer pattern. Therefore each pixel of your image originally only has information about one color channel. Demosaic reconstructs the missing color channels by interpolation with data of the neighboring pixels. For further reading see the Wikipedia article on the <a href="http://en.wikipedia.org/wiki/Bayer_filter" target="_top">Bayer filter</a>.</p>
<p>As interpolation is prone to produce artifacts, various different demosaic algorithms have been developed in the past. Artifacts would typically be visible as moiré-like patterns when you strongly zoom into your image. Currently darktable supports PPG, AMAZE, and VNG4. All these algorithms produce high quality output with a low tendency to artifacts. AMAZE is reported to sometimes give slightly better results. However, as AMAZE is significantly slower, darktable uses PPG as a default. VNG4 produces the softest results of the three algorithms, but if you see "maze" artifacts, try VNG4 to eliminate them.</p>
<p>There are a few cameras whose sensors do not use a Bayer filter. Cameras with an "X-Trans" sensor have their own set of demosaicing algorithms. The default algorithm for X-Trans sensors is Markesteijn 1-pass, which produces fairly good results. For a bit better quality (at the cost of much slower processing), choose Markesteijn 3-pass. Though VNG demosaic is faster than Markesteijn 1-pass on certain computers, it is more prone to demosaicing artifacts.</p>
<p>Additionally, darktable supports a special demosaicing algorithm – passthrough (monochrome). It is not a general-purpose algorithm that is useful for all the images. It is only useful for cameras with the color filter array physically removed from the sensor, e.g. physically scratched off. Normally, demosaic reconstructs the missing color channels by interpolation with data of the neighboring pixels. But since the color filter array is not present, there is nothing to interpolate, so this algorithm simply sets all the color channels to the same value, which results in pixels being gray, thus producing a monochrome image. This method guarantees that there are no interpolation artifacts that would otherwise be present should one of the standard demosaicing algorithm be used.</p>
<p>Some further parameters of this module can activate additional averaging and smoothing steps. They might help to reduce remaining artifacts in special cases.</p>
<p>Demosaic is always applied when exporting images. Demosaic is done on monitor display only when zoom is greater than 50% or when the according preference setting <span>“<span>demosaicing for zoomed out darkroom mode</span>”</span> (see <a title="8.2. Core options" href="../Text/preferences.xhtml#sigil_toc_id_5">Section 8.2, “Core options”</a>) is set accordingly. Else color channels are taken from neighboring pixels without an expensive interpolation.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_352">method</h6>
</div>
</div>
</div>
<p>Set the demosaic method. darktable currently supports PPG, AMAZE, and VNG4 for Bayer sensors. For X-Trans sensors darktable supports VNG, Markesteijn 1-pass, and Markesteijn 3-pass.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_353">edge threshold</h6>
</div>
</div>
</div>
<p>Set the threshold for an additional median pass. Defaults to <span>“<span>0</span>”</span> which disables median filtering. This option is not shown for X-Trans sensors.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_354">color smoothing</h6>
</div>
</div>
</div>
<p>Activates a number of additional color smoothing passes. Defaults to <span>“<span>off</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_355">match greens</h6>
</div>
</div>
</div>
<p>In some cameras the green filters have slightly varying properties. This parameter adds an additional equalization step to suppress artifacts. Available options are<span>“<span>disabled</span>”</span>, <span>“<span>local average</span>”</span>, <span>“<span>full average</span>”</span> and <span>“<span>full and local average</span>”</span>. This option is not shown for X-Trans sensors.</p>
</div>
</div>
<h4 id="sigil_toc_id_52">3.4.1.9. Highlight reconstruction<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_356">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module tries to reconstruct color information that is usually clipped because of incomplete information in some of the channels. If you do nothing, your clipped areas are often toned to the not clipped channel. For example, if your green and blue channels are clipped, then your image will appear red in the clipped areas.</td>
<td>
<div><img alt="highlightreconstruction" src="../Images/highlightreconstruction.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_357">Usage</h5>
</div>
</div>
</div>
<p>You can choose between three methods for highlight reconstruction.</p>
<p><span>“<span>Clip highlights</span>”</span> just clamps all the pixels to the white level. Effectively this converts all clipped highlights to neutral grey tones. This method is most useful in cases where clipped highlights occur in non-colored areas like clouds in the sky.</p>
<p><span>“<span>Reconstruct in LCh</span>”</span> analyses each pixel having at least one channel clipped and transforms the information in LCh color space in an attempt to correct the clipped pixel using the values of the other (3 for Bayer or 8 for X-Trans) pixels in the affected sensor block. This method usually does a better job than <span>“<span>Clip highlights</span>”</span> as some details in the clipped areas are preserved. However it is incapable to reconstruct any color information  – the reconstructed highlights will all be monochrome, but brighter and with more detail than with <span>“<span>Clip highlights</span>”</span>. This method works fairly well with a high-contrast base curve (such as most manufacturers apply to their JPEG), which renders highlights desaturated. This method is a good option on naturally desaturated objects such as clouds.</p>
<p><span>“<span>Reconstruct color</span>”</span> uses an algorithm that transfers color information from the unclipped surroundings into the clipped highlights. This method works very well on areas with homogeneous colors and is especially useful on skin tones with smoothly fading highlights. It fails in certain cases where it produces maze-like artifacts at highlights behind high-contrast edges, such as fine, well-exposed structures in front of overexposed background (for instance ship masts or flags in front of the blown-out sky).</p>
<p>Tip: for highlight reconstruction to be effective you need to apply a negative EV correction in the exposure module (see <a title="3.4.1.5. Exposure" href="#sigil_toc_id_34">Section 3.4.1.5, “Exposure”</a>). If you want to avoid a general darkening of your image you can use darktable's mask feature in that module to limit the EV correction to only the highlights (see <a title="3.2.7. Drawn mask" href="#sigil_toc_id_194">Section 3.2.7, “Drawn mask”</a> and <a title="3.2.8. Parametric mask" href="#sigil_toc_id_202">Section 3.2.8, “Parametric mask”</a>).</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_358">method</h6>
</div>
</div>
</div>
<p>Choose the method for highlight reconstruction.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_359">clipping threshold</h6>
</div>
</div>
</div>
<p>Manually adjust the clipping threshold against magenta highlights. The default is usually satisfactory without any need for additional adjustments.</p>
</div>
</div>
<h4 id="sigil_toc_id_32">3.4.1.10. White balance</h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_360">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is used to set the white balance. You have three ways to interact with it: (a) Set up tint and temperature, (b) define the value of each channel, or (c) choose from predefined white balances.</td>
<td>
<div><img alt="whitebalance" src="../Images/whitebalance.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_361">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_362">tint</h6>
</div>
</div>
</div>
<p>Alter the color tint of the image, from magenta (value &lt; 1) to green (value &gt; 1). The channel sliders will be updated when you adjust this parameter.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_363">temperature</h6>
</div>
</div>
</div>
<p>Set the color temperature (in Kelvin). The channel sliders will be updated when you adjust this parameter. darktable derives the color temperature from the Exif data using some model assumptions. The value given is not meant to be authoritative. In the end only the updated channel values determine how the image is modified.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_364">red, green and blue channels</h6>
</div>
</div>
</div>
<p>Set the channel values on a scale from 0 to 8.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_365">preset</h6>
</div>
</div>
</div>
<p>Select a preset white balance.</p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>camera white balance (default)</em></span></td>
<td>White balance reported by the camera.</td>
</tr>
<tr>
<td><span><em>camera neutral</em></span></td>
<td>Essentially sets temperature to 6502K. The actual math: it computes such white balance channel multipliers, so that pure white color in camera colorspace is converted into pure white color in sRGB D65. (pure white color here means having the same equal value for each channel = 1.0)</td>
</tr>
<tr>
<td><span><em>spot white balance</em></span></td>
<td>Select a square area in your image containing mostly grey pixels. The white balance is calculated based on the selected area.</td>
</tr>
<tr>
<td><span><em>camera presets</em></span></td>
<td>Camera specific white balance presets. Examples: direct sunlight, flash, cloudy, shade and a number of indoor lighting options.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_366">finetune</h6>
</div>
</div>
</div>
<p>Some cameras offer additional finetuning parameters if one of the camera presets is selected. Depending on camera white balance, can be adjusted in steps within a certain range. The adjustments are usually towards yellow (value &lt; 1) or blue (value &gt; 1).</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_367">3.4.1.11. Invert</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_368">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The main purpose of this module is to invert scanned negatives.</td>
<td>
<div><img alt="invert" src="../Images/invert.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_369">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_370">color of film material</h6>
</div>
</div>
</div>
<p>The only control element of this module is a color selector which allows to adjust for different colors of your film material. Clicking on the colored field will open a color selector dialog which offers you a choice of commonly used colors, or allows to define a color in RGB color space. You can also activate a color picker by pressing&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;and take a color probe from your image – preferably from the unexposed border of your negative.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_371">3.4.1.12. Raw black/white point</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_372">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is activated automatically for raw images and makes sure that the camera specific black and white points are taken into account. Default settings are applied for all supported cameras. Changes to the defaults are normally not required.</td>
<td>
<div><img alt="raw_black_white" src="../Images/raw_black_white.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_373">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_374">black level 0 to 3</h6>
</div>
</div>
</div>
<p>The camera specific black level of the four pixels in the RGGB Bayer pattern. Pixels with values lower than that level are considered to contain no valid data.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_375">white point</h6>
</div>
</div>
</div>
<p>The camera specific white level. All pixels with values above are likely to be clipped and handled accordingly in the <span><em>highlight reconstruction</em></span> module (see <a title="3.4.1.9. Highlight reconstruction" href="#sigil_toc_id_52">Section 3.4.1.9, “Highlight reconstruction”</a>). Pixels with values equal to the white level are considered to be white.</p>
</div>
</div>
</div>
<h3 id="sigil_toc_id_280">3.4.2. Tone group<br/></h3>
<div>This group contains modules that operate on the tonal values of an image, modulating brightness while leaving color values intact.<br/></div>
<h4 id="sigil_toc_id_200">3.4.2.1. Fill light<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_376">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module allows local modification of the exposure based on pixel lightness.</td>
<td>
<div align="center"><img alt="relight" src="../Images/relight.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_377">Usage</h5>
</div>
</div>
</div>
<p>Pushes exposure by increasing lightness with a Gaussian curve of a specified width, centered on a given lightness.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_378">exposure</h6>
</div>
</div>
</div>
<p>Sets fill-light exposure in [EV].</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_379">center</h6>
</div>
</div>
</div>
<p>Sets the median lightness impacted by the fill-light. A color picker is activated by pressing&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>. It shows the picked lightness value in the gradient bar, which helps find the desired center value. You can switch between point and area sampling mode from within the global color picker panel (see <a title="3.3.4. Global color picker" href="#sigil_toc_id_254">Section 3.3.4, “Global color picker”</a>).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_380">width</h6>
</div>
</div>
</div>
<p>Sets the width of the Gaussian curve. This number is expressed in zones, with the whole dynamic range being 10 zones. As the Gaussian curve is symmetric, only even numbers can be entered.</p>
</div>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_55">3.4.2.2. Levels<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_381">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>A tool for adjusting black, white, and mid-gray points. This module is especially useful if the histogram of an image does not span the whole horizontal range, from pure black to pure white.</td>
<td>
<div align="center"><img alt="levels" src="../Images/levels.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_382">Usage</h5>
</div>
</div>
</div>
<p>The levels tool offers two modes of operation: <span>“<span>manual</span>”</span> and <span>“<span>automatic</span>”</span>.</p>
<p>In <span>“<span>manual</span>”</span> mode the levels tool shows a histogram of the image, and displays three bars with handles. Dragging the handles modifies the tones in the image. Those bars control the black, middle gray and white points in absolute values of image lightness (the L value from Lab).</p>
<p>You can move the black and white bars to match the left and right borders of the histogram, which will make the output image span the full available tonal range. A previously flat looking image will get more contrast and pop.</p>
<p>Moving the middle bar will modify the middle gray tones. Shifting it left will make the image look brighter, shifting it right will make it darker. This is often referred to as a change of image gamma.</p>
<p>There are three color pickers in black, gray, and white, available by pressing the respectively colored&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;icon. You can use them to sample the corresponding level directly from the image. You can switch between point and area sampling mode from within the global color picker panel (see <a title="3.3.4. Global color picker" href="#sigil_toc_id_254">Section 3.3.4, “Global color picker”</a>).</p>
<p>The <span>“<span>auto</span>”</span> button autoadjusts the black and white point and puts the gray point exactly in the mean between them.</p>
<p>In <span>“<span>automatic</span>”</span> mode the module automatically analyses the histogram of the image, detects the left and right histogram borders, and lets you define the black point, the gray point and the white point in terms of <a href="http://en.wikipedia.org/wiki/Percentile" target="_top"><span><em>percentiles</em></span></a> relative to these borders.</p>
<p>Tip: Under certain conditions, especially highly saturated blue light sources in the frame, the levels module may produce black pixel artifacts. See the <span><em>gamut clipping</em></span> option (<a title="3.4.3.11. Input color profile" href="#sigil_toc_id_266">Section 3.4.3.11, “Input color profile”</a>) on how to mitigate this issue.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_383">mode</h6>
</div>
</div>
</div>
<p>Set the mode of operation of this module. Defaults to <span>“<span>manual</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_384">black</h6>
</div>
</div>
</div>
<p>Sets the black point in percentiles relative to the left border of the histogram (only<span>“<span>automatic</span>”</span> mode).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_385">gray</h6>
</div>
</div>
</div>
<p>Sets the gray point in percentiles relative to the left and right borders of the histogram <span><em>after</em></span> having applied the black point and white point corrections (only <span>“<span>automatic</span>”</span> mode).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_386">white</h6>
</div>
</div>
</div>
<p>Sets the white point in percentiles relative to the right border of the histogram (only<span>“<span>automatic</span>”</span> mode).</p>
</div>
</div>
</div>
<h4 id="sigil_toc_id_56">3.4.2.3. Tone curve<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_387">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is a classic digital photography tool. Unlike other image manipulation software, however, darktable's tone curve acts in Lab color space. Thus, it offers three independent curves for L, a, and b channels.</td>
<td>
<div align="center"><img alt="tonecurve" src="../Images/tonecurve.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_388">Usage</h5>
</div>
</div>
</div>
<p>In its default state, curves will be straight lines, defined by few anchor nodes. You can move the nodes to modify the curve. You can generate new nodes by <span><em>clicking</em></span> on the curve. With <span><em>ctrl-click</em></span> you generate a new node at the x-location of the mouse pointer and the corresponding y-location of the current curve – this adds a node without risking to accidentally modify the curve. Up to 20 nodes per curve can be defined. To remove a node, move it out of the widget area.</p>
<p>A color picker is activated by pressing&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;and will show the picked values in the graph. You can switch between point and area sampling mode from within the global color picker panel (see <a title="3.3.4. Global color picker" href="#sigil_toc_id_254">Section 3.3.4, “Global color picker”</a>). Numerical Lab values of input and output (see below) at the selected spot or area are shown on top left of the widget.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_389">L-channel curve</h6>
</div>
</div>
</div>
<p>The tone curve in L-channel works on Lightness. For a better overview a lightness histogram is displayed in the diagram.</p>
<p>The horizontal line represents the input image pixels' lightness. The vertical line represents the lightness of the output image pixels. A straight line does not change anything. A point above the default diagonal increases the lightness, whereas a point under decreases it. Shifting the center of the curve upwards will lighten the image, shifting it downwards will darken the image. An S-like curve will enhance the contrast of the image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_390">a/b-channel curves</h6>
</div>
</div>
</div>
<p>The curves in the a and b channels work on color values. They are only displayed and active if the <span><em>scale chroma</em></span> combobox is set to <span>“<span>manual</span>”</span>. The horizontal line represents the color channel value of the input image pixels. The vertical line represents the color channel value of the output image pixels. Positive a-values correspond to more magenta colors; negative a-values correspond to more greenish colors. Positive b-values correspond to more yellowish colors; negative b-values correspond to more blueish colors.</p>
<p>A straight line does not change anything. Shifting the center of the curve will give the image a color tint: shifting a-channel upwards gives a magenta tint; shifting b-channel upwards gives a yellow tint; shifting a-channel downwards gives a green tint; shifting b-channel downwards gives a blue tint.</p>
<p>Increasing/decreasing the steepness of the curves, without shifting its center, will increase/decrease the color saturation of the respective channel. With properly defined curves you can exert fine control on color saturation, depending on the input pixel's colors.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_391">scale chroma</h6>
</div>
</div>
</div>
<p>darktable does an automatic adjustment of color saturation, if this combobox is set to<span>“<span>automatic</span>”</span>. The level of this adjustment depends on the pixel's color values and its L-value modification by the L-channel tone curve. It is designed to give an overall boost in color saturation, if the L-curve gives a contrast boost. The <span>“<span>automatic in XYZ</span>”</span> mode offers an alternative for automatic saturation adjustment. It works by applying the L-channel curve to all three channels in the XYZ color space. This has the same effect on saturation as RGB curves would have. Look at blend mode <span>“<span>coloradjustment</span>”</span> if you want to tune the strength of automatic chroma scaling (see&nbsp;<a title="3.2.6. Blending operators" href="#sigil_toc_id_201">Section 3.2.6, “Blending operators”</a>). If this combobox is set to <span>“<span>manual</span>”</span>, you can manually modify color saturation using the curves in channels a and b.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_392">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div align="center"><a href="../Images/tonecurve_ex1.jpg"><img alt="tonecurve_ex1" src="../Images/tonecurve_ex1.jpg" width="100%"/></a><br/>
</div>
</td>
<td>Original image</td>
</tr>
<tr>
<td>
<div align="center"><img alt="tonecurve_ex2" src="../Images/tonecurve_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>Tone curve settings. Please note how the center node of our b-curve was shifted down to negative values. This gives the image its blue tint.</td>
</tr>
<tr>
<td>
<div align="center"><a href="../Images/tonecurve_ex3.jpg"><img alt="tonecurve_ex3" src="../Images/tonecurve_ex3.jpg" width="100%"/></a><br/>
</div>
</td>
<td>Resulting image</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_57">3.4.2.4. Zone system<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_393">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is another way to change the lightness of your image, based on&nbsp;<a href="http://anseladams.com/ansel-adams-bio/">Ansel Adams</a>' system. It allows modification of a zone's lightness taking into account the effect on the adjacent zones. It divides the lightness range into a user-defined number of zones.</td>
<td>
<div align="center"><img alt="zonesystem" src="../Images/zonesystem.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_394">Usage</h5>
</div>
</div>
</div>
<p>Following the concept of Ansel Adams the lightness (based on the L channel from Lab) is divided into a number of zones ranging from pure black to pure white. These zones are displayed in a zonebar. The number of zones can be changed by mouse-scrolling on that bar (defaults to 10 zones).</p>
<p>The zonebar is split horizontally with the upper part showing the zones of the module's output and the lower part the according zones of the module's input. In its default state both parts are fully aligned. While the output zones are static you can left click and drag a control point in the input zones to modify the zonemapping. Shifting a control point proportionally expands the zones on one side and compresses the zones on the other side. Any already existing control point stays in place, effectively preventing changes to the zones beyond. Use right click to remove a control point.</p>
<p>The preview shows the image broken down in zones. When hovering above a zone on the zonebar, that zone – either from input or output – is highlighted on the preview.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_395">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div align="center"><a href="../Images/zonesystem_ex1.jpg"><img alt="zonesystem_ex1" src="../Images/zonesystem_ex1.jpg" width="100%"/></a><br/>
</div>
</td>
<td>The original image.</td>
</tr>
<tr>
<td>
<div align="center"><a href="../Images/zonesystem_ex2.jpg"><img alt="zonesystem_ex2" src="../Images/zonesystem_ex2.jpg" width="100%"/></a><br/>
</div>
</td>
<td>Here, the darker and lighter zones were compressed to increase contrast, then the upper parts of darker zones were expanded to increase their visual impact.
<div><img alt="zonesystem_ex2_settings" src="../Images/zonesystem_ex2_settings.jpg"/><br/></div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h4 id="sigil_toc_id_59">3.4.2.5. Local contrast<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_396">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module allows enhancing local contrast. It supports two modes of operation: the default one uses a local laplacian filter, the other one uses the unnormalized bilateral filter. Both work exclusively on the L channel from Lab.</td>
<td>
<div align="center"><img alt="localcontrast" src="../Images/localcontrast.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_397">Usage</h5>
</div>
</div>
</div>
<p>Local contrast boosts details of your image, much like the <span><em>equalizer</em></span> does (see <a title="3.4.4.2. Equalizer" href="#sigil_toc_id_38">Section 3.4.4.2, “Equalizer”</a>). However, it is easier to use as it does not require you to work on different frequency bands. The local laplacian filter has been designed to be very robust against unwanted halo effects and gradient reversals along edges.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_398">mode</h6>
</div>
</div>
</div>
<p>Choice of "local laplacian filter" or "unnormalised bilateral grid". The options for the bilateral grid are: coarseness, contrast, and detail. The local laplacian filter supports: detail, highlights, shadows, and midtone range. The local laplacian mode supports shadow lifting and highlight compression, similar to the shadows and highlights module.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_399">Bilateral grid</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_400">coarseness</h6>
</div>
</div>
</div>
<p>Make the details you want to adjust finer or coarser.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_401">contrast</h6>
</div>
</div>
</div>
<p>How strongly the algorithm distinguishes between brightness levels. Increasing the value results in a more contrasty look.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_402">detail</h6>
</div>
</div>
</div>
<p>Add or remove detail. Higher values will increase local contrast.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_403">Local laplacian</h5>
</div>
</div>
</div>
<p>To understand the parameters of the local laplacian filter, you can think of it as applying a curve to the image, similar to this picture:</p>
<div align="center"><img alt="locallaplacian-curve" src="../Images/locallaplacian-curve.jpg" class="center"/><br/>
</div>
<p>It will then be applied to the image in a way that works locally and avoids halo artifacts.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_404">detail</h6>
</div>
</div>
</div>
<p>Add or remove detail. Higher values will increase local contrast. This will insert an S shaped element in the center of the curve, to increase or decrease local contrast. For monochrome images it is often possible to push this parameter to extreme settings without ridiculous results or artifacts.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_405">highlights</h6>
</div>
</div>
</div>
<p>This affects one end of the curve, effectively increasing or compressing contrast in the highlights. A low value will pull the highlights down.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_406">shadows</h6>
</div>
</div>
</div>
<p>Similar to the highlights parameter, this affects the other far end of the curve, and will increase or decrease contrast in the shadows. A higher value gives more contrast in the shadows. A lower value will lift the shadows and can effectively simulate a fill light. Note that this is done via local manipulation of the image, however: this means that a completely dark image cannot be brightened this way, only dark things in front of bright things will be affected.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_407">midtone range</h6>
</div>
</div>
</div>
<p>This controls the extent of the S shaped part of the contrast curve. A larger value will make the S wider, and thus classify more values to be midtone range and fewer values to belong to the highlights and shadows part. In more high dynamic range settings it can be useful to reduce this value to achieve stronger range compression by lowering the contrast in the highlights and the shadows. Note however that for really strong HDR scenarios this may work best in combination with a base curve which pre-compresses the range, maybe with an approximately logarithmic base curve. Also the exposure fusion feature in the base curve module may lead to more pleasing results at times, but is more prone to producing halo effects.</p>
<p>This setting can cause banding artifacts in the image if pushed to extreme values. This is due to the way darktable computes the fast approximation of the local laplacian filter.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_408">Example</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Before</td>
<td>
<div align="center"><a href="../Images/localcontrast_before.jpg"><img alt="localcontrast_before" src="../Images/localcontrast_before.jpg" width="100%"/></a><br/>
</div>
</td>
</tr>
<tr>
<td>After, a little overdone to demonstrate the effect. Use this sparingly, to avoid a cheap, overprocessed look.</td>
<td>
<div align="center"><a href="../Images/localcontrast_after.jpg"><img alt="localcontrast_after" src="../Images/localcontrast_after.jpg" width="100%"/></a><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div><div><div><div><h4 id="sigil_toc_id_409">3.4.2.6. Tonemapping</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_410">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module compresses the tonal range of HDR images, so they fit into the limits of a normal, low dynamic range image, using Durand's 2002 algorithm. darktable can import HDR images if they come in OpenEXR, RGBE or PFM format or as a DNG generated by darktable's HDR creation mechanism (see&nbsp;<a title="2.3.6. Selected image(s)" href="../Text/lighttable.xhtml#sigil_toc_id_89">Section 2.3.6, “Selected image(s)”</a>).</td>
<td>
<div align="center"><img alt="tonemapping" src="../Images/tonemapping.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_411">Usage</h5>
</div>
</div>
</div>
<p>The underlying algorithm uses a bilateral filter to decompose an image into a coarse base layer and a detail layer. The contrast of the base layer is compressed, while the detail layer is preserved, then both layers are re-combined.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_412">contrast compression</h6>
</div>
</div>
</div>
<p>Sets the contrast compression level of the base layer. A higher compression will make the image fit a lower dynamic range.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_413">spatial extent</h6>
</div>
</div>
</div>
<p>Sets the spatial extent of the bilateral filter. Lower values cause the contrast compression to have stronger effects on image details.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_414">3.4.2.7. Global tonemap</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_415">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module implements another approach to compressing the tonal range of an HDR image into the limited tonal range of a typical LDR output file. It offers several implementations of global tonemap operators.</td>
<td>
<div align="center"><img alt="global_tonemap" src="../Images/global_tonemap.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_416">Usage</h5>
</div>
</div>
</div>
<p>Global tonemapping processes each pixel of an HDR image, without taking the local surrounding into account. This is generally faster than local tonemapping, as implemented in the <a title="3.4.2.6. Tonemapping" href="#sigil_toc_id_409"><span><em>tonemapping</em></span></a> module but might lead to less convincing results with very high dynamic scenes. As an enhancement to the original operators, darktable can preserve detail of the input image, and transfer it back to the output image.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_417">operator</h6>
</div>
</div>
</div>
<p>Reinhard, Filmic and Drago global tonemap operators are available for use. Depending on the selected operator, different parameters can be adjusted. Some operators are fully self-adjusting, and do not require specific controls.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_418">bias</h6>
</div>
</div>
</div>
<p>Only offered for the <span><em>Drago</em></span> operator. This parameter influences the contrast of the output image. It is an essential parameter for adjusting the compression of high values and the visibility of details in dark areas. According to the original paper, a value of 0.85 is recommended as a starting point.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_419">target</h6>
</div>
</div>
</div>
<p>Only offered for the <span><em>Drago</em></span> operator. This is a scale factor to adjust the global image brightness to the brightness of the intended display. It is measured in cd/m <sup>2</sup> , and should match the according value of your output device. Higher values lead to a brighter image, while lower values lead to a darker image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_420">detail</h6>
</div>
</div>
</div>
<p>Offered as an addition to all operators. This parameter controls how much detail is preserved and transferred back into the output image after tonemapping.</p>
</div>
</div>
</div>
</div>
</div>
<div> </div>
<h3 id="sigil_toc_id_281">3.4.3. Color group<br/></h3>
<p>Modules for working specifically on your image's color are found here in the color group.</p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_421">3.4.3.1. Velvia</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_422">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The velvia module enhances image saturation. Its effect is tailored to increase saturation less on lower saturated pixels than on highly saturated pixels.</td>
<td>
<div align="center"><img alt="velvia" src="../Images/velvia.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_423">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_424">strength</h6>
</div>
</div>
</div>
<p>This slider controls the strength of the effect.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_425">mid-tones bias</h6>
</div>
</div>
</div>
<p>Velvia can reduce its effect for mid-tones to avoid unnatural skin tones. The mid-tones bias slider controls this selectivity; reducing its value reduces mid-tone protection and makes the overall velvia effect stronger.</p>
</div>
</div>
</div>
<div><h4 id="sigil_toc_id_61">3.4.3.2. Channel mixer</h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_426">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is a powerful tool to manage channels. It accepts red, green and blue channels as an input. As output it provides red, green, blue, gray, hue, saturation and lightness channels.</td>
<td>
<div align="center"><img alt="channelmixer" src="../Images/channelmixer.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_427">Usage</h5>
</div>
</div>
</div>
<p>First select your output channel and then set the amount each input channel feeds into that output channel.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_428">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div align="center"><img alt="channelmixer_ex1" src="../Images/channelmixer_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>For skin tones the blue channel tends to represent detail, with red tending to also have smoother tones than green. Therefore tonal rendering is controlled by how we blend of the three input channels.</td>
</tr>
<tr>
<td>
<div align="center"><img alt="channelmixer_ex2" src="../Images/channelmixer_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>Here a monochrome portrait is produced by simply selecting the grey channel as output. A smooth skin tone is achieved by reducing the blue channels input and also emphasizing the red channels input relative to green. An RGB mix of 0.9, 0.3, -0.3 was used together with an 0.1 EV exposure increase to lighten the image.</td>
</tr>
<tr>
<td>
<div align="center"><img alt="channelmixer_ex3" src="../Images/channelmixer_ex3.jpg" width="100%"/><br/>
</div>
</td>
<td>In this example an RGB mix of 0.4, 0.75, -0.15 uses more green than red, bringing back some features. We still reduce the blue channel in the mix to de-emphasize unwanted skin texture.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_429">Table of mixing values for some b/w films</h6>
</div>
</div>
</div>
<p>Classic black and white films have different characteristic color responses. Select gray as output mixing channel, and try out the values suggested below for your favorite film type.</p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="20%"/>
<col width="20%"/>
<col width="20%"/>
</colgroup>
<tbody>
<tr>
<td>Film Type</td>
<td>Red</td>
<td>Green</td>
<td>Blue</td>
</tr>
<tr>
<td>AGFA 200X</td>
<td>0.18</td>
<td>0.41</td>
<td>0.41</td>
</tr>
<tr>
<td>Agfapan 25</td>
<td>0.25</td>
<td>0.39</td>
<td>0.36</td>
</tr>
<tr>
<td>Agfapan 100</td>
<td>0.21</td>
<td>0.40</td>
<td>0.39</td>
</tr>
<tr>
<td>Agfapan 400</td>
<td>0.20</td>
<td>0.41</td>
<td>0.39</td>
</tr>
<tr>
<td>Ilford Delta 100</td>
<td>0.21</td>
<td>0.42</td>
<td>0.37</td>
</tr>
<tr>
<td>Ilford Delta 400</td>
<td>0.22</td>
<td>0.42</td>
<td>0.36</td>
</tr>
<tr>
<td>Ilford Delta 3200</td>
<td>0.31</td>
<td>0.36</td>
<td>0.33</td>
</tr>
<tr>
<td>Ilford FP4</td>
<td>0.28</td>
<td>0.41</td>
<td>0.31</td>
</tr>
<tr>
<td>Ilford HP5</td>
<td>0.23</td>
<td>0.37</td>
<td>0.40</td>
</tr>
<tr>
<td>Ilford Pan F</td>
<td>0.33</td>
<td>0.36</td>
<td>0.31</td>
</tr>
<tr>
<td>Ilford SFX</td>
<td>0.36</td>
<td>0.31</td>
<td>0.33</td>
</tr>
<tr>
<td>Ilford XP2 Super</td>
<td>0.21</td>
<td>0.42</td>
<td>0.37</td>
</tr>
<tr>
<td>Kodak T-Max 100</td>
<td>0.24</td>
<td>0.37</td>
<td>0.39</td>
</tr>
<tr>
<td>Kodak T-Max 400</td>
<td>0.27</td>
<td>0.36</td>
<td>0.37</td>
</tr>
<tr>
<td>Kodak Tri-X 400</td>
<td>0.25</td>
<td>0.35</td>
<td>0.40</td>
</tr>
<tr>
<td>Normal Contrast</td>
<td>0.43</td>
<td>0.33</td>
<td>0.30</td>
</tr>
<tr>
<td>High Contrast</td>
<td>0.40</td>
<td>0.34</td>
<td>0.60</td>
</tr>
<tr>
<td>Generic B/W</td>
<td>0.24</td>
<td>0.68</td>
<td>0.08</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h4 id="sigil_toc_id_178">3.4.3.3. Output color profile<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_430">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>This module manages the output profiles for export as well as the rendering intent to be used when mapping between the different color spaces.</p>
<p>darktable comes with pre-defined profiles sRGB, AdobeRGB, XYZ and linear RGB but you can provide additional profiles by placing these in<code>$DARKTABLE/share/darktable/color/out</code> and<code>$HOME/.config/darktable/color/out</code>.<code>$DARKTABLE</code> is used here to represent your chosen darktable installation directory and <code>$HOME</code> your home directory.</p>
</td>
<td>
<div align="center"><img alt="outputcolorprofile" src="../Images/outputcolorprofile.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_431">Usage</h5>
</div>
</div>
</div>
<p>You can define the output color profile in two different places, either in this module, or in the export panel in lighttable mode (see <a title="2.3.12. Export selected" href="../Text/lighttable.xhtml#sigil_toc_id_3">Section 2.3.12, “Export selected”</a>).</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_432">output intent</h6>
</div>
</div>
</div>
<p>Sets the rendering intent for output/export. For more details see <a title="3.2.10.3. Rendering intent" href="#sigil_toc_id_179">Section 3.2.10.3, “Rendering intent”</a>).</p>
<p>Only rendering with LittleCMS2 gives you a choice of rendering intent. The option is hidden, if darktable's internal rendering routines are used. Rendering with LittleCMS2 is activated in the preferences dialog (see <a title="8.2. Core options" href="../Text/preferences.xhtml#sigil_toc_id_5">Section 8.2, “Core options”</a>).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_433">output profile</h6>
</div>
</div>
</div>
<p>Sets the color profile for output/export, causing darktable to render colors with this profile. darktable embeds the profile data into the output file if supported by the file format – this allows other applications reading the file to correctly interpret its colors.</p>
<p>As not all applications, e.g. image viewers, are aware of color profiles, a general recommendation is to stick to <span><em>sRGB</em></span> as the default output profile. You should only deviate from <span><em>sRGB</em></span> if this is really required and if you know what you are doing.</p>
</div>
</div>
<h4 id="sigil_toc_id_341">3.4.3.4. Color contrast<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_434">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The color contrast module provides simplified control for changing the contrast or separation of colors between either green/magenta or blue/yellow axis.</td>
<td>
<div align="center"><img alt="colorcontrast" src="../Images/colorcontrast.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_435">Usage</h5>
</div>
</div>
</div>
<p>Higher values increase color contrast, lower values decrease it. The effect of this module's sliders are similar to applying a steepened or flattened a- or b-curve in module <span><em>tone curve&nbsp;</em></span>(see <a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56">Section 3.4.2.3, “Tone curve”</a>).</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_436">green vs. magenta</h6>
</div>
</div>
</div>
<p>Changes color contrast for green versus magenta.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_437">blue vs. yellow</h6>
</div>
</div>
</div>
<p>Changes color contrast for blue versus yellow.</p>
</div>
</div>
</div>
<h4 id="sigil_toc_id_62">3.4.3.5. Color correction<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_438">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module can be used to modify the global saturation, give a tint to the image or to split tone it.</td>
<td>
<div align="center"><img alt="colorcorrection" src="../Images/colorcorrection.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_439">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_440">color board</h6>
</div>
</div>
</div>
<p>For split toning move the white dot to the desired highlight tint and then select a tint for shadows with the dark spot. For a simple global tint set both spots to the same color.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_441">saturation</h6>
</div>
</div>
</div>
<p>Use the saturation slider to correct the global saturation.</p>
<div>
<div>
<div>
<h4 id="sigil_toc_id_442">3.4.3.6. Color look up table</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_443">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module implements a generic color look up table in Lab space. The input is a list of source and target points, the complete mapping will be interpolated using splines. The resulting luts are editable by hand and can be created using the <code>darktable-chart</code> utility to match given input (such as hald-cluts and RAW/JPEG with in-camera processing pairs). See <a title="10.3. Using darktable-chart" href="../Text/special_topics.xhtml#sigil_toc_id_8">Section 10.3, “Using <code>darktable-chart</code> ”</a> for details.</td>
<td>
<div align="center"><img alt="colorchecker" src="../Images/colorchecker.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_444">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_445">color board</h6>
</div>
</div>
</div>
<p>When you select the module in darkroom mode, it should look something like the image above (configurations with more than 24 patches are shown in a 7x7 grid instead). By default, it will load the 24 patches of a color checker classic and initialise the mapping to identity (no change to the image).</p>
<p>The grid shows a list of colored patches. The colors of the patches are the source points. The target color of the selected patch is shown as offsets controlled by sliders in the GUI under the grid of patches. An outline is drawn around patches that have been altered, i.e. the source and target colors differ.</p>
<p>The selected patch is marked with a white square, and its number is displayed in the combo box below. Select a patch by left clicking on it, or using the combo box, or using the color picker.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_446">interaction</h6>
</div>
</div>
</div>
<p>To modify the color mapping, you can change source as well as target colors.</p>
<p>The main use case is to change the target colors. You start with an appropriate palette of source colors (either from the presets menu or from a style you download). You can then change lightness (L), green-red (a), blue-yellow (b), or saturation (C) of the patches' target values via sliders.</p>
<p>To change the source color of a patch you select a new color from your image by using the color picker, and shift-click on the patch you want to replace. You can switch between point and area sampling mode from within the global color picker panel (see&nbsp;<a title="3.3.4. Global color picker" href="#sigil_toc_id_254">Section 3.3.4, “Global color picker”</a>).</p>
<p>To reset a patch, double-click it. Right-click a patch to delete it. Shift-click on empty space to add a new patch (with the currently picked color as source color).</p>
</div>
</div>
</div>
</div>
<h4 id="sigil_toc_id_63">3.4.3.7. Monochrome<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_447">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is a quick way to convert an image into black and white and provides a variable color filter for that conversion.</td>
<td>
<div align="center"><img alt="monochrome" src="../Images/monochrome.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_448">Usage</h5>
</div>
</div>
</div>
<p>A color picker is activated by pressing&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;and will automatically set the position and size of the filter. You can switch between point and area sampling mode from within the global color picker panel (see <a title="3.3.4. Global color picker" href="#sigil_toc_id_254">Section 3.3.4, “Global color picker”</a>).</p>
<p>The default central location of the filter has a neutral effect but dragging it to an alternate position applies a filter analogously to taking a b&amp;w photograph through a conventional color filter.</p>
<p>As well as position you can change the filter size by scrolling with your mouse wheel. This makes the filter's range of hues more or less selective.</p>
<p>Tip: First reduce the filter size to concentrate its effect and move it across the hue pallet to find the best filter value for your desired image rendition. Then expand the filter to include more hues and thus more natural tonality.</p>
<p>Under certain conditions, especially highly saturated blue light sources in the frame, this module may produce black pixel artifacts. See the <span><em>gamut clipping</em></span> option (<a title="3.4.3.11. Input color profile" href="#sigil_toc_id_266">Section 3.4.3.11, “Input color profile”</a>) on how to mitigate this issue.</p>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_64">3.4.3.8. Color zones<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_449">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module selectively modifies the colors in your image. It is highly versatile and allows every transformation possible in the LCh colorspace.</td>
<td>
<div align="center"><img alt="colorzones" src="../Images/colorzones.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_450">Usage</h5>
</div>
</div>
</div>
<p>The horizontal axis represents the range of values you can work on. The vertical axis shows the modifications you can apply by designing a curve. For both horizontal and vertical axes you can work on lightness, saturation or hue.</p>
<p>You can click on any of the eight nodes on the curve and drag to adjust it vertically. A circle indicates how strong adjacent nodes will be affected. Use the scroll wheel of your mouse to change the circle diameter. You can also use the eight controlpoints (triangles which define the vertical value of the nodes) at the bottom to adjust the curve.</p>
<p>A color picker is activated by pressing&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;and will show the picked values in the diagram. You can switch between point and area sampling mode from within the global color picker panel (see <a title="3.3.4. Global color picker" href="#sigil_toc_id_254">Section 3.3.4, “Global color picker”</a>).</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_451">tabbed controls</h6>
</div>
</div>
</div>
<p>You can define curves for each of the three channels <span>“<span>lightness</span>”</span>, <span>“<span>saturation</span>”</span>, and <span>“<span>hue</span>”</span>individually.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_452">select by</h6>
</div>
</div>
</div>
<p>Defines the horizontal axis, i.e. the range of values you work on. You can choose between <span>“<span>lightness</span>”</span>, <span>“<span>saturation</span>”</span>, and <span>“<span>hue</span>”</span> (default). Changing this parameter resets any defined curve to a straight horizontal line.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_453">mix</h6>
</div>
</div>
</div>
<p>Use this parameter to tune the strength of the overall effect.</p>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_454">3.4.3.9. Color balance</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_455">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module offers a versatile tool for adjusting an image's color balance.</td>
<td>
<div align="center"><img alt="colorbalance" src="../Images/colorbalance.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_456">Usage</h5>
</div>
</div>
</div>
<p>For each of the three primary colors – red, green, and blue – there are three sliders <span>“<span>lift</span>”</span>, <span>“<span>gamma</span>”</span> and <span>“<span>gain</span>”</span> to control dark tones, mid tones and high tones, respectively. Changing these parameters adds offsets to the individual RGB channels and influences the color balance of the image.</p>
<p>Additional <span>“<span>factor</span>”</span> sliders act on all colors at once. Their effect is similar to the controls of the <span><em>levels</em></span> module (see <a title="3.4.2.2. Levels" href="#sigil_toc_id_55">Section 3.4.2.2, “Levels”</a>).</p>
<p>The way to best envision the module's way of working is if you consider <span>“<span>lift</span>”</span>, <span>“<span>gamma</span>”</span> and <span>“<span>gain</span>”</span> as parameters influencing the properties of a tone curve which – in its original state – is a straight line going diagonally from bottom left to top right.</p>
<p>The lift parameter adjusts the left axis intercept of the line – this point can be shifted from its default location with zero abscissa to points with negative or positive ones. The gamma parameter modifies the line shape – the default shape is linear and can be turned into a convex curve with increased or into a concave curve with lowered gamma values. Finally, the gain parameter defines the steepness of the curve – by default the curve runs diagonally, higher values lead to a steeper curve and lower values to a flatter one.</p>
<p>Side note: although this module acts on RGB colors its location in pixelpipe puts it into the Lab color space. Accordingly the modules converts from Lab to RGB, does its color adjustments, and then converts back to Lab.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_457">lift</h6>
</div>
</div>
</div>
<p>Adjusts the value of dark colors with individual sliders for each RGB color and with a<span>“<span>factor</span>”</span> slider acting on all three colors at once.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_458">gamma</h6>
</div>
</div>
</div>
<p>Adjusts the mid tones with individual sliders for each RGB color and with a <span>“<span>factor</span>”</span> slider acting on all three colors at once.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_459">gain</h6>
</div>
</div>
</div>
<p>Adjusts the high tones with individual sliders for each RGB color and with a <span>“<span>factor</span>”</span> slider acting on all three colors at once.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_460">3.4.3.10. Vibrance</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_461">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Vibrance is a widely used term in image processing but the mechanism and end result differ from program to program. Vibrance in darktable saturates and brings down the lightness of the most saturated pixels to make the colors more vivid.</td>
<td>
<div align="center"><img alt="vibrance" src="../Images/vibrance.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_462">Usage</h5>
</div>
</div>
</div>
<p>Vibrance only has one parameter which controls the amount applied.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_463">vibrance</h6>
</div>
</div>
</div>
<p>The amount of vibrance to apply to the image.</p>
</div>
</div>
</div>
</div>
</div>
<h4 id="sigil_toc_id_266">3.4.3.11. Input color profile</h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_464">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module can be used to override darktable's automatic allocation of input color profile if there is an alternative that more closely matches your original image's color space.</td>
<td>
<div align="center"><img alt="inputcolorprofile" src="../Images/inputcolorprofile.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_465">Usage</h5>
</div>
</div>
</div>
<p>In this module you define the input color profile, i.e. how colors of your input image are to be interpreted. You also have an option to have colors confined to a certain gamut in order to mitigate some (infrequent) color artifacts.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_466">profile</h6>
</div>
</div>
</div>
<p>Choose the profile or color matrix to apply, darktable offers many widespread matrices along with an enhanced matrix for some camera models. The enhanced matrices were processed by the darktable team in order to provide a look closer to the manufacturer's.</p>
<p>You can also supply your own input ICC profiles and put them into $DARKTABLE/share/darktable/color/in or $HOME/.config/darktable/color/in. $DARKTABLE is used here to represent darktable's installation directory and $HOME your home directory. One common source of ICC profiles is the software that is shipped with your camera; it often contains profiles specific to your camera model. You may need to activate module <span><em>unbreak input profile</em></span> (see <a title="3.4.3.12. Unbreak input profile" href="#sigil_toc_id_469">Section 3.4.3.12, “Unbreak input profile”</a>) to use your extra profiles.</p>
<p>If your input image is a low dynamic range file like JPEG, or a raw in DNG format, it might already contain an embedded ICC profile which darktable will use as a default. You can always overrule darktable and select a different profile. Select <span>“<span>embedded icc profile</span>”</span> to restore the default.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_467">gamut clipping</h6>
</div>
</div>
</div>
<p>This combobox lets you activate a color clipping mechanism. In most cases you can leave it at its default <span>“<span>off</span>”</span> state. However, if your image shows some specific features like highly saturated blue light sources, gamut clipping might be useful to avoid black pixel artifacts. See <a title="3.2.10.6. Possible color artifacts" href="#sigil_toc_id_265">Section 3.2.10.6, “Possible color artifacts”</a> for more background information.</p>
<p>You can select from a list of RGB profiles. Input colors with a saturation that exceeds the permissible range of the selected profile get clipped to a maximum value. <span>“<span>linear Rec2020 RGB</span>”</span> and <span>“<span>Adobe RGB (compatible)</span>”</span> allow for a broader range of unclipped colors, while <span>“<span>sRGB</span>”</span> and <span>“<span>linear Rec709 RGB</span>”</span> produce a tighter clipping. You should select the profile that prevents artifacts while still maintaining highest color dynamics.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_468">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div align="center"><img alt="inputcolorprofile_ex1" src="../Images/inputcolorprofile_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>Close-up of a blue light source (LED) with gamut clipping off. The activated levels module produces a ring of black pixel artifacts.</td>
</tr>
<tr>
<td>
<div align="center"><img alt="inputcolorprofile_ex2" src="../Images/inputcolorprofile_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>The same image and processing with gamut clipping set to <span>“<span>linear Rec2020 RGB </span>”</span>.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_469">3.4.3.12. Unbreak input profile</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_470">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module adds a correction curve to image data, which is required if you have selected certain input profiles in module <a title="3.4.3.11. Input color profile" href="#sigil_toc_id_266"><span><em>input color profile</em></span></a>.</td>
<td>
<div align="center">
<table border="0" summary="manufactured viewport for HTML img" width="80%">
<tbody>
<tr>
<td align="center"><a href="https://www.darktable.org/usermanual/images/darkroom/modules/unbreakinputprofile.jpg"><img src="https://www.darktable.org/usermanual/images/darkroom/modules/unbreakinputprofile.jpg" alt="" width="100%" align="middle"/></a></td>
</tr>
</tbody>
</table>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_471">Usage</h5>
</div>
</div>
</div>
<p>If you decide in module <a title="3.4.3.11. Input color profile" href="#sigil_toc_id_266"><span><em>input color profile</em></span></a> to use an ICC profile from the camera manufacturer, a correction curve very frequently needs to be pre-applied to image data – or else the final output looks much too dark. This extra processing is not required if you use darktable's standard or enhanced color matrices. The correction curve is defined with a linear part extending from the shadows to some upper limit and a gamma curve covering mid-tones and highlights. For further reading please also have a look at darktable's neighbouring project <a href="http://ufraw.sourceforge.net/" target="_top">UFRaw</a>.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_472">linear</h6>
</div>
</div>
</div>
<p>Set the upper limit for the region counted as shadows and where no gamma correction is performed. Typically values between 0.0 and 0.1 are required by the profile.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_473">gamma</h6>
</div>
</div>
</div>
<p>Set the gamma value to compensate your input profile. Often the required value is 0.45 (the reciprocal of 2.2 gamma used by some manufacturer's profile).</p>
</div>
</div>
</div>
</div>
</div>
<div> </div>
<h3 id="sigil_toc_id_282">3.4.4. Correction group<br/></h3>
<div>The correction group contains the modules that will correct typical problems in an photo such as hotpixels, spot removal, noise, lens correction among others. This group also includes the basic sharpening tools.<br/></div>
<h4 id="sigil_toc_id_66">3.4.4.1. Sharpen<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_474">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This is an standard UnSharp Mask (USM) tool for sharpening the details of an image.</td>
<td>
<div align="center"><img alt="sharpen" src="../Images/sharpen.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_475">Usage</h5>
</div>
</div>
</div>
<p>This module works by enhancing the contrast around edges and thereby enhances the impression of sharpness of an image. In darktable this module is only applied to the L-channel in Lab color space.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_476">radius</h6>
</div>
</div>
</div>
<p>USM applies a gaussian blur to your image as part of its algorithm. This controls the blur radius which in turn defines the spatial extent of edge enhancement. Too high values will lead to ugly over-sharpening.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_477">amount</h6>
</div>
</div>
</div>
<p>This controls the strength of the sharpening.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_478">threshold</h6>
</div>
</div>
</div>
<p>Contrast differences below this threshold are excluded from sharpening. Use this to avoid amplification of noise.</p>
</div>
</div>
<div><h4 id="sigil_toc_id_38">3.4.4.2. Equalizer</h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_479">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This versatile module can be used to achieve a variety of effects, such as: bloom, denoising, clarity, and local contrast enhancement. It works in the wavelet domain and parameters can be tuned for each frequency band separately.</td>
<td>
<div align="right"><a href="../Images/atrous.jpg"><img alt="atrous" src="../Images/atrous.jpg" width="100%"/></a><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_480">Usage</h5>
</div>
</div>
</div>
<p>Each frequency band can be tweaked independently. In particular, you can adjust contrast boost and denoise threshold splines for both lightness and chromaticity (<span>“<span>luma</span>”</span> and <span>“<span>chroma</span>”</span>), as well as the acuteness (<span>“<span>edges</span>”</span>) of the wavelet basis on each frequency scale.</p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Each spline can be dragged with a proportional edit approach; use the mouse wheel to adjust the radius in which your changes will have an effect. The transparent area indicates where you would drag the spline with the current mouse position and radius. The small little triangles on the x-axis can be moved to alter the x-position of the spline nodes.</td>
<td>
<div align="right"><a href="../Images/atrous-1.jpg"><img alt="atrous-1" src="../Images/atrous-1.jpg" width="100%"/></a><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Drag the upper line (bright circles, here for the lightness channel) to affect local contrast. Pulling it up, as shown here, will result in a contrast boost for that frequency band. Higher frequencies, i.e. smaller details, are to the right of the grid. Pulling it down works, too.</td>
<td>
<div align="right"><a href="../Images/atrous-2.jpg"><img alt="atrous-1" src="../Images/atrous-2.jpg" width="100%"/></a><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The bottom spline (black circles) is used to perform denoising. It adjusts the wavelet shrinkage threshold for each frequency band. Pull it up to see the effect. In this example, the noise which has been amplified by local contrast enhancement is removed.</td>
<td>
<div align="right"><a href="../Images/atrous-4.jpg"><img alt="atrous-1" src="../Images/atrous-4.jpg" width="100%"/></a><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This screen shows the effect of the edge parameter. It is here pulled down to zero for all bands. This is effectively a regular à trous wavelet, without edge detection, and results in the characteristic halos around sharp edges in the image.</td>
<td>
<div align="right"><a href="../Images/atrous-5.jpg"><img alt="atrous-1" src="../Images/atrous-5.jpg" width="100%"/></a><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This image is the other extreme. The wavelet basis now oversharpens, which results in ugly gradient reversals near the ridge of the rock.</td>
<td>
<div align="right"><a href="../Images/atrous-6.jpg"><img alt="atrous-1" src="../Images/atrous-6.jpg" width="100%"/></a><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Note that the edge parameter only affects the wavelet basis, not the image directly. You will have to change some denoise/contrast boost parameters to see an effect following adjustments to the edge parameter.</p>
<p>This module additionally has a <span>“<span>mix</span>”</span> slider below the spline GUI. Adjusting the slider will upscale or downscale the splines on the y-axis. The slider was added as a convenience tool to help you modify the strength of the effect. It is not a module parameter in itself; when you leave darkroom mode all changes will be consolidated into the spline curves.</p>
<p>Have a look at the presets where there are a broad variety of examples that will provide a good starting point to gain an intuitive understanding of the controls. Among others there is preset to enhance an image's <span>“<span>clarity</span>”</span>.</p>
</div>
</div>
<h4 id="sigil_toc_id_37">3.4.4.3. Denoise – profiled<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_481">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module offers an easy to use and – at the same time – highly efficient denoise operation. Under the hood it applies (your choice of) a non-local means or edge-aware wavelet denoise algorithm with parameters specifically profiled for certain camera models and ISO settings.</td>
<td>
<div align="center"><img alt="denoise_profiled" src="../Images/denoise_profiled.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_482">Usage</h5>
</div>
</div>
</div>
<p>The darktable team, with the help of many users, has measured noise profiles for various cameras. Differentiated by ISO settings we evaluated how the noise statistics develop with brightness for the three color channels. Our set of profiles covers well above 200 popular camera models from all major manufacturers.</p>
<p>darktable stores noise profiles in an external json file. This file can be found in<code>$DARKTABLE/share/darktable/noiseprofile.json</code> where <code>$DARKTABLE</code> represents the darktable installation directory. The json format is quite straightforward and explained in depth in <a href="http://json.org/" target="_top">json.org</a>. You can replace the default noise profiles by your own ones and specify that file on the command line when starting darktable. For more details see <a title="1.1.1. darktable binary" href="../Text/Overview.xhtml#sigil_toc_id_2">Section 1.1.1, “<code>darktable</code> binary”</a>. If you generate your own noise profiles don't forget to share your results with the darktable team!</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_483">profile</h6>
</div>
</div>
</div>
<p>Based on Exif data of your raw file, darktable will automatically determine the camera model and ISO setting. If found in its database, the corresponding noise profile will be used. If your image has an intermediate ISO value, the statistical properties will be interpolated between the two closest datasets in the database, and this interpolated setting will show up as the first line in the combo box. You also have the option to manually overwrite this selection to suit your personal preferences better. The top-most entry in the combo box brings you back to the profile darktable deems most suited.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_484">mode</h6>
</div>
</div>
</div>
<p>This module can eliminate noise with two different core algorithms. <span>“<span>non-local means</span>”</span> is a bit better suited to tackle luma (lightness) noise; <span>“<span> wavelet</span>”</span> has its strength in eliminating chroma (color) noise. If needed you can apply two instances of this module (see <a title="3.2.4. Multiple instances" href="#sigil_toc_id_180">Section 3.2.4, “Multiple instances”</a>). The <span>“<span>non-local means</span>”</span> instance should be combined with blend mode <span>“<span>lightness</span>”</span> or <span>“<span>HSV lightness</span>”</span>; the <span>“<span>wavelet</span>”</span> instance with blend mode <span>“<span>color</span>”</span> or <span>“<span>HSV color</span>”</span>. For more information on blend modes have a look at <a title="3.2.6. Blending operators" href="#sigil_toc_id_201">Section 3.2.6, “Blending operators”</a>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_485">patch size</h6>
</div>
</div>
</div>
<p>This slider is only available if mode <span>“<span>non-local means</span>”</span> is selected. It controls the size of the patches being matched when deciding which pixels to average (see also&nbsp;<a title="3.4.4.4. Denoise – non local means" href="#sigil_toc_id_39">Section 3.4.4.4, “Denoise – non local means”</a>). Setting this to higher values can give more sharpness. Processing time will stay about the same.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_486">strength</h6>
</div>
</div>
</div>
<p>This parameter is here to fine-tune the strength of the denoise effect. The default value has been chosen to maximize the peak signal to noise ratio. It's mostly a matter of taste if you prefer a rather low noise level at the costs of a higher loss of detail, or if you accept more remaining noise in order to have finer structures better preserved within your image.</p>
</div>
</div>
</div>
<h4 id="sigil_toc_id_39">3.4.4.4. Denoise – non local means<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_487">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This is a denoise algorithm, which will work on chroma and/or luma.</td>
<td>
<div align="center"><img alt="denoise_nlm" src="../Images/denoise_nlm.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_488">Usage</h5>
</div>
</div>
</div>
<p>This module reduces noise in your image but preserves structures. This is accomplished by averaging each pixel with some surrounding pixels in the image. The weight of such a pixel in the averaging process depends on the similarity of its neighborhood with the neighborhood of the one pixel to be denoised. A patch with a certain size is used to measure that similarity. As denoising is a resource hungry process, it slows down pixelpipe processing significantly; consider activating this module late in your workflow.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_489">patch size</h6>
</div>
</div>
</div>
<p>The radius of the patch for similarity evaluation.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_490">strength</h6>
</div>
</div>
</div>
<p>The strength of the denoise. Higher values lead to a stronger effect.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_491">luma</h6>
</div>
</div>
</div>
<p>Amount of denoise to apply to luma. Select carefully in order not to lose too much structure.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_492">chroma</h6>
</div>
</div>
</div>
<p>Amount of denoise to apply to chroma. You can be much more aggressive with this parameter compared to luma.</p>
</div>
</div>
<h4 id="sigil_toc_id_40">3.4.4.5. Denoise – bilateral<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_493">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is used to denoise high ISO pictures. It is flagged as a slow module due to its high resource consumption, both in terms of CPU cycles and in terms of memory usage. Quite counter-intuitively, the greater the values for sliders, the lesser resources.</td>
<td>
<div align="center"><img alt="denoise_bilateral" src="../Images/denoise_bilateral.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_494">Usage</h5>
</div>
</div>
</div>
<p>This module reduces noise in your image but preserves sharp edges. This is accomplished by averaging pixels with their neighbors, taking into account not only the geometric distance but also the distance on the range scale, i.e. differences in the RGB values. As denoising is a resource hungry process, it slows down pixelpipe processing significantly; consider to activate this module late in your workflow.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_495">radius</h6>
</div>
</div>
</div>
<p>Set the spatial extent of the gaussian blur.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_496">red</h6>
</div>
</div>
</div>
<p>Blur intensity for red channel.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_497">green</h6>
</div>
</div>
</div>
<p>Blur intensity for green channel.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_498">blue</h6>
</div>
</div>
</div>
<p>Blur intensity for blue channel.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_499">3.4.4.6. Liquify</h4>
</div>
</div>
</div>

<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_500">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The liquify module offers a versatile way of moving pixels around by applying free style distortions to parts of the image. There are three tools to help doing that: points, lines, and curves.</td>
<td>
<div align="center"><img alt="liquify" src="../Images/liquify.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Each of liquify's tools is based on nodes. A point is given by a single node, a line or a curve consist of a set of nodes defining the path.</p>
<p>There is a limit of 100 nodes in a single liquify instance. For more distortions one can use multiple instances of the liquify module. However, take into account that the liquify module requires a lot of computing resources.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_501">Usage</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The basic elements of all tools in liquify are nodes.</td>
<td>
<div align="center"><img alt="liquify_ex1" src="../Images/liquify_ex1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>You can drag the central point of a node to move the node around. The radius describes the area of the applied effect: the distortion occurs only inside this radius. To change the radius drag the handle at the circumference. A strength vector starting from the center describes the direction of the distortion, and its strength is depicted by the length of the vector. You change the vector by dragging its arrowhead.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_502">warps and nodes count</h6>
</div>
</div>
</div>
<p>This information field displays the the number of warps (individual distortion object) and nodes currently used.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_503">point tool</h6>
</div>
</div>
</div>
<p>Click the&nbsp;<img alt="darkroom_module_liquify_point" src="../Images/darkroom_module_liquify_point.jpg" width="2%"/>&nbsp;icon to activate the point tool and left-click on the image to place it.</p>
<p>A point is formed by a single node. In a point the strength vector has three different modes which are toggled using ctrl-click over the arrowhead of the strength vector:</p>
<div>
<table border="0" width="100%"><colgroup><col width="20%"/>
<col width="40%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>linear</em></span></td>
<td>The linear mode produces a linear distortion inside the circle. Starting from the opposite side of the strength vector and following the strength vector's direction. This is the default mode.</td>
<td>
<div align="center"><img alt="liquify_ex1" src="../Images/liquify_ex1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td><span><em>radial growing</em></span></td>
<td>In this mode the strength vector's effect is radial, starting with a strength of 0% in the center and growing when going away from the center. This mode is depicted by an additional circle with the arrow pointing outwards.</td>
<td>
<div align="center"><img alt="liquify_ex4" src="../Images/liquify_ex4.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td><span><em>radial shrinking</em></span></td>
<td>In this mode the strength vector's effect is radial, starting with a strength of 100% in the center and shrinking when going away from the center. This mode is depicted by an additional circle with the arrow pointing inwards.</td>
<td>
<div align="center"><img alt="liquify_ex3" src="../Images/liquify_ex3.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>Note that the strength by default varies linearly from 0% to 100% between the center and the radius of the control point. It is possible to modify the feathering effect by clicking on the center of the circle:</p>
<div>
<table border="0" width="100%"><colgroup><col width="20%"/>
<col width="40%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>default</em></span></td>
<td>Linear from the center to the radius.</td>
<td>
<div align="center"><img alt="liquify_ex1" src="../Images/liquify_ex1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td><span><em>feathered</em></span></td>
<td>Two control circles are displayed and can be modified independently to feather the strength of the effect. Note that clicking again the center of the circle only hides the feathering controls but does not return to the default.</td>
<td>
<div align="center"><img alt="liquify_ex2" src="../Images/liquify_ex2.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>A point can be removed by right-clicking on the center.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_504">line tool</h6>
</div>
</div>
</div>
<p>Click the&nbsp;<img alt="darkroom_module_liquify_line" src="../Images/darkroom_module_liquify_line.jpg" width="2%"/>&nbsp;icon to activate the line tool and left-click on the image to place the first point, move and left-click to place another point and start forming the path. To end the line just right-click anywhere.</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>A line is a set of points. The points are linked together, the effect is interpolated by a set of strength vectors.</td>
<td>
<div align="center"><img alt="liquify_ex5" src="../Images/liquify_ex5.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>It is possible to add a control point on a line by ctrl-click on a segment. You may remove a control point from a line by ctrl-right- click on the node center.</p>
<p>A right-click on a segment will remove the shape completely.</p>
<p>A ctrl-alt-click on a segment will change it to a curve segment.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_505">curve tool</h6>
</div>
</div>
</div>
<p>Click the&nbsp;<img alt="darkroom_module_liquify_curve" src="../Images/darkroom_module_liquify_curve.jpg" width="2%"/>&nbsp;icon to activate the curve tool and left-click on the image to place the first point, move and left-click to place another point and start forming the path. To end the line just right-click anywhere.</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>A curve is a set of points. The points are linked together, the effect is interpolated as a bezier curve by a set of strength vectors.</td>
<td>
<div align="center"><img alt="liquify_ex6" src="../Images/liquify_ex6.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>It is possible to add a control point on a curve by ctrl-click on a segment. You may remove a control point from a curve by ctrl-right- click on the node center.</p>
<p>A right-click on a segment will remove the shape completely.</p>
<p>A ctrl-alt-click on a segment will change it to a line segment.</p>
<p>It is possible to change the way the points of the curve are linked together by using ctrl-click on the center. There are four modes which correspond to different ways of handling the steepness of the bezier curve by control handles:</p>
<div>
<table border="0" width="100%"><colgroup><col width="36%"/>
<col width="54%"/>
<col width="10%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>autosmooth</em></span></td>
<td>This is the default mode in which the control handles are not displayed as they are automatically computed to always give a smooth curve.</td>
<td> </td>
</tr>
<tr>
<td><span><em>cusp</em></span></td>
<td>Control handles can be moved independently. This mode is depicted by a triangle symbol in the node center.</td>
<td> </td>
</tr>
<tr>
<td><span><em>smooth</em></span></td>
<td>Control handles are always giving a smooth curve. This mode is depicted by a diamond symbol in the node center.</td>
<td> </td>
</tr>
<tr>
<td><span><em>symmetrical</em></span></td>
<td>Control handles are always moved together. This mode is depicted by a square symbol in the node center.</td>
<td> </td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_506">node edit tool</h6>
</div>
</div>
</div>
<p>Clicking the&nbsp;<img alt="darkroom_module_liquify_edit" src="../Images/darkroom_module_liquify_edit.jpg" width="2%"/>&nbsp;icon activates or deactivates the node edit tool displaying all defined distortion objects and their controls. Alternatively you can at any time right-click on the image for the same effect.</p>
</div>
</div>
</div>
<h4 id="sigil_toc_id_47">3.4.4.7. Perspective correction<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_507">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is designed to automatically correct for converging lines, a form of perspective distortions frequently seen in architectural photographs. The underlying mechanism is inspired by Markus Hebel's&nbsp;<a href="http://www.shiftn.de/" target="_top"><span><em>ShiftN</em></span></a> program.</td>
<td>
<div><img alt="ashift" src="../Images/ashift.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Perspective distortions are a natural effect when projecting a three dimensional scene onto a two dimensional plane and cause objects close to the viewer to appear larger than objects further away. Converging lines are a special case of perspective distortions frequently seen in architectural photographs. Parallel lines when photographed at an angle get transformed into converging lines that meet at some vantage point within or outside the image frame.</p>
<p>This module is able to correct converging lines by warping the image in such a way that the lines in question become parallel to the image frame. Corrections can be applied in vertical and horizontal direction, either separately or in combination. In order to perform an automatic correction the module analyzes the image for suitable structural features consisting of line segments. Based on these line segments a fitting procedure is started that determines the best values of the module parameters.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_508">Usage</h5>
</div>
</div>
</div>
<p>Clicking the <span>“<span>get structure</span>”</span> icon (<img alt="darkroom_module_ashift_structure" src="../Images/darkroom_module_ashift_structure.jpg" width="2%"/>) causes darktable to analyze the image for structural elements. Line segments are detected and evaluated. Only lines that form a set of either vertical or horizontal lines are used for further processing steps. The line segments are displayed as overlays on the image base. A color code describes what type of line darktable has found:</p>
<div>
<table border="0" width="100%"><colgroup><col width="20%"/>
<col width="80%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>green</em></span></td>
<td>lines that are selected as relevant vertical converging lines</td>
</tr>
<tr>
<td><span><em>red</em></span></td>
<td>lines that are vertical but are not part of the set of converging lines</td>
</tr>
<tr>
<td><span><em>blue</em></span></td>
<td>lines that are selected as relevant horizontal converging lines</td>
</tr>
<tr>
<td><span><em>yellow</em></span></td>
<td>lines that are horizontal but are not part of the set of converging lines</td>
</tr>
<tr>
<td><span><em>grey</em></span></td>
<td>other lines identified but not of interest to this module</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>Lines marked in red or yellow are regarded as outliers and are not taken into account for the automatic fitting step. This outlier elimination involves a statistical process with random sampling so that each time you press the <span>“<span>get structure</span>”</span> button the color pattern of the lines will look a bit different. You can manually change the status of line segments: left-clicking on a line selects it (turns the color to green or blue) while right-clicking deselects it (turns the color to red or yellow). Keeping the mouse button pressed allows for a sweeping action to select/deselect multiple lines in a row. Holding down the <span><em>shift</em></span> key and keeping the left or right mouse button pressed while dragging selects or deselects all lines in the chosen rectangular area.</p>
<p>Clicking one of the <span>“<span>automatic fit</span>”</span> icons (see below) starts an optimization process which finds the best suited parameters. The image and the overlaid lines are then displayed with perspective corrections applied.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_509">rotation</h6>
</div>
</div>
</div>
<p>This parameter controls a rotation of the image around its center and can correct for a skewed horizon.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_510">lens shift (horizontal)</h6>
</div>
</div>
</div>
<p>This parameter corrects converging lines horizontally.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_511">lens shift (vertical)</h6>
</div>
</div>
</div>
<p>This parameter corrects converging lines vertically. In some cases you get a more naturally looking image if you correct vertical distortions not to their full extent but rather at an 80 to 90% level. If desired just reduce the value after having performed the automatic correction.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_512">shear</h6>
</div>
</div>
</div>
<p>This parameter shears the image along one of its diagonals and is needed when correcting vertical and horizontal perspective distortions simultaneously.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_513">guides</h6>
</div>
</div>
</div>
<p>If activated a number of guide lines is laid over the image to help you judge the quality of the correction.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_514">automatic cropping</h6>
</div>
</div>
</div>
<p>When activated the automatic cropping feature clips the image to get rid of any black corners. At your choice you can either clip to the <span>“<span>largest area</span>”</span> or to the largest rectangle maintaining the original aspect ratio (<span>“<span>original format</span>”</span>).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_515">lens model</h6>
</div>
</div>
</div>
<p>This parameter controls how lens and camera specifics are taken into account. If set to <span>“<span>generic</span>”</span> a focal length of 28mm on a full-format camera is assumed. If set to <span>“<span>specific</span>”</span>, focal length and crop factor can be set manually.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_516">focal length</h6>
</div>
</div>
</div>
<p>The focal length of the lens used. The default value is taken from the Exif data of your image. This parameter is only effective and visible if the <span>“<span>specific</span>”</span> lens model has been selected.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_517">crop factor</h6>
</div>
</div>
</div>
<p>The crop factor of the camera used. You will typically need to set this value manually. This parameter is only effective and visible if the <span>“<span>specific</span>”</span> lens model has been selected.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_518">aspect adjust</h6>
</div>
</div>
</div>
<p>If the <span>“<span>specific</span>”</span> lens model has been selected this parameter allows for a free manual adjustment of the image's aspect ratio.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_519">automatic fit</h6>
</div>
</div>
</div>
<p>Clicking on one of the icons starts an automatic fitting of the module parameters based on the selected vertical and/or horizontal lines. You can choose to correct only vertical distortions (<img alt="darkroom_module_ashift_vertical" src="../Images/darkroom_module_ashift_vertical.jpg" width="2%"/>), only horizontal distortions (<img alt="darkroom_module_ashift_horizontal" src="../Images/darkroom_module_ashift_horizontal.jpg" width="2%"/>), or both types of distortions simultaneously (<img alt="darkroom_module_ashift_both" src="../Images/darkroom_module_ashift_both.jpg" width="2%"/>). <em>Ctrl-clicking</em> on either icon only fits rotation. <em>Shift-clicking</em> on either icon only fits vertical and/or horizontal lens shift.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_520">get structure</h6>
</div>
</div>
</div>
<p>Clicking on the&nbsp;<img alt="darkroom_module_ashift_structure" src="../Images/darkroom_module_ashift_structure.jpg" width="2%"/>&nbsp;icon causes the image to be (re-)analyzed for suitable line segments.<em>Shift-clicking</em> applies a prior contrast enhancement step, <em>ctrl-clicking</em> applies an edge enhancement step. Both variations can be used alone or in combination if the default is not able to detect a sufficient number of lines. Clicking on the&nbsp;<img alt="darkroom_module_ashift_clear" src="../Images/darkroom_module_ashift_clear.jpg" width="2%"/>&nbsp;icon discards all collected structural data. By clicking on the&nbsp;<img alt="darkroom_module_ashift_eye" src="../Images/darkroom_module_ashift_eye.jpg" width="2%"/>&nbsp;icon you can switch the overlay display of line segments on and off.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_521">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="ashift_ex1" src="../Images/ashift_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>An input image with a skewed horizon and converging lines caused by directing the camera upwards.</td>
</tr>
<tr>
<td>
<div><img alt="ashift_ex2" src="../Images/ashift_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>The image after having corrected for vertical and horizontal perspective distortions. Note the framing by the automatic cropping feature and the still visible overlay of structural lines.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_48">3.4.4.8. Lens correction<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_522">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is able to correct certain lens flaws, namely distortions, transversal chromatic aberrations (TCA) and vignetting. It relies on the external library <a href="http://lensfun.sourceforge.net/" target="_top">lensfun</a>, which comes with correction profiles for many (but not all) common cameras and lenses.</td>
<td>
<div><img alt="lenscorrection" src="../Images/lenscorrection.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_523">Usage</h5>
</div>
</div>
</div>
<p>In order to perform lens corrections the module uses Exif data of your image to identify the specific camera/lens combination and collects the needed correction parameters from a profile in lensfun's database.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_524">camera</h6>
</div>
</div>
</div>
<p>The camera make and model as determined by Exif data. You can override this manually and select your camera from a hierarchical menu.</p>
<p>Only lenses with correction profiles matching the selected camera will be shown.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_525">lens</h6>
</div>
</div>
</div>
<p>The lens make and model as determined by Exif data. You can override this manually and select your lens from a hierarchical menu. This is mainly needed for pure mechanical lenses, but may also be needed for off-brand / third party lenses.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_526">photometric parameters: focal length, aperture, focal distance</h6>
</div>
</div>
</div>
<p>Corrections additionally depend on certain photometric parameters that are read from Exif data: focal length (needed for distortion, TCA, vignetting), aperture (needed for TCA, vignetting) and focal distance (needed for vignetting). Many cameras do not record focal distance in their Exif data; most likely you need to set this manually.</p>
<p>You can manually override all automatically selected parameters. Either take one of the predefined values from the pull-down menu; or – with the pull-down menu still open – just type in your own value.</p>
<p>If your system's lensfun library has no correction profile for the automatically identified camera/lens combination the controls for the three photometric parameters are not displayed, and you get a warning message instead. You may try to find the right profile yourself by searching for it in the menu. If you can't find your lens, check if it is in the <a href="http://lensfun.sourceforge.net/lenslist/" target="_top">list of currently supported lenses</a>, and refer to the <a href="http://lensfun.sourceforge.net/manual/lensfun-update-data.html" target="_top">lensfun-update-data tool</a>. If there is no matching profile for your lens, please visit <a href="https://www.darktable.org/2013/07/have-your-lens-calibrated/" target="_top">this lens calibration service</a> offered by Torsten Bronger, one of darktable's users. Alternatively you may go to <a href="http://lensfun.sourceforge.net/" target="_top">lensfun's home page</a> and learn how to generate your own set of correction parameters. Don't forget to share your profile with the lensfun team!</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_527">corrections</h6>
</div>
</div>
</div>
<p>This combobox gives you a choice about which corrections (out of distortion, TCA and vignetting) darktable shall apply. Change this from its default <span>“<span>all</span>”</span>, if your camera has already done some internal corrections (e.g. of vignetting), or if you plan to do certain corrections with a separate program.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_528">geometry</h6>
</div>
</div>
</div>
<p>In addition to the correction of lens flaws, this module can change the projection type of your image. Set this combobox to the aimed projection type, like <span>“<span>rectilinear</span>”</span>, <span>“<span>fish-eye</span>”</span>, <span>“<span>panoramic</span>”</span>, <span>“<span>equirectangular</span>”</span>, <span>“<span>orthographic</span>”</span>, <span>“<span>stereographic</span>”</span>, <span>“<span>equisolid angle</span>”</span>, <span>“<span>thoby fish-eye</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_529">scale</h6>
</div>
</div>
</div>
<p>This slider allows you to adjust the scaling factor of your image. Pressing the auto scale button (right to the slider) will let darktable find the best fit to avoid black corners.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_530">mode</h6>
</div>
</div>
</div>
<p>The default behavior of this module is to correct lens flaws. Switch this combobox to<span>“<span>distort</span>”</span> in order to simulate the behavior of a specific lens (inverted effect).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_531">TCA red</h6>
</div>
</div>
</div>
<p>This slider allows to override the correction parameter for TCA. You can also use this slider to manually set the parameter in case the lens profile does not contain TCA correction. Look out for colored seams at features with high contrast edges and adjust this parameter and the following one to minimize those seams.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_532">TCA blue</h6>
</div>
</div>
</div>
<p>This slider allows to override the correction parameter for TCA. You can also use this slider to manually set the parameter in case the lens profile does not contain TCA correction.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_533">corrections done</h6>
</div>
</div>
</div>
<p>You will sometimes observe that for a given camera/lens combination only part of the possible corrections (distortion, TCA, vignetting) are supported by lensfun's profiles. This message box will tell you what corrections have actually been applied.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_534">3.4.4.9. Scale pixels</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_535">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Some cameras like the Nikon D1X have rectangular instead of the usual square sensor cells. Without correction this would lead to distorted images. This module applies the needed scaling.</td>
<td>
<div><img alt="scalepixels" src="../Images/scalepixels.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_536">Usage</h5>
</div>
</div>
</div>
<p>darktable detects images that need correction by their Exif data and automatically activates this module. For other images the module always remains disabled. The modules has no parameters.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_537">3.4.4.10. Rotate pixels</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_538">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The sensors of some cameras like the Fujifilm FinePix S2Pro, F700, and E550 have a diagonally oriented Bayer pattern instead of the usual orthogonal layout. Without correction this would lead to a tilted image with black corners. This module applies the needed rotation.</td>
<td>
<div><img alt="rotatepixels" src="../Images/rotatepixels.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_539">Usage</h5>
</div>
</div>
</div>
<p>darktable detects images that need correction by their Exif data and automatically activates this module. For other images the module always remains disabled. The modules has no parameters.</p>
</div>
</div>
<h4 id="sigil_toc_id_43">3.4.4.11. Spot removal<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_540">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Spot removal allows you to correct an area in your image by using another area as model.</td>
<td>
<div><img alt="spotremoval" src="../Images/spotremoval.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_541">Usage</h5>
</div>
</div>
</div>
<p>This module uses some of the shapes that are offered in drawn masks, namely circles, ellipses and path shapes. The user interface and the controls are the same as in drawn mask and explained in more detail in <a title="3.2.7. Drawn mask" href="#sigil_toc_id_194">Section 3.2.7, “Drawn mask”</a>.</p>
<p>Select the desired shape by clicking the corresponding icon, then click on the canvas to choose the area to be healed, i.e. the <span><em>target area</em></span>.</p>
<p>The <span><em>source area</em></span> is preliminary positioned at a location with a default distance to the target. Source area and target area can then be shifted independently until the result matches your expectations. An arrow helps to tell source from target area.</p>
<p>Use the shape specific controls to adjust its size, its border width, and other attributes.</p>
<p>Right-click on a shape to delete it.</p>
<p>Collapse the module to complete the changes.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_542">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><a href="../Images/spotremoval_ex1_1.jpg"><img alt="spotremoval_ex1_1" src="../Images/spotremoval_ex1_1.jpg" width="100%"/></a><br/>
</div>
</td>
<td>Let's use this portrait as example; we want to remove some dirt and unwanted catchlight from camera popup strobe.</td>
</tr>
<tr>
<td>
<div><a href="../Images/spotremoval_ex1_2.jpg"><img alt="spotremoval_ex1_2" src="../Images/spotremoval_ex1_2.jpg" width="100%"/></a><br/>
</div>
</td>
<td>I have marked all the spots that I want to remove from the image with circle shapes and appropriately selected source areas.</td>
</tr>
<tr>
<td>
<div><a href="../Images/spotremoval_ex1_3.jpg"><img alt="spotremoval_ex1_3" src="../Images/spotremoval_ex1_3.jpg" width="100%"/></a><br/>
</div>
</td>
<td>And here is the result image of the spotremoval.</td>
</tr>
</tbody>
</table>
</div>
</div>
<h4 id="sigil_toc_id_41">3.4.4.12. Raw denoise<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_543">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Raw denoise allows you to perform denoising on the data before it gets demosaiced. It is ported from <a href="http://www.cybercom.net/~dcoffin/dcraw/" target="_top"><span><em>dcraw</em></span></a>.</td>
<td>
<div><img alt="rawdenoise" src="../Images/rawdenoise.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_544">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_545">noise threshold</h6>
</div>
</div>
</div>
<p>Set the threshold for noise detection. Higher values lead to stronger noise removal and higher loss of image detail.</p>
</div>
</div>
<h4 id="sigil_toc_id_245">3.4.4.13. Dithering<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_546">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module eliminates some of the typical banding artifacts which can occur, when darktable's internal 32-bit floating point data are transferred into a discrete 8-bit or 16-bit integer output format for display or file export.</td>
<td>
<div><img alt="dithering" src="../Images/dithering.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Banding is a problem which can arise, when an image is downsampled into a lower bit-depth. Downsampling happens regularly, when darktable displays or exports the results of a pixelpipe. In order to avoid banding, you may activate this module. As dithering consumes significant resources this module is disabled by default.</p>
<p>Although banding is not an inherent problem of any of darktable's modules, some operations may provoke it as they produce a lightness gradient in the image. To mitigate possible artifacts you should consider to activate dithering when using the<span><em>vignette</em></span> and the <span><em>graduated density</em></span> module, respectively (see&nbsp;<a title="3.4.5.4. Vignetting" href="#sigil_toc_id_551">Section 3.4.5.4, “Vignetting”</a> and <a title="3.4.5.13. Graduated Density" href="#sigil_toc_id_73">Section 3.4.5.13, “Graduated Density”</a>). This is especially relevant for images with extended homogeneous areas like cloudless sky. Also when using a <span><em>gradient mask</em></span> (see&nbsp;<a title="gradient" href="#sigil_toc_id_242">the section called “gradient”</a>) you should watch out for possible banding artifacts.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_547">Usage</h5>
</div>
</div>
</div>
<p>Viewing from some distance an image dithered into a very low bit depth (like <span>“<span>floyd-steinberg 1-bit b&amp;w</span>”</span>) will give the impression of a homogeneous grayscale image. We try to mimic this impression in darktable when you look at zoomed-out images in the center view, in the navigation window and for thumbnails. This is accomplished by dithering those images into a higher number of grayscale levels. Note that as a consequence the histogram – which is derived from the navigation window – will show this increased number of levels and is no longer a full match of the output image.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_548">method</h6>
</div>
</div>
</div>
<p>This combobox sets the dithering method. Floyd-Steinberg error diffusion – with some typical output bit depths – and random noise dithering are both supported. Floyd-Steinberg systematically distributes quantization errors over neighboring pixels, whereas random dithering just adds some level of randomness to break sharp tonal value bands. The default setting is <span>“<span>floyd-steinberg auto</span>”</span>, which automatically adapts to the desired output format.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_549">damping</h6>
</div>
</div>
</div>
<p>This slider is only displayed if you choose method <span>“<span>random</span>”</span>. It controls the level of added random noise expressed as a damping factor in a 10*log <sub>2</sub> basis. A value of -80 is a good fit for 8-bit output formats and -160 for 16-bit ones.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_550">Examples</h5>
</div>
</div>
</div>
<p>The visibility of the following examples depends on the quality of your monitor or the print quality.</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="dithering_ex1" src="../Images/dithering_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>Banding artifact caused by vignetting (100% crop of a 8-bit PNG; effect heavily exaggerated by strong contrast enhancement).</td>
</tr>
<tr>
<td>
<div><img alt="dithering_ex2" src="../Images/dithering_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>The same image area, processed as above but with activated Floyd-Steinberg dithering.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_44">3.4.4.14. Hotpixels<br/></h4>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_552">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is able to automatically detect and eliminate hotpixels. Hotpixels are pixels which failed to record light level correctly. Detected hotpixels are replaced by an average value of their neighbors.</td>
<td>
<div><img alt="hotpixels" src="../Images/hotpixels.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_553">Usage</h5>
</div>
</div>
</div>
<p>You control the detection sensitivity with the threshold parameter and the level of elimination with the strength parameter.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_554">threshold</h6>
</div>
</div>
</div>
<p>The threshold of the detection, i.e. how strong a pixel's value needs to deviate from its neighbors to be regarded as a hotpixel.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_555">strength</h6>
</div>
</div>
</div>
<p>The strength of blending hotpixels with their surrounding.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_556">detect by 3 neighbours</h6>
</div>
</div>
</div>
<p>This will extend the detection of hotpixels, it will even regard a pixel as hot if a minimum of only three (instead of four) neighbor pixels deviate by more than the threshold level.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_557">mark fixed pixels</h6>
</div>
</div>
</div>
<p>This options will mark the pixels that have been corrected. It also displays the count of detected and fixed pixels.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_558">3.4.4.15. Chromatic aberrations</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_559">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module allows you to correct chromatic aberrations.</td>
<td>
<div><img alt="chromatic" src="../Images/chromatic.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_560">Usage</h5>
</div>
</div>
</div>
<p>The module has no parameters. On activation it will automatically try to optimize away visible CA's.</p>
<p>The underlying model assumes as input an uncropped photographic image. The module is likely to fail when you zoom into the image, as in that case it will only receive parts of your photograph as input in darktable's pixelpipe. As a consequence, chromatic aberrations do not get corrected properly in the center view. This limitation only applies to interactive work, not to file export.</p>
<p>This module currently only works for images recorded with a Bayer sensor (which is the sensor used in the majority of cameras).</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_561">3.4.4.16. Automatic haze removal</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_562">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The haze removal module is designed to automatically reduce the effect of dust and haze in the air, which often reduces the color contrast in landscape photographs. In general, this module may be employed to give pictures a color boost specifically in low-contrast image regions.</td>
<td>
<div><img alt="hazeremoval" src="../Images/hazeremoval.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>The higher the haze density in the air and the longer the distance between the camera and the photographed object the less colorful the object appears in the image. Haze absorbs light approaching from the objects into the direction of the camera but it is also a source of diffusive background light. Thus the haze removal module estimates for each image region the amount of haze in the scene first and then removes the diffusive background light according to its local strength and recovers the original object light.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_563">Usage</h5>
</div>
</div>
</div>
<p>The haze removal module has two controls that determine the amount of haze reduction and limit the distance up to which haze is removed. Setting both controls to unity maximizes the amount of haze removal but this is also likely to produce some artifacts. Removing the atmospheric light entirely may render the image flat and may result in an unnatural looking style. Optimal values are typically below unity and these are rather image dependent but also a matter of personal aesthetic preferences.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_564">strength</h6>
</div>
</div>
</div>
<p>The strength parameter controls the amount of haze removal. Setting it to unity, the module removes 100 percent of the detected haze between the camera and up to the specified distance; see below. Negative values for the strength increase the amount of haze in the image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_565">distance</h6>
</div>
</div>
</div>
<p>This parameter limits the distance up to which haze is removed. For small values, haze removal is restricted to the foreground of the image. Haze is removed from the foreground to the far background if the distance parameter is set to unity. In case of a negative strength the distance control has no effect.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_566">3.4.4.17. Defringe</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_567">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is designed to remove purple or any other color of fringing which often results from Longitudinal Chromatic Aberrations (LCA), also known as Axial Chromatic Aberrations.</td>
<td>
<div><img alt="defringe" src="../Images/defringe.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_568">Usage</h5>
</div>
</div>
</div>
<p>This module helps removing fringe via edge-detection. Where pixels are detected as a fringe, it rebuilds the color from lower-saturated neighboring pixels.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_569">operation mode</h6>
</div>
</div>
</div>
<p>Set the operation mode for detecting fringes. <span>“<span>global average</span>”</span> is usually the fastest but might show slightly incorrect previews in high magnification. It might also protect the wrong regions of color too much or too little by comparison with local averaging. <span>“<span>local average</span>”</span> is slower because it computes local color references for every pixel, which might protect color better than global average and allows for rebuilding color where actually required. The <span>“<span>static</span>”</span> method does not use a color reference but directly uses the threshold as given by the user.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_570">edge detection radius</h6>
</div>
</div>
</div>
<p>Set the spatial extent of the gaussian blur used for an edge detection. The algorithm uses the difference of gaussian-blurred and original image as an indicator for edges (a special case of the <span>“<span>difference of gaussians</span>”</span> edge detection). Try increasing this value if you either want a stronger detection of the fringes or the thickness of the fringe edges is too high.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_571">threshold</h6>
</div>
</div>
</div>
<p>Sets the threshold over which the edge of a pixel is counted as a <span>“<span>fringe</span>”</span>. The colors of the affected pixels will be rebuild from neighboring pixels. Try lowering this value if there is not enough fringe detected and try increasing this value if too many pixels are desaturated. You may additionally want to play around with the edge detection radius.</p>
</div>
</div>
</div>
</div>
</div>
<div> </div>
<h3 id="sigil_toc_id_283">3.4.5. Effect group<br/></h3>
<p>In the effect group you will find modules with a more artistic touch.</p>
<div> </div>
<h4 id="sigil_toc_id_69">3.4.5.1. Watermark<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_572">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>The watermark module provides a way to render a vector-based overlay onto your image. Watermarks are standard SVG documents and can be designed using&nbsp;<a href="http://www.inkscape.org/" target="_top"><span><em>Inkscape</em></span></a>.</td>
<td>
<div><img alt="watermark" src="../Images/watermark.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>The SVG processor of darktable also substitutes strings within the SVG document, which gives the opportunity to include image dependent information in the watermark such as aperture, exposure time and other metadata.</p>
<p>User-designed watermarks are placed into the directory $HOME/.config/darktable/watermarks. Once in place, use the reload button at the right of the watermark file name to update the list of available watermarks to use.</p>
<p>Here follows a list of available variable strings that is supported for substitution within the svg document.</p>
<div>
<table border="0" width="100%"><colgroup><col width="50%"/>
<col width="50%"/>
</colgroup>
<tbody>
<tr>
<td>$(DARKTABLE.NAME)</td>
<td>The application name</td>
</tr>
<tr>
<td>$(DARKTABLE.VERSION)</td>
<td>The version of darktable</td>
</tr>
<tr>
<td>$(WATERMARK_TEXT)</td>
<td>A short free text (max. 63 characters)</td>
</tr>
<tr>
<td>$(WATERMARK_COLOR)</td>
<td>The color to use for $WATERMARK_TEXT</td>
</tr>
<tr>
<td>$(WATERMARK_FONT_FAMILY)</td>
<td>The font family to use for $WATERMARK_TEXT</td>
</tr>
<tr>
<td>$(WATERMARK_FONT_STYLE)</td>
<td>The font style (normal, oblique, italic)</td>
</tr>
<tr>
<td>$(WATERMARK_FONT_WEIGHT)</td>
<td>The font weight (boldness)</td>
</tr>
<tr>
<td>$(IMAGE.ID)</td>
<td>The unique image id within current library</td>
</tr>
<tr>
<td>$(IMAGE.FILENAME)</td>
<td>The image filename</td>
</tr>
<tr>
<td>$(IMAGE.BASENAME)</td>
<td>The image file basename</td>
</tr>
<tr>
<td>$(IMAGE.EXIF)</td>
<td>The image Exif string</td>
</tr>
<tr>
<td>$(EXIF.DATE)</td>
<td>The image date</td>
</tr>
<tr>
<td>$(EXIF.DATE.SECOND)</td>
<td>Seconds from the image Exif data</td>
</tr>
<tr>
<td>$(EXIF.DATE.MINUTE)</td>
<td>Minutes from the image Exif data</td>
</tr>
<tr>
<td>$(EXIF.DATE.HOUR)</td>
<td>Hours from the image Exif data (24h)</td>
</tr>
<tr>
<td>$(EXIF.DATE.HOUR_AMPM)</td>
<td>Hours from the image Exif data (12h, AM/PM)</td>
</tr>
<tr>
<td>$(EXIF.DATE.DAY)</td>
<td>Day of month from the image Exif data (01 .. 31)</td>
</tr>
<tr>
<td>$(EXIF.DATE.MONTH)</td>
<td>Month from the image Exif data (01 .. 12)</td>
</tr>
<tr>
<td>$(EXIF.DATE.SHORT_MONTH)</td>
<td>Month from the image Exif data localized (Jan, Feb, .. Dec)</td>
</tr>
<tr>
<td>$(EXIF.DATE.LONG_MONTH)</td>
<td>Month from the image Exif data localized (January, February, .. December)</td>
</tr>
<tr>
<td>$(EXIF.DATE.SHORT_YEAR)</td>
<td>Abbreviated year from the image Exif data (2013 is "13")</td>
</tr>
<tr>
<td>$(EXIF.DATE.LONG_YEAR)</td>
<td>Full year from the image Exif data</td>
</tr>
<tr>
<td>$(DATE)</td>
<td>Current system date</td>
</tr>
<tr>
<td>$(DATE.SECOND)</td>
<td>Current system time seconds</td>
</tr>
<tr>
<td>$(DATE.MINUTE)</td>
<td>Current system time minutes</td>
</tr>
<tr>
<td>$(DATE.HOUR)</td>
<td>Current system time hours (24h)</td>
</tr>
<tr>
<td>$(DATE.HOUR_AMPM)</td>
<td>Current system time hours (12, AP/PM)</td>
</tr>
<tr>
<td>$(DATE.DAY)</td>
<td>Current system time day of month (01 .. 31)</td>
</tr>
<tr>
<td>$(DATE.MONTH)</td>
<td>Current system time month (01 .. 12)</td>
</tr>
<tr>
<td>$(DATE.SHORT_MONTH)</td>
<td>Current system time month localized (Jan, Feb, .. Dec)</td>
</tr>
<tr>
<td>$(DATE.LONG_MONTH)</td>
<td>Current system time month localized (January, February, .. December)</td>
</tr>
<tr>
<td>$(DATE.SHORT_YEAR)</td>
<td>Current system time year (abbreviated)</td>
</tr>
<tr>
<td>$(DATE.LONG_YEAR)</td>
<td>Current system time year</td>
</tr>
<tr>
<td>$(EXIF.MAKER)</td>
<td>The maker of camera model</td>
</tr>
<tr>
<td>$(EXIF.MODEL)</td>
<td>The camera model</td>
</tr>
<tr>
<td>$(EXIF.LENS)</td>
<td>The specific lens used</td>
</tr>
<tr>
<td>$(Xmp.dc.creator)</td>
<td>The creator string</td>
</tr>
<tr>
<td>$(Xmp.dc.publisher)</td>
<td>The publisher string</td>
</tr>
<tr>
<td>$(Xmp.dc.title)</td>
<td>The title of the image</td>
</tr>
<tr>
<td>$(Xmp.dc.description)</td>
<td>The description of the image</td>
</tr>
<tr>
<td>$(Xmp.dc.rights)</td>
<td>The rights assigned to the image</td>
</tr>
<tr>
<td>$(GPS.LATITUDE)</td>
<td>The image latitude coordinate (N/S 0 .. 90)</td>
</tr>
<tr>
<td>$(GPS.LONGITUDE)</td>
<td>The image longitude coordinate (E/W 0 .. 180)</td>
</tr>
<tr>
<td>$(GPS.ELEVATION)</td>
<td>The image elevation level (meters)</td>
</tr>
<tr>
<td>$(GPS.LOCATION)</td>
<td>All three coordinates (latitude, longitude, elevation)</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_573">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_574">marker</h6>
</div>
</div>
</div>
<p>Choose the watermark of interest. You can use the reload button next to the combobox to update the list with all newly added watermarks.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_575">text</h6>
</div>
</div>
</div>
<p>A free text field with up to 63 characters which gets printed if the corresponding watermark references it. An example is supplied as <code>simple-text.svg</code>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_576">text color</h6>
</div>
</div>
</div>
<p>This field shows the text color. Clicking on the colored field will open a color selector dialog which offers you a choice of commonly used colors, or allows to define a color in RGB color space.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_577">text font</h6>
</div>
</div>
</div>
<p>This field lets you select the text font. Clicking on the field opens a dialog box which shows the fonts available to your system. Fonts can be searched by name and a preview of each available font is shown next to the font name; you may specify your own sample text. The font defaults to <span>“<span>DejaVu Sans Book</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_578">opacity</h6>
</div>
</div>
</div>
<p>Set the opacity of the watermark's rendering.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_579">scale</h6>
</div>
</div>
</div>
<p>Scale the watermark pixel-independently.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_580">rotate</h6>
</div>
</div>
</div>
<p>Set the rotation angle of the watermark.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_581">scale on</h6>
</div>
</div>
</div>
<p>Defines the reference for the scale parameter. The default setting <span>“<span>image</span>”</span> scales the watermark relative to the horizontal image size. Alternatively you can scale the watermark relative to the <span>“<span>larger border</span>”</span> and <span>“<span>smaller border</span>”</span>, respectively.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_582">alignment</h6>
</div>
</div>
</div>
<p>Use these controls to align the watermark to any edge or center of the image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_583">x offset</h6>
</div>
</div>
</div>
<p>Pixel-independent offset relative to the choice of alignment on the x-axis.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_584">y offset</h6>
</div>
</div>
</div>
<p>Pixel-independent offset relative to the choice of alignment on the y-axis.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_585">3.4.5.2. Framing</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_586">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is an artistic feature to generate a frame around your image. The frame consists of a border with a user defined color and a frame line inside that border, which has another user defined color. There are various options for you to control the geometry of your frame.</td>
<td>
<div><img alt="framing" src="../Images/framing.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_587">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_588">border size</h6>
</div>
</div>
</div>
<p>This slider controls the size of the frame in percent of the underlying full image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_589">aspect</h6>
</div>
</div>
</div>
<p>With this combobox you can choose between different aspect ratios for the final output of this module, i.e. underlying image plus frame.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_590">orientation</h6>
</div>
</div>
</div>
<p>If you select a non-square aspect ratio this combobox defines the orientation – portrait or landscape. Set to <span>“<span>auto</span>”</span> if you want darktable to select the most reasonable orientation based on the underlying image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_591">horizontal position</h6>
</div>
</div>
</div>
<p>Select from a set of pre-defined ratios where you want your underlying image be positioned on the horizontal axis. You can also right click and enter your own ratio as<span>“<span>x/y</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_592">vertical position</h6>
</div>
</div>
</div>
<p>Select from a set of pre-defined ratios where you want your underlying image be positioned on the vertical axis. You can also right click and enter your own ratio as<span>“<span>x/y</span>”</span>.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_593">frame line size</h6>
</div>
</div>
</div>
<p>The percentage of the frame line size relative to the border size at its smallest part.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_594">frame line offset</h6>
</div>
</div>
</div>
<p>Where the frame line is positioned relative to the underlying image. Select a value of 0 for a frame line touching the image, 100% for a frame line touching the outer border limits.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_595">border color</h6>
</div>
</div>
</div>
<p>A color selector which allows to define a color for the border. Clicking on the colored field will open a color selector dialog which offers you a choice of commonly used colors, or allows to define a color in RGB color space.</p>
<p>You can also activate a color picker by pressing&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;and take a color probe from your image. You can switch between point and area sampling mode from within the global color picker panel (see <a title="3.3.4. Global color picker" href="#sigil_toc_id_254">Section 3.3.4, “Global color picker”</a>).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_596">frame line color</h6>
</div>
</div>
</div>
<p>A color selector which allows to define a color for the frame. Clicking on the colored field will open a color selector dialog which offers you a choice of commonly used colors, or allows to define a color in RGB color space.</p>
<p>You can also activate a color picker by pressing&nbsp;<img alt="darkroom_module_icon_picker" src="../Images/darkroom_module_icon_picker.jpg" width="2%"/>&nbsp;and take a color probe from your image. You can switch between point and area sampling mode from within the global color picker panel (see <a title="3.3.4. Global color picker" href="#sigil_toc_id_254">Section 3.3.4, “Global color picker”</a>).</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_597">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="framing_ex1" src="../Images/framing_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>Example image with a user defined frame.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_223">3.4.5.3. Splittoning<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_598">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>darktable's splittoning method creates a two color linear toning effect where the shadows and highlights are represented by two different colors. In the example image below you can see an original black and white image and one where a splittoning effect is applied with blue in shadows and a yellowish color in highlights.</td>
<td>
<div><img alt="splittoning" src="../Images/splittoning.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>Compared to traditional splittoning our module has more parameters to influence its behavior. We have parameter <span>“<span>balance</span>”</span>, which offsets the 50% gray level in your image – at your choice – more to the shadows or more to the highlights. Additionally, with parameter <span>“<span>compression</span>”</span> you can compress toning in the shadows and highlights and leave a gap in the mid-tones, which remain untouched by the effect.</p>
<p>The splittoning module does not convert images to black and white and has limited benefits on color images. So, if you want to do traditional splittoning, use the<span><em>monochrome</em></span> module (see <a title="3.4.3.7. Monochrome" href="#sigil_toc_id_63">Section 3.4.3.7, “Monochrome”</a>) to make the image black and white before playing around with splittoning effect.</p>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_599">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_600">shadows and highlights color</h6>
</div>
</div>
</div>
<p>These controls are used to set the color of the splittoning effect, you select the desired color and saturation for both shadows and highlights. Clicking on the colored squares will open a color selector dialog which offers you a choice of commonly used colors, or allows to define a color in RGB color space.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_601">balance</h6>
</div>
</div>
</div>
<p>This parameter represents the ratio of toning between shadows and highlights. For a value of 50% half of the lightness range in image is used for shadows toning and the other half for highlights toning.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_602">compression</h6>
</div>
</div>
</div>
<p>Compression is a percentage of total lightness range that is not affected by color toning. Default value is set to 33%; this is not the default behavior of an original splittoning which would be 0% compression. The choice of 33% as a default is to invite you experimenting with these parameters and how it extends the original splittoning method.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_603">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><a href="../Images/splittoning_ex1.jpg"><img alt="splittoning_ex1" src="../Images/splittoning_ex1.jpg" width="100%"/></a><br/>
</div>
</td>
<td>Original black and white image.</td>
</tr>
<tr>
<td>
<div><a href="../Images/splittoning_ex2.jpg"><img alt="splittoning_ex2" src="../Images/splittoning_ex2.jpg" width="100%"/></a><br/>
</div>
</td>
<td>Splittoning with blue shadows and yellow highlights.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_551">3.4.5.4. Vignetting</h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_604">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is an artistic feature which creates vignetting (modification of the brightness/saturation at the borders).</td>
<td>
<div><img alt="vignetting" src="../Images/vignetting.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_605">Usage</h5>
</div>
</div>
</div>
<p>The vignetting module has an extensive set of parameters to precisely tune its effect. It also will display graphical controls within the image if the module is in focus. Give it a try to get a feeling of how it works. On-screen controls and parameter sliders will stay in sync.</p>
<p>This module is known to provoke banding artifacts under certain conditions; you should consider to activate the <span><em>dithering</em></span> module (see <a title="3.4.4.13. Dithering" href="#sigil_toc_id_245">Section 3.4.4.13, “Dithering”</a>).</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_606">scale</h6>
</div>
</div>
</div>
<p>Set the radius of the vignetting area.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_607">fall-off strength</h6>
</div>
</div>
</div>
<p>Sets the progressiveness of the fall-off. Higher values will cause a steeper transition.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_608">brightness</h6>
</div>
</div>
</div>
<p>Sets the intensity of brightening (positive values) or darkening (negative values).</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_609">saturation</h6>
</div>
</div>
</div>
<p>Controls how strong colors become when desaturated or saturated in the darkened or brightened vignetting area.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_610">horizontal center</h6>
</div>
</div>
</div>
<p>Shifts the center of the vignetting area horizontally.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_611">vertical center</h6>
</div>
</div>
</div>
<p>Shifts the center of the vignetting area vertically.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_612">shape</h6>
</div>
</div>
</div>
<p>Influences the shape of the vignetting area. The default value of 1 causes a circular or elliptical area. Smaller values will shift the shape into a more square one; higher values turn it into a cross-like shape.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_613">automatic ratio</h6>
</div>
</div>
</div>
<p>Click this button to automatically adjust the width/height ratio of the vignetting area to the aspect ratio of the underlying image. The vignetting area will typically become elliptical.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_614">width/height ratio</h6>
</div>
</div>
</div>
<p>Manually adjust the width/height ratio of the vignetting area.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_615">dithering</h6>
</div>
</div>
</div>
<p>With this combobox you can activate random noise dithering to overcome banding artifacts caused by vignette gradients. Select <span>“<span>8-bit output</span>”</span> to prevent banding on monitor display and for JPEGs. When set to <span>“<span>16-bit output</span>”</span>, only a little dithering will be applied, just strong enough to compensate for banding on the fine grained 16-bit level. This feature is mostly obsoleted by our new module <span><em>dithering</em></span> (see&nbsp;<a title="3.4.4.13. Dithering" href="#sigil_toc_id_245">Section 3.4.4.13, “Dithering”</a>).</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_616">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="vignetting_ex1" src="../Images/vignetting_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>An image with vignetting and with graphical vignetting controls displayed.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_617">3.4.5.5. Soften</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_618">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is an artistic feature that creates a softened image, commonly known as the Orton effect.</td>
<td>
<div><img alt="soften" src="../Images/soften.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_619">Usage</h5>
</div>
</div>
</div>
<p>Michael Orton achieved his results on slide film by using two exposures of the same scene: one well exposed and one overexposed; he then used a darkroom technique to blend those into a final image where the overexposed image was blurred.</p>
<p>This module is almost a copy of Orton's analogue process into the digital domain. You can control brightness and blur with the provided parameters; we also add a control for saturation of the overexposured image for more play.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_620">size</h6>
</div>
</div>
</div>
<p>Set the size of blur of the overexposed image in the process, the bigger the softer.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_621">saturation</h6>
</div>
</div>
</div>
<p>Set the saturation of the overexposed image.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_622">brightness</h6>
</div>
</div>
</div>
<p>Expressed in [EV], the brightness slider selects the increase in brightness.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_623">mix</h6>
</div>
</div>
</div>
<p>Controls the mix of the overexposed image and the overall effect.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_624">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><a href="../Images/soften_ex1.jpg"><img alt="soften_ex1" src="../Images/soften_ex1.jpg" width="100%"/></a><br/>
</div>
</td>
<td>This is the original image, use it as reference for the changes below...</td>
</tr>
<tr>
<td>
<div><a href="../Images/soften_ex2.jpg"><img alt="soften_ex2" src="../Images/soften_ex2.jpg" width="100%"/></a><br/>
</div>
</td>
<td>In this image I used the default values, and added 0.33EV to brightness for a little more light in the soft layer.</td>
</tr>
<tr>
<td>
<div><a href="../Images/soften_ex3.jpg"><img alt="soften_ex3" src="../Images/soften_ex3.jpg" width="100%"/></a><br/>
</div>
</td>
<td>This version is the same as above but with 25% saturation.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div> </div>
<h4 id="sigil_toc_id_70">3.4.5.6. Grain<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_625">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is an artistic feature which simulates the grain of a film.</td>
<td>
<div><img alt="grain" src="../Images/grain.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_626">Usage</h5>
</div>
</div>
</div>
<p>The grain is processed on the L channel from CIELAB.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_627">coarseness</h6>
</div>
</div>
</div>
<p>Set the grain size, which has been scaled to simulate an ISO number.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_628">strength</h6>
</div>
</div>
</div>
<p>Set the strength of the effect.</p>
</div>
</div>
<h4 id="sigil_toc_id_67">3.4.5.7. Highpass<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_629">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Highpass acts as a high pass filter. The primary usage for this filter is in combination with a blending operator. Try out blend mode <span>“<span>soft light</span>”</span> to get highpass sharpening. Use the opacity slider to adjust the strength of the effect or use a <span><em>drawn mask</em></span> (see <a title="3.2.7. Drawn mask" href="#sigil_toc_id_194">Section 3.2.7, “Drawn mask”</a>) or <span><em>parametric mask</em></span> (see <a title="3.2.8. Parametric mask" href="#sigil_toc_id_202">Section 3.2.8, “Parametric mask”</a>) to limit the effect to only parts of your image.</td>
<td>
<div><img alt="highpass" src="../Images/highpass.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_630">Usage</h5>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_631">sharpen</h6>
</div>
</div>
</div>
<p>Set the sharpness. The higher, the more details.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_632">contrast boost</h6>
</div>
</div>
</div>
<p>Set the contrast boost.</p>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_633">3.4.5.8. Lowpass</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_634">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>A lowpass filter (eg. gaussian blur) with additional control of the outcome both of contrast and saturation. The primary usage for lowpass filter is in combination with a <span><em>blending operator</em></span> (see <a title="3.2.6. Blending operators" href="#sigil_toc_id_201">Section 3.2.6, “Blending operators”</a>). Try out the preset named <span>“<span>local contrast mask</span>”</span> with an <span>“<span>overlay</span>”</span> blending operation.</td>
<td>
<div><img alt="lowpass" src="../Images/lowpass.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_635">Usage</h5>
</div>
</div>
</div>
<p>This module offers enormous artistic potential, albeit, with results that are sometimes difficult to predict.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_636">radius</h6>
</div>
</div>
</div>
<p>Set the radius of the blur.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_637">soften with</h6>
</div>
</div>
</div>
<p>This combobox defines the blur algorithm; you can choose between <span>“<span>gaussian</span>”</span> blur (default) and <span>“<span>bilateral</span>”</span> filter. The latter leads to an edge preserving blur. <span>“<span>gaussian</span>”</span>will blur all image channels: L, a and b. <span>“<span>bilateral</span>”</span> will only blur L channel.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_638">contrast</h6>
</div>
</div>
</div>
<p>Changes the contrast. Negative values result in an inverted negative image. Higher absolute values increase contrast; lower absolute values reduce contrast. A value of zero leads to a neutral plane.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_639">brightness</h6>
</div>
</div>
</div>
<p>Changes the brightness. Negative values result in a darker image. Positive values increase the image's brightness.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_640">saturation</h6>
</div>
</div>
</div>
<p>Changes the color saturation. Negative values result in complementary colors by inverting the a/b-channels. Higher absolute values increase color saturation; lower absolute values reduce color saturation. A value of zero leads to a desaturated black&amp;white image.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_641">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="lowpass_ex1" src="../Images/lowpass_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>The original image, already heavily processed. The boat is almost a silhouette.</td>
</tr>
<tr>
<td>
<div><img alt="lowpass_ex2" src="../Images/lowpass_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>Bilateral blur with high radius. Desaturated, inverted and with high contrast.</td>
</tr>
<tr>
<td>
<div><img alt="lowpass_ex3" src="../Images/lowpass_ex3.jpg" width="100%"/><br/>
</div>
</td>
<td>Intermediate result after lowpass filter ...</td>
</tr>
<tr>
<td>
<div><img alt="lowpass_ex4" src="../Images/lowpass_ex4.jpg" width="100%"/><br/>
</div>
</td>
<td>... and final image after this was applied with blend mode "vividlight".</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h4 id="sigil_toc_id_71">3.4.5.9. Low light<br/></h4>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_642">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>The <span><em>low light</em></span> module allows one to simulate human lowlight vision, thus providing ability to make lowlight pictures look closer to reality. It can also be used to perform a day to night conversion.</p>
<p>The idea is to calculate a <a href="http://en.wikipedia.org/wiki/Scotopic_vision" target="_top">scotopic vision</a> image which is perceived by rods rather than than cones in the eye under low light. Scotopic lightness then is mixed with photopic value (regular color image pixel) using some blending function. Also this module is able to simulate the <a href="http://en.wikipedia.org/wiki/Purkinje_effect" target="_top">Purkinje effect</a> by adding some blueness to the dark parts of the image.</p>
</td>
<td>
<div><img alt="lowlight" src="../Images/lowlight.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_643">Usage</h5>
</div>
</div>
</div>
<p>This module comes with several presets. Give them a try to get a better feeling how it works.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_644">curve</h6>
</div>
</div>
</div>
<p>The horizontal axis is about pixel lightness from dark (left) to bright (right). The vertical axis represents the kind of vision from night vision (bottom) to day vision (top)</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_645">blue</h6>
</div>
</div>
</div>
<p>Set the blue hint in shadows (Purkinje effect).</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_646">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="lowlight_ex1_1" src="../Images/lowlight_ex1_1.jpg" width="100%"/><br/>
</div>
</td>
<td>Image 1. This is the original image.</td>
</tr>
<tr>
<td>
<div><img alt="lowlight_ex1_2" src="../Images/lowlight_ex1_2.jpg" width="100%"/><br/>
</div>
</td>
<td>Image 1. With low light module on.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Image 2. This is the original image.</td>
<td>
<div><img alt="lowlight_ex2_1" src="../Images/lowlight_ex2_1.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>Image 2. With low light module on.</td>
<td>
<div><img alt="lowlight_ex2_2" src="../Images/lowlight_ex2_2.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_647">3.4.5.10. Bloom</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_648">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module takes highlights, blurs them and then blends (screen blend lightness) with the original to create a soft blooms over the image, hence the name of the effect. There are numerous ways to use this module depending on the image's actual scenery lighting.</td>
<td>
<div><img alt="bloom" src="../Images/bloom.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_649">Usage</h5>
</div>
</div>
</div>
<p>Starting from the default settings change the strength value for a pleasant look, then change the size to control the spread of light.</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_650">size</h6>
</div>
</div>
</div>
<p>Represents the spatial extent of the bloom effect.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_651">threshold</h6>
</div>
</div>
</div>
<p>Set the threshold for the increase in brightness.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_652">strength</h6>
</div>
</div>
</div>
<p>Set the strength of overlightning for the effect.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_653">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="bloom_ex1" src="../Images/bloom_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>This is the original image, use it as reference for the changes below...</td>
</tr>
<tr>
<td>
<div><img alt="bloom_ex2" src="../Images/bloom_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>Here we have chosen to use a size of 10%, which is a rather small radius for the soft light spread. We boosted up the strength to 50% for a more exaggerated effect.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_654">3.4.5.11. Colorize</h4>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_655">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module is an artistic feature that adds a solid layer of color to your image.</td>
<td>
<div><img alt="colorize" src="../Images/colorize.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_656">Usage</h5>
</div>
</div>
</div>
<p>Several parameters control the effect of this module. Much more versatility can be reached if you apply blending and masks. (see <a title="3.2.5. Blending" href="#sigil_toc_id_203">Section 3.2.5, “Blending”</a>).</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_657">hue</h6>
</div>
</div>
</div>
<p>Selects the hue of the color layer.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_658">saturation</h6>
</div>
</div>
</div>
<p>Selects the color saturation of shadow tones.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_659">lightness</h6>
</div>
</div>
</div>
<p>Selects the lightness of the color layer.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_660">source mix</h6>
</div>
</div>
</div>
<p>This slider controls how the lightness of the input image is mixed in. If you set this to zero a uniformly colored plane will result.</p>
</div>
</div>
</div>
<h4 id="sigil_toc_id_72">3.4.5.12. Color mapping<br/></h4>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_661">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module transfers the look and feel from one image onto another. It statistically analyses the color characteristics of a source image and a target image. The colors of the source image are then mapped to corresponding colors of the target image.</td>
<td>
<div><img alt="colormapping" src="../Images/colormapping.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_662">Usage</h5>
</div>
</div>
</div>
<p>To use this module two steps are required.</p>
<p>First you open the source image in darkroom mode and acquire its color characteristics by pressing the <span>“<span>acquire as source</span>”</span> button. A set of color clusters is generated and displayed in the <span>“<span>source clusters</span>”</span> area. Each cluster is represented by a set of color swatches with the mean value in the center surrounded by swatches indicating the color variance within that cluster. The clusters are sorted in ascending order by their weight, i.e. the number of pixels that contribute to the clusters.</p>
<p>Next you open your target image in darkroom mode. darktable has remembered the previously collected source clusters; if they are not yet displayed, press the&nbsp;<img alt="darkroom_module_icon_reset" src="../Images/darkroom_module_icon_reset.jpg" width="2%"/>&nbsp;button. You now press the “acquire as target” button to generate a corresponding set of color clusters for your target image, which gets displayed in the “target clusters” area.</p>
<p>When both source and target clusters are collected an automatic color mapping is applied to the target image. In its default settings the overall effect is quite exaggerated. A set of sliders gives you control of the effect's strength. You can also use blending operator <span>“<span>normal</span>”</span> to tame the effect (see <a title="3.2.6. Blending operators" href="#sigil_toc_id_201">Section 3.2.6, “Blending operators”</a>). As the <span><em>color mapping</em></span> module comes early in the pixelpipe, you can finetune the colors with modules like <span><em>tone curve</em></span> (see <a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56">Section 3.4.2.3, “Tone curve”</a>) or <span><em>color correction</em></span> (see <a title="3.4.3.5. Color correction" href="#sigil_toc_id_62">Section 3.4.3.5, “Color correction”</a>).</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_663">acquire as source/target</h6>
</div>
</div>
</div>
<p>Press these buttons to generate color clusters for the source and target image, respectively. The processing takes a few seconds during which the GUI remains unresponsive.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_664">number of clusters</h6>
</div>
</div>
</div>
<p>Sets the number of color clusters to use. If you change this parameter all collected color clusters are reset and need to be acquired anew.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_665">color dominance</h6>
</div>
</div>
</div>
<p>This parameter controls the mapping between source and target clusters. At the lowest value mapping is based on color proximity. This typically leads to very subtle effects on the target image. At the maximum value mapping is based on the relative weight of the color clusters – dominant colors of the source image are mapped to dominant colors of the target image. This typically leads to a very bold effect. In-between values incrementally shift between the extremes.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_666">histogram equalization</h6>
</div>
</div>
</div>
<p>Besides mapping of color characteristics this module can modify the target image's contrast by matching its histogram with the histogram of the source image. This slider controls the extent of the effect.</p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_667">Examples</h5>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="colormapping_ex1" src="../Images/colormapping_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>The source image taken shortly after sunset under front lighting conditions.</td>
</tr>
<tr>
<td>
<div><img alt="colormapping_ex2" src="../Images/colormapping_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>The target image taken in the afternoon with a partly clouded sky. Our goal is to transfer the evening atmosphere of the source image.</td>
</tr>
<tr>
<td>
<div><img alt="colormapping_ex3" src="../Images/colormapping_ex3.jpg" width="100%"/><br/>
</div>
</td>
<td>The target image with color mapping applied. A number of 2 clusters was used. <span>“<span>color dominance</span>”</span> is set to 100% for a bold but still credible effect. <span>“<span>histogram equalization</span>”</span> is set to 80%.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div><h4 id="sigil_toc_id_73">3.4.5.13. Graduated Density</h4>
</div>
<div>
<div>
<div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_668">Overview</h5>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>This module aims at simulating a graduated density filter, in order to correct exposure and color in a progressive manner.</td>
<td>
<div><img alt="graduatedneutraldensity" src="../Images/graduatedneutraldensity.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_669">Usage</h5>
</div>
</div>
</div>
<p>The module uses a gradient to modify the exposure and the color cast of the image in a non-homogeneously manner.</p>
<p>This module is known to provoke banding artifacts under certain conditions; you should consider to activate the <span><em>dithering</em></span> module (see <a title="3.4.4.13. Dithering" href="#sigil_toc_id_245">Section 3.4.4.13, “Dithering”</a>).</p>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_670">density</h6>
</div>
</div>
</div>
<p>Set the density of the filter in [ev]. A low value underexposes slightly whereas a high value creates a strong filter.</p>
<p>It is expressed as [ev] that is equivalent to <span><em>f-stops</em></span>. Lens filters are often referred as ND2, ND4, ND8 and so on. Each time you add an [ev] you double the ND. So ND2 is 1 ev, ND4 is 2 ev, and so on. You can also express it in optical density or transmittance. The table below sums up the different approach for the most common filters:</p>
<div>
<table border="0" width="100%"><colgroup><col width="25%"/>
<col width="25%"/>
<col width="25%"/>
<col width="25%"/>
</colgroup>
<tbody>
<tr>
<td><span><em>ND</em></span></td>
<td>[ev] or f-stop</td>
<td>absorbance</td>
<td>transmittance</td>
</tr>
<tr>
<td><span><em>ND2</em></span></td>
<td>-1</td>
<td>0.3</td>
<td>50%</td>
</tr>
<tr>
<td><span><em>ND4</em></span></td>
<td>-2</td>
<td>0.6</td>
<td>25%</td>
</tr>
<tr>
<td><span><em>ND8</em></span></td>
<td>-3</td>
<td>0.9</td>
<td>12.5%</td>
</tr>
<tr>
<td><span><em>ND400</em></span></td>
<td>-9</td>
<td>2.7</td>
<td>0.195%</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_671">compression</h6>
</div>
</div>
</div>
<p>Set progressiveness of the gradient. A low value creates a smooth transition, whereas a high value makes the transition abrupt.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_672">hue</h6>
</div>
</div>
</div>
<p>Set the hue to add a color cast to the gradient.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_673">saturation</h6>
</div>
</div>
</div>
<p>Set the saturation to add a color cast to the gradient.</p>
</div>
<div>
<div>
<div>
<div>
<h6 id="sigil_toc_id_674">position</h6>
</div>
</div>
</div>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>You can set the position of the gradient directly on the image by moving the white line. For fine tuning, you can also use the rotation slider. Negative values turn clockwise.</td>
<td>
<div><img alt="graduatedneutraldensity_canvas" src="../Images/graduatedneutraldensity_canvas.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
</div>
</div>
<div>
<div>
<div>
<div>
<h5 id="sigil_toc_id_675">Examples</h5>
</div>
</div>
</div>
<p>Here is an example that shows various options of darktable's graduated density filter:</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="40%"/>
<col width="60%"/>
</colgroup>
<tbody>
<tr>
<td>
<div><img alt="graduatedneutraldensity_ex1" src="../Images/graduatedneutraldensity_ex1.jpg" width="100%"/><br/>
</div>
</td>
<td>This is the original image with a pretty overexposed sky, use it as reference for the changes below...</td>
</tr>
<tr>
<td>
<div><img alt="graduatedneutraldensity_ex2" src="../Images/graduatedneutraldensity_ex2.jpg" width="100%"/><br/>
</div>
</td>
<td>And now we have added a neutral ND8 filter which does a pretty good job on the image..</td>
</tr>
<tr>
<td>
<div><img alt="graduatedneutraldensity_ex3" src="../Images/graduatedneutraldensity_ex3.jpg" width="100%"/><br/>
</div>
</td>
<td>And at last, we added an orange colored filter rotating it -180 degrees, applying it on water/trees for a more artistic use of the filter.</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>darktable's graduated density filter is a powerful tool. Nevertheless, hardware filters have some advantages over a pure software solution. With a physical GND filter you can in fact reduce the dynamic range of your scene to make it better fit the limits of your camera sensor.</p>
<p> </p>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>In this example a hardware GND filter (Hitech ND0.6, soft edge) helped to prevent over-exposure in the sky and tree tops, while at the same time getting a well exposed image of the ground. A rather disturbing element is the decay of brightness in the tree trunks from bottom to top.</td>
<td>
<div><img alt="graduatedneutraldensity_ex4" src="../Images/graduatedneutraldensity_ex4.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>darktable's graduated density filter together with the parametric mask feature (see <a title="3.2.8. Parametric mask" href="#sigil_toc_id_202">Section 3.2.8, “Parametric mask”</a>) comes in handy. We can add a brightness gradient that is just inverted in relation to the hardware filter. As we only want to compensate the unnatural decay of brightness in the tree trunks, we combine the module with a suited blend mask.</td>
<td>
<div><img alt="graduatedneutraldensity_ex5" src="../Images/graduatedneutraldensity_ex5.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>The resulting image.</td>
<td>
<div><img alt="graduatedneutraldensity_ex6" src="../Images/graduatedneutraldensity_ex6.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>Tip: If you know you intend to use the graduated density filter before actually making a shot with your camera you might want to underexpose by one or two thirds of an f-stop to make sure detail remains in the highlights. When all detail has truly been blown out the graduated density filter cannot produce a pleasing results, this is a limitation that is inherent to digital postprocessing. For instructions on how to intentionally underexpose, please consult your camera's manual, look for <span>“<span>exposure compensation</span>”</span>.</p>
</div>
</div>
</div>
</div>
<div>
<div>
<div>
<h2 id="sigil_toc_id_676">3.5. Examples</h2>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h3 id="sigil_toc_id_677">3.5.1. Converting to black and white</h3>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_678">3.5.1.1. Overview</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Black and white conversion can be achieved in several ways with darktable. Indeed, darktable comes with a lot of modules, especially for color manipulation. In this manual, I will show you 4 ways to perform a black and white conversion.</td>
<td>
<div><img alt="blackandwhite" src="../Images/blackandwhite.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_679">3.5.1.2. The obvious way: monochrome module</h4>
</div>
</div>
</div>
<p>To perform the conversion, just activate the <span><em>monochrome</em></span> module (<a title="3.4.3.7. Monochrome" href="#sigil_toc_id_63">Section 3.4.3.7, “Monochrome”</a>). You can then simulate a color filter, by dragging the circle above the colors you want to filter. Filter size can be modified via scrolling the mouse wheel.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_680">3.5.1.3. The simple way: color correction module</h4>
</div>
</div>
</div>
<p>To perform such conversion we use the <span><em>color correction</em></span> module (<a title="3.4.3.5. Color correction" href="#sigil_toc_id_62">Section 3.4.3.5, “Color correction”</a>).</p>
<div><ol><li>Activate the color correction module<br/></li>
<li>Use the bottom slider to set saturation to zero<br/></li>
</ol>
<ol type="1">
</ol>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_681">3.5.1.4. The LAB way: color contrast module</h4>
</div>
</div>
</div>
<p>To perform such conversion we use the <span><em>color contrast</em></span> module (<a title="3.4.3.4. Color contrast" href="#sigil_toc_id_341">Section 3.4.3.4, “Color contrast”</a>).</p>
<div>
<ol type="1">
<li>
<p>Activate the color contrast module</p>
</li>
<li>
<p>Set both steepness sliders to zero</p>
</li>
</ol>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_682">3.5.1.5. The artistic way: color zones module</h4>
</div>
</div>
</div>
<p>To perform the conversion we use the <span><em>color zone</em></span> module (<a title="3.4.3.8. Color zones" href="#sigil_toc_id_64">Section 3.4.3.8, “Color zones”</a>).</p>
<div>
<ol type="1">
<li>
<p>Activate the color zones module</p>
</li>
<li>
<p>By default, the active tabbed control is set to <span>“<span>saturation</span>”</span> whereas the <span>“<span>select by</span>”</span>combobox is set to <span>“<span>hue</span>”</span>. This means that color are selected according to their hue (horizontal scale) and you can change for each hue its <span>“<span>saturation</span>”</span> (vertical scale). You simply need to set all points to the minimum of the vertical scale to de-saturate every hue.</p>
</li>
<li>
<p>But now if you want, you can keep some hues a little bit saturated, so your image will be all black and white but some hue. A classical use for portrait is to keep red hue saturated in order to make the lips standing out.</p>
<p>You can also use one of the available presets that perform black and white conversion, keeping some hues saturated.</p>
</li>
</ol>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_683">3.5.1.6. The sophisticated way: channel mixer module</h4>
</div>
</div>
</div>
<p>To perform the conversion we use the <span><em>channel mixer</em></span> module (<a title="3.4.3.2. Channel mixer" href="#sigil_toc_id_61">Section 3.4.3.2, “Channel mixer”</a>).</p>
<div>
<ol type="1">
<li>
<p>Activate the channel mixer module</p>
</li>
<li>
<p>Select the gray output channel</p>
</li>
<li>
<p>Set the proportion of each color, the sum having to equal 1 if you want to keep your global lightness.</p>
</li>
</ol>
</div>
</div>
</div>
<div><div><div><h3 id="sigil_toc_id_684">3.5.2. Cross-processing</h3>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_685">3.5.2.1. Overview</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Cross-processing is an analog processing technique where slide film (normally developed thanks to an E6 solution) is processed in chemicals used for processing print film (C41). The resulting images get skewed colors usually a cyan hue and increased contrast and saturation.</td>
<td>
<div><img alt="crossprocessing" src="../Images/crossprocessing.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>The standard way for doing digital cross-processing is to use a channel curve tool but darktable lacks this tool for the moment and another way to accommodate the effect is used.</p>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_686">3.5.2.2. Procedure</h4>
</div>
</div>
</div>
<p>This procedure uses tone curve, channel mixer and splittoning modules.</p>
<div>
<ol type="1">
<li>
<p>Image preparation</p>
<p>Prepare the image for the cross process steps by adjusting the base settings such as exposure, whitebalance etc. for a correctly looking image.</p>
</li>
<li>
<p>Boost contrast</p>
<p>Select the medium contrast curve preset for <span><em>tone curve</em></span> module (<a title="3.4.2.3. Tone curve" href="#sigil_toc_id_56">Section 3.4.2.3, “Tone curve”</a>) to boost the overall contrast in the image. You might later return here to tune the curve for better result.</p>
</li>
<li>
<p>Color cast</p>
<p>This step changes the color cast as the base for the effect using the <span><em>channel mixer</em></span>module (<a title="3.4.3.2. Channel mixer" href="#sigil_toc_id_61">Section 3.4.3.2, “Channel mixer”</a>). You might later again return to this and finetune the colorcast of the final result.</p>
<div>
<ol type="a">
<li>
<p>Enable the channel mixer module</p>
</li>
<li>
<p>Select the blue channel and set the blue color value to 0.8</p>
</li>
<li>
<p>Select the red channel and change the blue color value to 0.1</p>
</li>
<li>
<p>Select the green channel and change the blue color value to 0.1</p>
</li>
</ol>
</div>
</li>
<li>
<p>Splittoning</p>
<p>We use <span><em>splittoning</em></span> (<a title="3.4.5.3. Splittoning" href="#sigil_toc_id_223">Section 3.4.5.3, “Splittoning”</a>) to add some more coloring to the result for cyan/blue shadows and yellow highlight.</p>
<div>
<ol type="a">
<li>
<p>Enable the splittoning module</p>
</li>
<li>
<p>Select a cyan/blue tone for shadows and set saturation around 50%</p>
</li>
<li>
<p>Select a yellow/orange tone for highlights and set saturation around 70%</p>
</li>
<li>
<p>Set compression to 10%</p>
</li>
<li>
<p>Use the balance slider to tune the splittoning effect. This differs on every image due to it's exposure, motive etc.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div>
<div>
<div>
<div>
<div>
<h3 id="sigil_toc_id_687">3.5.3. Cyan toned image</h3>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_688">3.5.3.1. Overview</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>Cyan is a nice color touchup for black and white images, this example guides you through how to make this with darktable and how to control the tone. You can choose any tone of your like for this tutorial...</td>
<td>
<div><img alt="cyantone" src="../Images/cyantone.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_689">3.5.3.2. Procedure</h4>
</div>
</div>
</div>
<p>This procedure uses monochrome, channel mixer and splittoning modules.</p>
<div>
<ol type="1">
<li>
<p>Image preparation</p>
<p>Prepare the image for the cyan toned steps by adjusting the base settings such as exposure,black level, contrast etc. for a correctly looking image.</p>
</li>
<li>
<p>Black and white</p>
<p>Enable the <span><em>monochrome</em></span> module (<a title="3.4.3.7. Monochrome" href="#sigil_toc_id_63">Section 3.4.3.7, “Monochrome”</a>) to make the image black and white.</p>
</li>
<li>
<p>Add color tone</p>
<p>This step selects the base tone of the image using <span><em>channel mixer</em></span> (<a title="3.4.3.2. Channel mixer" href="#sigil_toc_id_61">Section 3.4.3.2, “Channel mixer”</a>), we are going for cyan tone but you can choose any tone that you like here.</p>
<div>
<ol type="a">
<li>
<p>Enable the channel mixer module</p>
</li>
<li>
<p>Select the red channel destination and set the red color value to 0.7</p>
</li>
<li>
<p>Select the green channel destination and set the green color value to 1.15</p>
</li>
<li>
<p>Select the blue channel destination and set the blue color value to 1.15</p>
</li>
</ol>
</div>
<p>As you notice we mix blue and green color to get a cyan tone, we substract 0.3 from the red channel and add them to blue and green.</p>
</li>
<li>
<p>Splittoning</p>
<p>The result of the previous step does also add a color cast on highlights that we actually want to have white for a prettier result. We also want to add some blue color cast to the shadows in order to emphasis them. Module <span><em>splittoning&nbsp;</em></span>(<a title="3.4.5.3. Splittoning" href="#sigil_toc_id_223">Section 3.4.5.3, “Splittoning”</a>) can accomplish this.</p>
<div>
<ol type="a">
<li>
<p>Enable the splittoning module</p>
</li>
<li>
<p>Select a blue/cyan tone for shadows and set saturation around 50%</p>
</li>
<li>
<p>Set highlights saturation to zero, to remove saturation on highlights</p>
</li>
<li>
<p>Set compression to zero</p>
</li>
<li>
<p>Use the balance slider to tune the effect, our example uses a balance of 70/30</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div> </div>
<div>
<div>
<div>
<h3 id="sigil_toc_id_690">3.5.4. Removal of red-eye effect</h3>
</div>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_691">3.5.4.1. Overview</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td>
<p>The red-eye effect in photography is the common appearance of red pupils in color photographs of eyes. It occurs when using a photographic flash very close to the camera lens (as with most cameras with built-in flash), in ambient low light.</p>
<p>We use the channel mixer module to reduce the red color of the pupil. To limit the processing to the pupils we have to apply two masks.</p>
</td>
<td>
<div><img alt="red_eyes_01" src="../Images/red_eyes_01.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_692">3.5.4.2. Masking</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td rowspan="2">
<div>
<ol type="1">
<li>
<p>Enable the channel mixer module (see&nbsp;<a title="3.4.3.2. Channel mixer" href="#sigil_toc_id_61">Section 3.4.3.2, “Channel mixer”</a>).</p>
</li>
<li>
<p>Activate blending</p>
<p>Modules with blending support exhibit an additional combobox <span>“<span>blend</span>”</span> at the bottom of their GUI. Blending is activated with this combobox. Set value to <span>“<span>drawn mask</span>”</span>. Additional controls are displayed which allow you to draw a mask.</p>
</li>
<li>
<p>Masking the pupil</p>
<p>Clicking the&nbsp;<img alt="shape_circle" src="../Images/shape_circle.jpg" width="2%"/>&nbsp;symbol adds a circle shape.</p>
<p>Click into the canvas to place the circle. Left-click and drag the circle to the position of the first pupil. Use the scroll-wheel of your mouse while in the circle to change the diameter. Scroll within the circle border to minimize the width of the gradual decay.</p>
<p>Alternatively you can use an elliptical shape. See&nbsp;<a title="3.2.7. Drawn mask" href="#sigil_toc_id_194">Section 3.2.7, “Drawn mask”</a> for further details.</p>
</li>
<li>
<p>Repeat step 3.</p>
<p>Clicking the&nbsp;<img alt="shape_circle" src="../Images/shape_circle.jpg" width="2%"/>&nbsp;symbol adds another circle shape.</p>
<p>Mark the second pupil.</p>
</li>
</ol>
</div>
</td>
<td>
<div><img alt="red_eyes_02" src="../Images/red_eyes_02.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>
<div><img alt="red_eyes_03" src="../Images/red_eyes_03.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div>
<div>
<div>
<h4 id="sigil_toc_id_693">3.5.4.3. Desaturation</h4>
</div>
</div>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td rowspan="2">
<div>
<ol type="1">
<li>
<p>Approach - Modifying the output channel <span>“<span>red</span>”</span>.</p>
<div>
<ol type="a">
<li>
<p>Set output channel <span>“<span>destination</span>”</span> to <span>“<span>red</span>”</span> (default)</p>
</li>
<li>
<p>Set red color value to 0.00</p>
</li>
<li>
<p>Set green color value to 0.50</p>
</li>
<li>
<p>Set blue color value to 0.50</p>
</li>
</ol>
</div>
<p>You are free to experiment what gives you the most realistic pupil, but this is a good starting point. Another proposal is 0.10/0.60/0.30. The sum of the three values should be 1.</p>
</li>
</ol>
</div>
</td>
<td>
<div><img alt="red_eyes_04" src="../Images/red_eyes_04.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>
<div><img alt="red_eyes_05" src="../Images/red_eyes_05.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="0" width="100%"><colgroup><col width="60%"/>
<col width="40%"/>
</colgroup>
<tbody>
<tr>
<td rowspan="2">
<div>
<ol start="2" type="1">
<li>
<p>Approach - Modifying the output channel <span>“<span>gray</span>”</span>.</p>
<div>
<ol type="a">
<li>
<p>Set output channel <span>“<span>destination</span>”</span> to <span>“<span>gray</span>”</span></p>
</li>
<li>
<p>Set red color value to 0.24</p>
</li>
<li>
<p>Set green color value to 0.68</p>
</li>
<li>
<p>Set blue color value to 0.08</p>
</li>
</ol>
</div>
<p>You are free to experiment what gives you the most realistic pupil, but this is a good starting point. The sum of the three values should be 1.</p>
</li>
</ol>
</div>
</td>
<td>
<div><img alt="red_eyes_06" src="../Images/red_eyes_06.jpg" width="100%"/><br/>
</div>
</td>
</tr>
<tr>
<td>
<div><img alt="red_eyes_07" src="../Images/red_eyes_07.jpg" width="100%"/><br/>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</body>
</html>